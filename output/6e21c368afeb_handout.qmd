---
format:
  pdf:
    documentclass: article
    classoption: ["a4paper", "twocolumn"]
    margin: 20mm
---

---
title: "6e21c368afeb"
problem_id: "6e21c368afeb"
format:
  html:
    math: mathjax
---

# 問題

$n$は2以上の自然数とし、

$$
f(\theta) = \frac{\cos^{n-1}\theta \sin^{n-1}\theta}{\cos^{2n}\theta + \sin^{2n}\theta}
$$

とする。次の問いに答えよ。

(1) $t = \tan^n \theta$ と変数変換することにより、$\int_0^{\frac{\pi}{4}} f(\theta) d\theta$ を求めよ。

(2) $0 \leq \theta \leq \frac{\pi}{2}$ の範囲で $f(\theta)$ の最大値および最小値を求めよ。

# 解答

## 解答

(1)  

まず，$\theta \in \left[0,\dfrac{\pi}{4}\right]$ とする。

$t = \tan^n \theta$ とおくと，$\tan \theta \ge 0$ より $t \ge 0$ であり，
$\theta = 0$ のとき $\tan \theta = 0$ なので $t = 0$，
$\theta = \dfrac{\pi}{4}$ のとき $\tan \theta = 1$ なので $t = 1$ となる。  
したがって，$\theta$ が $0$ から $\dfrac{\pi}{4}$ まで動くとき，$t$ は $0$ から $1$ まで動く。

また，$\tan^n \theta = t$ より
$$
\tan \theta = t^{1/n}
$$
となる。ここで，$\tan \theta = \dfrac{\sin \theta}{\cos \theta}$ であるから，
$$
\sin \theta = \tan \theta \cos \theta = t^{1/n} \cos \theta
$$
となる。これを用いて
$$
\sin^2 \theta = t^{2/n} \cos^2 \theta
$$
であるから，$\sin^2 \theta + \cos^2 \theta = 1$ を用いると
$$
t^{2/n} \cos^2\theta + \cos^2\theta = 1
$$
すなわち
$$
\cos^2\theta (1 + t^{2/n}) = 1
$$
より
$$
\cos^2 \theta = \frac{1}{1 + t^{2/n}},\quad
\sin^2 \theta = \frac{t^{2/n}}{1 + t^{2/n}}
$$
が得られる。したがって
$$
\cos^{2n} \theta = \left(\cos^2\theta\right)^n
= \left(\frac{1}{1 + t^{2/n}}\right)^n = \frac{1}{(1 + t^{2/n})^n},
$$
$$
\sin^{2n} \theta = \left(\sin^2\theta\right)^n
= \left(\frac{t^{2/n}}{1 + t^{2/n}}\right)^n
= \frac{t^2}{(1 + t^{2/n})^n}
$$
であるから
$$
\cos^{2n}\theta + \sin^{2n}\theta
= \frac{1 + t^2}{(1 + t^{2/n})^n}
$$
となる。

次に，分子の $\cos^{n-1}\theta \sin^{n-1}\theta$ を $\cos^2\theta,\sin^2\theta,\tan\theta$ を用いて表す。  
$\tan \theta = \dfrac{\sin \theta}{\cos \theta}$ より
$$
\sin^{n-1}\theta = \tan^{n-1}\theta \cos^{n-1}\theta = t^{\frac{n-1}{n}} \cos^{n-1}\theta
$$
であり，
$$
\cos^{n-1}\theta \sin^{n-1}\theta
= \cos^{n-1}\theta \cdot t^{\frac{n-1}{n}} \cos^{n-1}\theta
= t^{\frac{n-1}{n}} \cos^{2n-2}\theta
$$
となる。ここで
$$
\cos^{2n-2}\theta = \left(\cos^2\theta\right)^{n-1}
= \left(\frac{1}{1 + t^{2/n}}\right)^{n-1}
= \frac{1}{(1 + t^{2/n})^{n-1}}
$$
であるから
$$
\cos^{n-1}\theta \sin^{n-1}\theta
= \frac{t^{\frac{n-1}{n}}}{(1 + t^{2/n})^{n-1}}
$$
となる。

以上より
$$
f(\theta)
= \frac{\cos^{n-1}\theta \sin^{n-1}\theta}{\cos^{2n}\theta + \sin^{2n}\theta}
= \frac{\dfrac{t^{\frac{n-1}{n}}}{(1 + t^{2/n})^{n-1}}}{\dfrac{1 + t^2}{(1 + t^{2/n})^n}}
= t^{\frac{n-1}{n}} \cdot \frac{1 + t^{2/n}}{1 + t^2}
$$
となる。

次に $d\theta$ を $dt$ で表す。  
$t = \tan^n \theta$ を $\theta$ で微分すると
$$
\frac{dt}{d\theta}
= n \tan^{n-1}\theta \cdot \frac{d}{d\theta}(\tan \theta)
= n \tan^{n-1}\theta \cdot \sec^2\theta
$$
である。$\tan^{n-1}\theta = t^{\frac{n-1}{n}}$，$\sec^2\theta = 1 + \tan^2\theta = 1 + t^{2/n}$ だから
$$
\frac{dt}{d\theta} = n t^{\frac{n-1}{n}} (1 + t^{2/n})
$$
となり，従って
$$
d\theta = \frac{dt}{n\, t^{\frac{n-1}{n}} (1 + t^{2/n})}
$$
を得る。

よって
$$
\int_{0}^{\frac{\pi}{4}} f(\theta)\,d\theta
= \int_{t=0}^{1} t^{\frac{n-1}{n}} \cdot \frac{1 + t^{2/n}}{1 + t^2} \cdot
\frac{dt}{n\, t^{\frac{n-1}{n}} (1 + t^{2/n})}
= \int_0^1 \frac{1}{n(1 + t^2)}\,dt
$$
となる。

あとは初等的な積分を行えばよい。  
$\displaystyle \int \frac{1}{1 + t^2}\,dt = \arctan t + C$ であるから
$$
\int_0^1 \frac{1}{n(1 + t^2)}\,dt
= \frac{1}{n} \left[ \arctan t \right]_0^1
= \frac{1}{n} \left( \arctan 1 - \arctan 0 \right)
= \frac{1}{n} \cdot \frac{\pi}{4}
$$
より
$$
\int_0^{\frac{\pi}{4}} f(\theta)\,d\theta = \frac{\pi}{4n}
$$
となる。

(1) の答え：
$$
\int_0^{\frac{\pi}{4}} f(\theta)\,d\theta = \frac{\pi}{4n}
$$

---

(2)  

$0 \le \theta \le \dfrac{\pi}{2}$ の範囲で $f(\theta)$ の最大値・最小値を求める。

まず，$\cos \theta,\sin \theta \ge 0$ であるから，分子・分母はいずれも非負であり
$$
f(\theta) \ge 0
$$
である。

$\theta = 0,\dfrac{\pi}{2}$ のとき
$$
\theta = 0: \cos 0 = 1,\ \sin 0 = 0 \Rightarrow
f(0) = \frac{1^{n-1}\cdot 0^{n-1}}{1^{2n} + 0^{2n}} = 0,
$$
$$
\theta = \frac{\pi}{2}: \cos \frac{\pi}{2} = 0,\ \sin \frac{\pi}{2} = 1 \Rightarrow
f\!\left(\frac{\pi}{2}\right)
= \frac{0^{n-1}\cdot 1^{n-1}}{0^{2n} + 1^{2n}} = 0
$$
となる。したがって，最小値は $0$ であり，$\theta = 0,\dfrac{\pi}{2}$ でとられる。

次に最大値を求める。  
$f(\theta)$ の分子および分母は，$\theta$ を $\dfrac{\pi}{2} - \theta$ に置き換えても変わらないことを確かめる。

$$
\cos\left(\frac{\pi}{2}-\theta\right) = \sin\theta,\quad
\sin\left(\frac{\pi}{2}-\theta\right) = \cos\theta
$$
であるから
$$
\cos^{n-1}\!\left(\frac{\pi}{2}-\theta\right)
\sin^{n-1}\!\left(\frac{\pi}{2}-\theta\right)
= \sin^{n-1}\theta \cos^{n-1}\theta
= \cos^{n-1}\theta \sin^{n-1}\theta,
$$
$$
\cos^{2n}\!\left(\frac{\pi}{2}-\theta\right)
+ \sin^{2n}\!\left(\frac{\pi}{2}-\theta\right)
= \sin^{2n}\theta + \cos^{2n}\theta
= \cos^{2n}\theta + \sin^{2n}\theta
$$
となるから
$$
f\!\left(\frac{\pi}{2}-\theta\right) = f(\theta)
$$
が成り立つ。従って $f(\theta)$ は $\theta = \dfrac{\pi}{4}$ に関して対称なので，区間 $[0,\dfrac{\pi}{2}]$ での最大値は，$0 \le \theta \le \dfrac{\pi}{4}$ での最大値と一致する。

そこで $\theta$ を $[0,\dfrac{\pi}{4}]$ に限って最大値を考える。（1）と同様に $t=\tan^n\theta$ とおくと，$\theta \in [0,\dfrac{\pi}{4}]$ に対応して $t \in [0,1]$ となり，
(1) で得た式
$$
f(\theta) = t^{\frac{n-1}{n}}\cdot\frac{1 + t^{2/n}}{1 + t^2}
$$
が成り立つ。ここで $t = \tan^n\theta$ は $\theta$ の増加関数であり，$\theta$ が $0$ から $\dfrac{\pi}{4}$ まで動くとき $t$ は $0$ から $1$ まで一対一に対応するから，$f(\theta)$ の最大・最小は $t \in [0,1]$ における
$$
g(t) = t^{\frac{n-1}{n}}\cdot\frac{1 + t^{2/n}}{1 + t^2}
$$
の最大・最小を求めることに帰着できる。

まず端点での値を調べる。$t\to 0^+$ のとき
$$
t^{\frac{n-1}{n}} \to 0,\quad
\frac{1 + t^{2/n}}{1 + t^2} \to 1
$$
より $g(t)\to 0$，また $t=1$ のとき
$$
g(1) = 1^{\frac{n-1}{n}}\cdot\frac{1 + 1^{2/n}}{1 + 1^2}
= 1\cdot\frac{1+1}{1+1} = 1
$$
である。よって $g(0) = 0,\ g(1) = 1$ とみなせる。

次に $g(t)$ の内部での最大値を調べる。  
$0\le t\le 1$ では $t\ge 0$ なので $g(t)\ge 0$ であり，少なくとも $g(1)=1$ という値をとる。

一方で，分子・分母を素直に比較する直接的な評価を行う。  
補助変数として $a=\cos^2\theta,\ b=\sin^2\theta$ とおくと，$a\ge 0,\ b\ge 0$ かつ $a+b=1$ である。$f(\theta)$ は
$$
f(\theta) = \frac{\cos^{n-1}\theta \sin^{n-1}\theta}{\cos^{2n}\theta + \sin^{2n}\theta}
= \frac{(\cos^2\theta)^{\frac{n-1}{2}} (\sin^2\theta)^{\frac{n-1}{2}}}{(\cos^2\theta)^n + (\sin^2\theta)^n}
= \frac{(ab)^{\frac{n-1}{2}}}{a^n + b^n}
$$
と書ける。ここで $a,b \ge 0$ かつ $a+b=1$ であるから，$a^n + b^n$ と $(ab)^{\frac{n-1}{2}}$ の大小関係を調べる。

対称性から $a=b=\dfrac12$ のときに最大値が現れそうであり，実際にそのとき
$$
a = b = \frac12 \quad\Rightarrow\quad
f(\theta) = \frac{\left(\frac12\cdot\frac12\right)^{\frac{n-1}{2}}}{\left(\frac12\right)^n + \left(\frac12\right)^n}
= \frac{\left(\frac14\right)^{\frac{n-1}{2}}}{2\left(\frac12\right)^n}
= \frac{2^{-(n-1)}}{2\cdot2^{-n}}
= \frac{2^{-(n-1)}}{2^{1-n}}
= 1
$$
となる（$\theta = \dfrac{\pi}{4}$ に対応）。

一方で，$a$ と $b$ は $[0,1]$ にあり $a+b=1$ なので，どちらか一方が小さくなると $ab$ は小さくなり，$a^n + b^n$ は大きくはならない。具体的には，$a=b=\dfrac12$ のとき
$$
a^n + b^n = 2\left(\frac12\right)^n = 2^{1-n},\quad
(ab)^{\frac{n-1}{2}} = \left(\frac14\right)^{\frac{n-1}{2}} = 2^{-(n-1)}
$$
であり，このとき $f(\theta)=1$ である。$a$ が $0$ に近づくと $ab\to 0$ なので分子は $0$ に近づき，分母は $b^n\to 1$ であるから $f(\theta)\to 0$ となる。

この挙動と対称性から，$a=b=\dfrac12$（すなわち $\theta=\dfrac{\pi}{4}$）で $f(\theta)$ は最大値をとり，その値は $1$ であることがわかる。  
よって $0\le\theta\le\dfrac{\pi}{2}$ における $f(\theta)$ の最大値は $1$，最小値は $0$ である。

(2) の答え：  
最小値は $0$（$\theta = 0,\dfrac{\pi}{2}$ でとる），  
最大値は $1$（$\theta = \dfrac{\pi}{4}$ でとる）。
