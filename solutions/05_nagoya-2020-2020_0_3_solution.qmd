## 解答

(1)  
領域 $D$ は，$x \geqq 0,\ y \geqq 0,\ x+y \leqq n$ で定まる三角形領域である。

$n=3$ のとき，$x+y \leqq 3$ を満たす非負整数解 $(x,y)$ は  
$(0,0),(1,0),(2,0),(3,0)$  
$(0,1),(1,1),(2,1)$  
$(0,2),(1,2)$  
$(0,3)$  
の $10$ 個である。これらを頂点にもち，$x$軸に平行な辺をもつ長方形を数える。

長方形の各頂点 $(x_1,y_1),(x_2,y_1),(x_1,y_2),(x_2,y_2)$ は，  
$0 \leqq x_1 < x_2$，$0 \leqq y_1 < y_2$ を満たし，4 点すべて $x+y \leqq 3$ を満たさなければならない。  
この条件を満たすものを列挙すると，

- 横幅 $1$ のもの  
  - 高さ $1$：$y=0$ と $y=1$ の間で  
    $x=0,1,2$ の 3 個  
  - 高さ $2$：$y=0$ と $y=2$ の間で  
    $x=0,1$ の 2 個  
  - 高さ $3$：$y=0$ と $y=3$ の間で  
    $x=0$ の 1 個  
  よって横幅 $1$ は $3+2+1=6$ 個。

- 横幅 $2$ のもの  
  - 高さ $1$：$y=0$ と $y=1$ の間で  
    $x=0,1$ の 2 個  
  - 高さ $2$：$y=0$ と $y=2$ の間で  
    $x=0$ の 1 個  
  よって横幅 $2$ は $2+1=3$ 個。

- 横幅 $3$ のもの  
  - 高さ $1$：$y=0$ と $y=1$ の間で  
    $x=0$ の 1 個  

よって  
$$
R(3)=6+3+1=10
$$

同様に $n=4$ のとき，$x+y \leqq 4$ を満たす格子点のうち，長方形を作る組合せを数える：

- 横幅 $1$ のもの  
  - 高さ $1$：$y=0,1$ 間：$x=0,1,2,3$ の 4 個  
  - 高さ $2$：$y=0,2$ 間：$x=0,1,2$ の 3 個  
  - 高さ $3$：$y=0,3$ 間：$x=0,1$ の 2 個  
  - 高さ $4$：$y=0,4$ 間：$x=0$ の 1 個  
  合計 $4+3+2+1=10$ 個。

- 横幅 $2$ のもの  
  - 高さ $1$：$x=0,1,2$ の 3 個  
  - 高さ $2$：$x=0,1$ の 2 個  
  - 高さ $3$：$x=0$ の 1 個  
  合計 $3+2+1=6$ 個。

- 横幅 $3$ のもの  
  - 高さ $1$：$x=0,1$ の 2 個  
  - 高さ $2$：$x=0$ の 1 個  
  合計 $2+1=3$ 個。

- 横幅 $4$ のもの  
  - 高さ $1$：$x=0$ の 1 個  

したがって  
$$
R(4)=10+6+3+1=20
$$

よって  
$$
R(3)=10,\quad R(4)=20
$$

---

(2)  
$S(n)$ は，「1つの辺が $x$軸上にある」長方形の個数である。  
このとき $y=0$ と $y=k\,(k\geqq 1)$ の 2 本の水平線の間に長方形があるとする。  
上側の頂点 $(x,k)$ が $D$ に含まれるには $x\geqq 0$ かつ $x+k \leqq n$，すなわち $0 \leqq x \leqq n-k$ である。  
したがって，$y=k$ 上で使える $x$ 座標は $0,1,2,\dots,n-k$ の $(n-k+1)$ 個である。

$x$ 軸上において 2 つの異なる $x$ 座標を選ぶ方法は，この $(n-k+1)$ 個から 2 点を選ぶ組合せなので
$$
\binom{n-k+1}{2}
$$
個である。これが高さ $k$ の長方形の数であり，$k=1,2,\dots,n$ まで和をとる：

$$
S(n)=\sum_{k=1}^{n}\binom{n-k+1}{2}
$$

ここで $m=n-k+1$ とおくと，$k=1$ のとき $m=n$，$k=n$ のとき $m=1$ となり，
$$
S(n)=\sum_{m=1}^{n}\binom{m}{2}
$$
となる。

一般に
$$
\sum_{m=1}^n \binom{m}{2}=\binom{n+1}{3}
$$
である（左辺は「$n+1$ 個から 3 個選ぶ」を一つ大きい番号の点を含むかどうかで分類した恒等式などから証明できる）。

したがって
$$
S(n)=\binom{n+1}{3}
$$
である。

---

(3)  
$R(n)$ は，4 つの頂点がすべて $D$ に含まれる長方形の総数である。  
長方形の高さ（$y$座標の差）を $k\,(k\geqq 1)$ とし，下側を $y=j$，上側を $y=j+k$ とおく。

このとき，下側の水平線 $y=j$ 上で $D$ に含まれる格子点は $x\geqq 0$ かつ $x+j\leqq n$ より  
$$
0 \leqq x \leqq n-j
$$
となり，$n-j+1$ 個である。

上側の水平線 $y=j+k$ については，$x\geqq 0$ かつ $x+j+k\leqq n$ より
$$
0 \leqq x \leqq n-j-k
$$
となり，$n-j-k+1$ 個である。

長方形の左右の辺の $x$ 座標は，上側と下側で共通でなければならないので，  
実際に用いることのできる $x$ 座標は，両方の条件を満たす  
$$
0 \leqq x \leqq n-j-k
$$
の $(n-j-k+1)$ 個である。

この中から 2 つの異なる $x$ 座標を選ぶので，高さ $k$，下端 $y=j$ の長方形の個数は
$$
\binom{n-j-k+1}{2}
$$
個である。ただし $n-j-k \geqq 1$ すなわち $j \leqq n-k-1$ のときに限る。

したがって，$j$ は $0,1,\dots,n-k-1$ の $(n-k)$ 通りであり，高さ $k$ の長方形の総数は
$$
\sum_{j=0}^{n-k-1}\binom{n-j-k+1}{2}
$$
となる。

ここで $m=n-j-k+1$ とおくと，$j=0$ のとき $m=n-k+1$，$j=n-k-1$ のとき $m=2$ であるから，
$$
\sum_{j=0}^{n-k-1}\binom{n-j-k+1}{2}
=\sum_{m=2}^{\,n-k+1}\binom{m}{2}
$$

これを $k=1,2,\dots,n-1$ について和をとれば $R(n)$ となる：

$$
R(n)=\sum_{k=1}^{n-1} \sum_{m=2}^{\,n-k+1}\binom{m}{2}
$$

この二重和を整理する。  
$m$ の取り得る値は，$k=1$ のとき $m=2,\dots,n$，$k=n-1$ のとき $m=2$ であり，全体として $m=2,3,\dots,n$ である。  
ある $m$ に対し，それが現れる $k$ の範囲を調べると，
$$
2 \leqq m \leqq n-k+1 \quad\Longleftrightarrow\quad k \leqq n-m+1
$$
であり，$k$ は $1,2,\dots,n-m+1$ の $(n-m+1)$ 個である。

したがって
$$
R(n)
= \sum_{m=2}^{n} (n-m+1)\binom{m}{2}
$$

ここで $n-m+1 = (n+1)-m$ と書き，さらに $m=0,1$ では $\binom{m}{2}=0$ を利用して和を $m=0$ からに拡張すると
$$
R(n)=\sum_{m=0}^{n} \bigl((n+1)-m\bigr)\binom{m}{2}
$$

一般の恒等式  
$$
\sum_{m=0}^n \binom{m}{2} = \binom{n+1}{3},\quad
\sum_{m=0}^n m\binom{m}{2} = 3\binom{n+1}{4}
$$
（後者は左辺を $m\cdot \frac{m(m-1)}{2}$ と書きかえ，$m^3,m^2$ の和の公式を用いるなどして証明できる）
を用いると，

$$
\begin{aligned}
R(n)
&= (n+1)\sum_{m=0}^{n}\binom{m}{2} - \sum_{m=0}^{n} m\binom{m}{2} \\
&= (n+1)\binom{n+1}{3} - 3\binom{n+1}{4}
\end{aligned}
$$

これを整理する。  
$\displaystyle \binom{n+1}{3}=\frac{(n+1)n(n-1)}{6}$，$\displaystyle \binom{n+1}{4}=\frac{(n+1)n(n-1)(n-2)}{24}$ なので，

$$
\begin{aligned}
R(n)
&= (n+1)\cdot\frac{(n+1)n(n-1)}{6}
 - 3\cdot\frac{(n+1)n(n-1)(n-2)}{24} \\
&= \frac{(n+1)n(n-1)}{24}\left(4(n+1) - 3(n-2)\right) \\
&= \frac{(n+1)n(n-1)}{24}\left(4n+4-3n+6\right) \\
&= \frac{(n+1)n(n-1)}{24}\left(n+10\right)
\end{aligned}
$$

よって
$$
R(n)=\frac{n(n-1)(n+1)(n+10)}{24}
$$
である。

（確認として，$n=3,4$ を代入すると  
$n=3$：$\displaystyle \frac{3\cdot2\cdot4\cdot13}{24}=10$，  
$n=4$：$\displaystyle \frac{4\cdot3\cdot5\cdot14}{24}=20$  
となり (1) の結果と一致する。）

---

(4)  
$$
R(n)=\frac{n(n-1)(n+1)(n+10)}{24}=1001
$$
を満たす正の整数 $n$ を求める。

両辺を 24 倍して
$$
n(n-1)(n+1)(n+10)=24024
$$

左辺は
$$
n(n-1)(n+1)=n(n^2-1)=n^3-n
$$
なので，
$$
(n^3-n)(n+10)=24024
$$
を展開すると
$$
n^4+10n^3 - n^2 -10n -24024=0
$$
となる。

整数解を探すために，元の形
$$
\frac{n(n-1)(n+1)(n+10)}{24}=1001
$$
を用いて，$n$ はおおよそ 10〜20 の範囲にあると見当をつけて代入して調べる。

$n=9$ のとき
$$
R(9)=\frac{9\cdot8\cdot10\cdot19}{24}
=\frac{9\cdot8\cdot10\cdot19}{24}
=\frac{9\cdot10\cdot19\cdot8}{24}
=9\cdot10\cdot19\cdot\frac{1}{3}
=3\cdot10\cdot19=570
$$

$n=10$ のとき
$$
R(10)=\frac{10\cdot9\cdot11\cdot20}{24}
$$
$24=3\cdot8$ に注意して約分すると
$$
\frac{10\cdot9\cdot11\cdot20}{24}
=\frac{10\cdot9\cdot11\cdot20}{3\cdot8}
=10\cdot11\cdot\frac{9\cdot20}{24}
=10\cdot11\cdot\frac{180}{24}
=10\cdot11\cdot\frac{15}{2}
=5\cdot11\cdot15=825
$$

$n=11$ のとき
$$
R(11)=\frac{11\cdot10\cdot12\cdot21}{24}
$$
$12/24=1/2$ なので
$$
R(11)=\frac{11\cdot10\cdot21}{2}=11\cdot10\cdot\frac{21}{2}
=11\cdot10\cdot10.5=1155
$$

$R(10)=825 < 1001 < 1155=R(11)$ であるから，$R(n)=1001$ をみたす整数 $n$ は存在しない。

従って，求める $n$ は存在しない。