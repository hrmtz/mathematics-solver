## 解答

(1)  
初めに赤玉が $a$ 個入っている。  
1 回目の試行では，赤玉を引く確率は $1$ なので，青玉が 1 個増え，1 回目の試行後の袋の中身は

- 赤玉 $a$ 個
- 青玉 $1$ 個

である。よって $p_1(k)$ は，$k=a$ のとき $1$，それ以外のとき $0$ となる。

2 回目の試行では，袋の中の玉の総数は $a+1$ 個であり，

- 赤玉を引く確率は $\dfrac{a}{a+1}$  
　このとき青玉が 1 個増えるので，赤玉の個数は $a$ のまま。
- 青玉を引く確率は $\dfrac{1}{a+1}$  
　このとき赤玉が 1 個増えるので，赤玉の個数は $a+1$ になる。

したがって，2 回目の試行後に赤玉が $k$ 個である確率 $p_2(k)$ は

$$
p_2(k)=
\begin{cases}
\dfrac{a}{a+1} & (k=a)\\[4pt]
\dfrac{1}{a+1} & (k=a+1)\\[4pt]
0 & (\text{上の 2 つ以外})
\end{cases}
$$

となる。

---

(2)  
$n$ 回目の試行後に赤玉が $k$ 個である状態から，$(n+1)$ 回目の試行後に赤玉が $k+1$ 個になる，という遷移を考える。

$(n+1)$ 回目の試行後に赤玉が $k+1$ 個になるための場合分けをする。

- 場合 A：$n$ 回目の後に赤玉が $k$ 個であり，$(n+1)$ 回目に青玉を引いた場合  
　このとき，青玉を引くと赤玉を 1 個加えるので，赤玉は $k+1$ 個になる。  
　$n$ 回目の後に赤玉 $k$ 個である確率は $p_n(k)$，その状態で袋の中の総数は $a+n$ 個なので，青玉の個数は
  $$
  (a+n) - k
  $$
  である。従って，青玉を引く確率は $\dfrac{a+n-k}{a+n}$ となる。  
　よってこの場合の確率は
  $$
  \frac{a+n-k}{a+n}\,p_n(k)
  $$
  である。

- 場合 B：$n$ 回目の後に赤玉が $k+1$ 個であり，$(n+1)$ 回目に赤玉を引いた場合  
　このとき，赤玉を引くと青玉を 1 個加えるだけなので，赤玉の個数は $k+1$ のままである。  
　$n$ 回目の後に赤玉 $k+1$ 個である確率は $p_n(k+1)$，その状態で赤玉の個数は $k+1$ 個なので，赤玉を引く確率は $\dfrac{k+1}{a+n}$ である。  
　よってこの場合の確率は
  $$
  \frac{k+1}{a+n}\,p_n(k+1)
  $$
  である。

ゆえに，全確率の法則より

$$
p_{n+1}(k+1)
= \frac{a+n-k}{a+n}\,p_n(k)
+ \frac{k+1}{a+n}\,p_n(k+1)
$$

と表される。  
したがって

$$
B=\frac{a+n-k}{a+n},\quad C=\frac{k+1}{a+n}
$$

となる。

---

(3)  
$M_n$ は $n$ 回目の試行後の赤玉の個数の期待値であり，

$$
M_n = \sum_{k=0}^{a+n} k\,p_n(k)
$$

で定義されている。

まず $M_1$ を求める。1 回目の試行後の赤玉の個数は必ず $a$ 個であるから，

$$
M_1 = a
$$

である。

次に漸化式 $M_{n+1}=\dfrac{a+n-1}{a+n}M_n+1$ を示す。

(2)で得た関係式
$$
p_{n+1}(k+1) = \frac{a+n-k}{a+n}p_n(k) + \frac{k+1}{a+n}p_n(k+1)
$$
を用いる。

$M_{n+1}$ を書き下すと，

$$
M_{n+1}=\sum_{j=0}^{a+n+1} j\,p_{n+1}(j)
$$

である。ここで添字を $j=k+1$ とおき，$k$ について和をとる形に書き直すと，

$$
M_{n+1} = \sum_{k=0}^{a+n} (k+1)\,p_{n+1}(k+1)
$$

となる。右辺に(2)の式を代入すると，

$$
M_{n+1}
= \sum_{k=0}^{a+n} (k+1)\left\{
\frac{a+n-k}{a+n}p_n(k)
+ \frac{k+1}{a+n}p_n(k+1)
\right\}
$$

$$
= \frac{1}{a+n}
\left[
\sum_{k=0}^{a+n} (k+1)(a+n-k)\,p_n(k)
+ \sum_{k=0}^{a+n} (k+1)^2\,p_n(k+1)
\right]
$$

となる。

第 2 項の和について，添字を $m=k+1$ とおき直すと，$m$ は $1$ から $a+n+1$ まで動き，$p_n(m)$ に変わるので，

$$
\sum_{k=0}^{a+n} (k+1)^2\,p_n(k+1)
= \sum_{m=1}^{a+n+1} m^2\,p_n(m)
$$

である。ここで，$n$ 回目の試行後には袋の中の玉の総数は $a+n$ 個であるから，赤玉の個数は $0$ から $a+n$ までしか取り得ない。すなわち

$$
p_n(a+n+1)=0
$$

である。したがって上式は

$$
\sum_{m=1}^{a+n} m^2\,p_n(m)
$$

と書いてよい。これを用いると

$$
M_{n+1}
= \frac{1}{a+n}
\left[
\sum_{k=0}^{a+n} (k+1)(a+n-k)\,p_n(k)
+ \sum_{k=1}^{a+n} k^2\,p_n(k)
\right]
$$

となる。

第 1 の和を展開する：

$$
(k+1)(a+n-k) = (a+n)(k+1) - k(k+1)
= (a+n)(k+1) - (k^2 + k)
$$

なので，

$$
\sum_{k=0}^{a+n} (k+1)(a+n-k)\,p_n(k)
= (a+n)\sum_{k=0}^{a+n} (k+1)p_n(k)
- \sum_{k=0}^{a+n} (k^2 + k)p_n(k)
$$

ここで，

$$
\sum_{k=0}^{a+n} (k+1)p_n(k)
= \sum_{k=0}^{a+n} k p_n(k) + \sum_{k=0}^{a+n} p_n(k)
= M_n + 1
$$

（確率の和は $1$ であることを用いた）から，

$$
\sum_{k=0}^{a+n} (k+1)(a+n-k)\,p_n(k)
= (a+n)(M_n + 1) - \sum_{k=0}^{a+n} (k^2 + k)p_n(k)
$$

となる。一方，

$$
\sum_{k=1}^{a+n} k^2\,p_n(k)
= \sum_{k=0}^{a+n} k^2\,p_n(k)
$$

（$k=0$ の項は 0 だから加えてもよい）であるので，先ほどの式に代入すると

$$
M_{n+1}
= \frac{1}{a+n}
\left[
(a+n)(M_n + 1)
- \sum_{k=0}^{a+n} (k^2 + k)p_n(k)
+ \sum_{k=0}^{a+n} k^2\,p_n(k)
\right]
$$

となる。右辺の和の部分を整理すると，

$$
-\sum_{k=0}^{a+n} (k^2 + k)p_n(k)
+ \sum_{k=0}^{a+n} k^2\,p_n(k)
= -\sum_{k=0}^{a+n} k\,p_n(k)
= -M_n
$$

であるから，

$$
M_{n+1}
= \frac{1}{a+n}
\left[
(a+n)(M_n + 1) - M_n
\right]
$$

$$
= \frac{(a+n-1)M_n + (a+n)}{a+n}
= \frac{a+n-1}{a+n}M_n + 1
$$

となり，示すべき漸化式が得られる。

---

(4)  
(3)で得た漸化式

$$
M_1 = a,\quad
M_{n+1} = \frac{a+n-1}{a+n}M_n + 1
$$

の一般項を求める。

まず，右辺の係数を簡略に $c_n=\dfrac{a+n-1}{a+n}$ とおく。  
非同次一次漸化式なので，標準的な方法として「差を取る」ことを試みる。

$$
M_{n+1} - (a+n)
= \frac{a+n-1}{a+n}M_n + 1 - (a+n)
$$

右辺を整理する：

$$
1 - (a+n) = - (a+n-1)
$$

なので，

$$
M_{n+1} - (a+n)
= \frac{a+n-1}{a+n}M_n - (a+n-1)
= \frac{a+n-1}{a+n}\bigl( M_n - (a+n) \bigr)
$$

となる。ここで，新しい数列

$$
S_n = M_n - (a+n)
$$

とおけば，上の関係式は

$$
S_{n+1} = \frac{a+n-1}{a+n} S_n
$$

となる。これは同次一次漸化式である。

したがって

$$
S_n = S_1 \prod_{j=1}^{n-1} \frac{a+j-1}{a+j}
$$

となる。ここで $S_1$ を求めると，

$$
S_1 = M_1 - (a+1) = a - (a+1) = -1
$$

である。また積の中身を簡単にするために並べて書くと，

$$
\prod_{j=1}^{n-1} \frac{a+j-1}{a+j}
= \frac{a}{a+1}\cdot \frac{a+1}{a+2}\cdot\frac{a+2}{a+3}\cdots\frac{a+n-2}{a+n-1}
$$

となり，ほとんどの項が相殺されて，結局

$$
\prod_{j=1}^{n-1} \frac{a+j-1}{a+j}
= \frac{a}{a+n-1}
$$

となる。したがって

$$
S_n = -1 \cdot \frac{a}{a+n-1} = -\frac{a}{a+n-1}
$$

となり，

$$
M_n = S_n + (a+n)
= a+n - \frac{a}{a+n-1}
$$

を得る。これが数列 $\{M_n\}$ の一般項である。

次に $\displaystyle\lim_{n\to\infty}\dfrac{M_n}{n}$ を求める。  
上で得た式を用いると，

$$
\frac{M_n}{n}
= \frac{a+n}{n} - \frac{a}{n(a+n-1)}
= 1 + \frac{a}{n} - \frac{a}{n(a+n-1)}
$$

となる。$n\to\infty$ のとき，$\dfrac{a}{n} \to 0$ かつ $\dfrac{a}{n(a+n-1)} \to 0$ であるから，

$$
\lim_{n\to\infty}\frac{M_n}{n}
= 1
$$

となる。