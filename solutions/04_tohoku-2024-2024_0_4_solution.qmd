## 解答

(1)  
与えられた関係  
$$(1+\sqrt2)^n = a_n + b_n\sqrt2$$  
を用いる。

$(1+\sqrt2)^{n+1}$ を $(1+\sqrt2)^n$ を使って表すと，
$$(1+\sqrt2)^{n+1}=(1+\sqrt2)^n(1+\sqrt2)=(a_n+b_n\sqrt2)(1+\sqrt2)$$
であるから，右辺を展開すると
$$(a_n+b_n\sqrt2)(1+\sqrt2)
= a_n + a_n\sqrt2 + b_n\sqrt2 + 2b_n
= (a_n+2b_n) + (a_n+b_n)\sqrt2$$
となる。

一方，定義から
$$(1+\sqrt2)^{n+1}=a_{n+1}+b_{n+1}\sqrt2$$
と表される。$\sqrt2$ が無理数であることから，有理数部分と $\sqrt2$ の係数はそれぞれ一致しなければならない。よって
$$a_{n+1}=a_n+2b_n,\quad b_{n+1}=a_n+b_n$$
を得る。

次に $b_4,b_5,b_6$ を求める。まず $n=1$ のとき
$$(1+\sqrt2)^1 = 1+\sqrt2 = a_1 + b_1\sqrt2$$
より
$$a_1=1,\quad b_1=1$$
である。

上で得た漸化式から順に求める。

$n=1$ から $n=2$：
$$a_2 = a_1 + 2b_1 = 1 + 2\cdot1 = 3,\quad
b_2 = a_1 + b_1 = 1 + 1 = 2.$$

$n=2$ から $n=3$：
$$a_3 = a_2 + 2b_2 = 3 + 2\cdot2 = 7,\quad
b_3 = a_2 + b_2 = 3 + 2 = 5.$$

$n=3$ から $n=4$：
$$a_4 = a_3 + 2b_3 = 7 + 2\cdot5 = 17,\quad
b_4 = a_3 + b_3 = 7 + 5 = 12.$$

$n=4$ から $n=5$：
$$a_5 = a_4 + 2b_4 = 17 + 2\cdot12 = 41,\quad
b_5 = a_4 + b_4 = 17 + 12 = 29.$$

$n=5$ から $n=6$：
$$a_6 = a_5 + 2b_5 = 41 + 2\cdot29 = 99,\quad
b_6 = a_5 + b_5 = 41 + 29 = 70.$$

したがって
$$b_4=12,\quad b_5=29,\quad b_6=70.$$

---

(2)  
示すべき等式は
$$(1-\sqrt2)^n = a_n - b_n\sqrt2$$
である。$n$ についての数学的帰納法を用いる。

まず，$n=1$ のとき
$$(1-\sqrt2)^1 = 1-\sqrt2.$$
(1) で求めた $a_1=1, b_1=1$ を用いると
$$a_1 - b_1\sqrt2 = 1 - 1\cdot\sqrt2 = 1-\sqrt2.$$
したがって $n=1$ では成り立つ。

次に，ある正の整数 $k$ について
$$(1-\sqrt2)^k = a_k - b_k\sqrt2$$
が成り立つと仮定する。このとき $n=k+1$ でも同じ形の等式が成り立つことを示す。

左辺を計算すると
$$(1-\sqrt2)^{k+1} = (1-\sqrt2)^k(1-\sqrt2)
= (a_k - b_k\sqrt2)(1-\sqrt2)$$
であるから，展開して
\begin{align*}
(a_k - b_k\sqrt2)(1-\sqrt2)
&= a_k - a_k\sqrt2 - b_k\sqrt2 + 2b_k \\
&= (a_k + 2b_k) - (a_k + b_k)\sqrt2
\end{align*}
となる。

(1) で求めた漸化式
$$a_{k+1}=a_k+2b_k,\quad b_{k+1}=a_k+b_k$$
を用いると
$$(1-\sqrt2)^{k+1} = a_{k+1} - b_{k+1}\sqrt2$$
と書ける。

したがって，$n=k$ のとき成り立つと仮定すると $n=k+1$ でも成り立つことが示された。

以上より，$n=1$ で成り立ち，かつ $n=k$ で成り立つとき $n=k+1$ でも成り立つので，数学的帰納法により，すべての正の整数 $n$ について
$$(1-\sqrt2)^n = a_n - b_n\sqrt2$$
が成り立つ。

---

(3)  
まず，(1) で得た漸化式から $a_n$ を消去して $b_n$ だけの漸化式を求める。

$b_{n+1}=a_n+b_n$ より $a_n = b_{n+1}-b_n$ と表せる。これを
$$a_{n+1}=a_n+2b_n$$
に代入すると
$$a_{n+1} = (b_{n+1}-b_n) + 2b_n = b_{n+1}+b_n$$
となる。一方，$b_{n+2}=a_{n+1}+b_{n+1}$ であるから
$$b_{n+2} = (b_{n+1}+b_n)+b_{n+1} = 2b_{n+1}+b_n.$$
したがって
$$b_{n+2} = 2b_{n+1}+b_n$$
という 2 次の線形漸化式を得る。

求めるのは $n\ge2$ のときの
$$b_{n+1}b_{n-1}-b_n^2$$
である。これが $n$ によらず一定になることを調べる。

まず具体的に $n=2$ の場合を計算する。(1) で求めた値 $b_1=1,b_2=2,b_3=5$ を用いて
$$b_3b_1-b_2^2 = 5\cdot1 - 2^2 = 5-4 = 1.$$

そこで，一般の $n$ についての式
$$b_{n+1}b_{n-1}-b_n^2$$
も同じ値になることを示す。

漸化式 $b_{n+1} = 2b_n + b_{n-1}$ を用いると
\begin{align*}
b_{n+1}b_{n-1}-b_n^2
&= (2b_n+b_{n-1})b_{n-1} - b_n^2 \\
&= 2b_nb_{n-1} + b_{n-1}^2 - b_n^2 \\
&= (b_n^2 + 2b_nb_{n-1} + b_{n-1}^2) - 2b_n^2 \\
&= (b_n + b_{n-1})^2 - 2b_n^2.
\end{align*}
ここで，$b_{n+1} = 2b_n + b_{n-1}$ から
$$b_{n-1} = b_{n+1} - 2b_n$$
なので
$$b_n + b_{n-1} = b_n + (b_{n+1}-2b_n) = b_{n+1}-b_n.$$
したがって
\begin{align*}
b_{n+1}b_{n-1}-b_n^2
&= (b_{n+1}-b_n)^2 - 2b_n^2 \\
&= b_{n+1}^2 - 2b_{n+1}b_n - b_n^2.
\end{align*}

一方，同じ式を $n-1$ に対して書くと
$$b_n b_{n-2} - b_{n-1}^2 = b_n^2 - 2b_n b_{n-1} - b_{n-1}^2.$$
両辺を比較すると，いずれも形は同じであり，ここから
$$b_{n+1}b_{n-1}-b_n^2 = b_n b_{n-2} - b_{n-1}^2$$
が分かる。すなわち，$b_{n+1}b_{n-1}-b_n^2$ は $n$ を 1 つ小さくしたときの $b_nb_{n-2}-b_{n-1}^2$ と等しく，$n$ を変えても値が変わらないことが分かる。

したがって，すべての $n\ge2$ について
$$b_{n+1}b_{n-1}-b_n^2 = b_3b_1 - b_2^2 = 1.$$

よって
$$b_{n+1}b_{n-1}-{b_n}^2 = 1.$$

---

(4)  
(1) より
$$b_5=29,\quad b_6=70$$
である。条件は
$$pb_6 - qb_5 = 1,\quad 0\le p\le 100,\ 0\le q\le 100$$
すなわち
$$70p - 29q = 1$$
を満たす整数 $p,q$ を 1 組求めることである。

まず拡張ユークリッドの互除法により，$70$ と $29$ の間に
$$70x + 29y = 1$$
という関係を求める。

ユークリッドの互除法を行うと
\begin{align*}
70 &= 29\cdot 2 + 12,\\
29 &= 12\cdot 2 + 5,\\
12 &= 5\cdot 2 + 2,\\
5 &= 2\cdot 2 + 1,
\end{align*}
より $\gcd(70,29)=1$ である。これをさかのぼって 1 を表す。

\begin{align*}
1 &= 5 - 2\cdot2 \\
  &= 5 - 2(12 - 5\cdot2) \\
  &= 5\cdot5 - 2\cdot12 \\
  &= 5(29 - 12\cdot2) - 2\cdot12 \\
  &= 5\cdot29 - 12\cdot12 \\
  &= 5\cdot29 - 12(70 - 29\cdot2) \\
  &= 5\cdot29 - 12\cdot70 + 24\cdot29 \\
  &= (5+24)\cdot29 - 12\cdot70 \\
  &= 29\cdot29 - 12\cdot70.
\end{align*}

したがって
$$-12\cdot70 + 29\cdot29 = 1$$
である。求めたい形 $70p - 29q = 1$ に合わせると
$$70(-12) - 29(-29) = 1$$
となるので，1 組の整数解として
$$p=-12,\quad q=-29$$
が得られる。

一般に，$70p - 29q = 1$ の整数解の 1 組 $(p_0,q_0)$ が分かれば，すべての整数解は
$$p=p_0+29t,\quad q=q_0+70t\quad (t\in\mathbb{Z})$$
と表される。ここでは $(p_0,q_0)=(-12,-29)$ なので
$$p=-12+29t,\quad q=-29+70t.$$

条件 $0\le p\le 100, 0\le q\le 100$ を満たす $t$ を求める。

まず $p$ に対して
$$0\le -12+29t\le 100.$$
左側から
$$-12+29t\ge 0 \ \Longrightarrow\ 29t\ge 12 \ \Longrightarrow\ t\ge \frac{12}{29},$$
右側から
$$-12+29t\le 100 \ \Longrightarrow\ 29t\le 112 \ \Longrightarrow\ t\le \frac{112}{29}.$$
したがって
$$\frac{12}{29}\le t\le \frac{112}{29}.$$

次に $q$ に対して
$$0\le -29+70t\le 100.$$
左側から
$$-29+70t\ge 0 \ \Longrightarrow\ 70t\ge 29 \ \Longrightarrow\ t\ge \frac{29}{70},$$
右側から
$$-29+70t\le 100 \ \Longrightarrow\ 70t\le 129 \ \Longrightarrow\ t\le \frac{129}{70}.$$
したがって
$$\frac{29}{70}\le t\le \frac{129}{70}.$$

両方を満たす整数 $t$ は
$$t=1$$
である。

$t=1$ を代入すると
$$p=-12+29\cdot1 = 17,\quad q=-29+70\cdot1 = 41.$$

確認すると
$$70\cdot17 - 29\cdot41 = 1190 - 1189 = 1,$$
また $0\le 17\le 100,\ 0\le 41\le 100$ を満たす。

したがって，条件を満たす 1 組の解は
$$(p,q)=(17,41)$$
である。