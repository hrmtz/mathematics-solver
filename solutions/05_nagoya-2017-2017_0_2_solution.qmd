(頂点は図のとおり $A$ を原点とし，$B,D,E$ がそれぞれ $x,y,z$ 方向，$C,F,H$ が2座標が1の点，$G$ が $(1,1,1)$ に対応するとみなす。)

---

### (1)

時刻0では $P$ は $A$ にいる。  
時刻1では必ず $B,D,E$ のいずれかにいるので，  
「Aに戻らない」という条件は時刻1では自動的に満たされる。

#### 時刻2

$B,D,E$ の各頂点から1ステップ後の遷移を調べる。

- $B$ の隣接頂点：$A,C,F$  
- $D$ の隣接頂点：$A,C,H$  
- $E$ の隣接頂点：$A,F,H$  

よって，時刻2で  
- $B,D,E$ にいる確率：0（これらに戻る辺がない）
- $C$ にいる確率：  
  $B\to C$ と $D\to C$ の2通りで，各確率は  
  $$
  A\to B\ (\tfrac13),\ B\to C\ (\tfrac13),\quad
  A\to D\ (\tfrac13),\ D\to C\ (\tfrac13)
  $$
  より，全体で  
  $$
  2\cdot \frac{1}{3}\cdot\frac{1}{3}=\frac{2}{9}
  $$
- $F$ にいる確率：同様に $B\to F,E\to F$ の2通りで $\frac{2}{9}$
- $H$ にいる確率：$D\to H,E\to H$ の2通りで $\frac{2}{9}$
- ただし，$A$ にいる場合（$B,D,E$ から $A$ に来る）は「Aに戻らない」条件に反するので除く。

したがって  
- $q_2$ は「C,F,H のいずれか」にいる確率であるから  
  $$
  q_2=\frac{2}{9}+\frac{2}{9}+\frac{2}{9}=\frac{2}{3}
  $$
- $r_2$ は「G にいる確率」で，2ステップでは $G$ に到達できないので  
  $$
  r_2=0
  $$
- $p_2$ は「B,D,E のいずれか」にいる確率で，0 だから  
  $$
  p_2=0
  $$

#### 時刻3

時刻2で A には戻らないので，P は $C,F,H$ のいずれかにいる（確率の総和 $\frac{2}{3}$）。  
これらの頂点の隣接先は
- $C$: $B,D,G$
- $F$: $B,E,G$
- $H$: $D,E,G$

であり，いずれからも $A$ へは行かないので，時刻3でも「Aに戻らない」条件は自動的に満たされる。

よって，時刻3に  
- $B$ にいる確率  
  $C\to B,\ F\to B$ の2通りがあり，各遷移は確率 $\frac{1}{3}$。  
  時刻2で $C,F$ にいる確率はいずれも $\frac{2}{9}$ だから
  $$
  \Pr(\text{3時刻目に }B)=\frac{2}{9}\cdot\frac{1}{3}+\frac{2}{9}\cdot\frac{1}{3}
  =\frac{4}{27}
  $$
- $D$ にいる確率：同様に $C\to D, H\to D$ から $\frac{4}{27}$
- $E$ にいる確率：同様に $F\to E, H\to E$ から $\frac{4}{27}$

よって
$$
p_3=\Pr(\text{B,D,E のいずれか})
=\frac{4}{27}+\frac{4}{27}+\frac{4}{27}
=\frac{4}{9}
$$

また，  
- $G$ にいる確率は $C,F,H$ のいずれからも 1/3 の確率で $G$ に行くから
  $$
  r_3=\left(\frac{2}{9}+\frac{2}{9}+\frac{2}{9}\right)\cdot\frac{1}{3}
  =\frac{2}{9}
  $$
- $C,F,H$ にいる確率は，  
  B,D,E の各頂点から1ステップで C,F,H のいずれかに移る場合である。  
  時刻2で B,D,E にいる確率は 0 であるから，時刻3で C,F,H にいる確率は 0，
  したがって
  $$
  q_3=0
  $$

以上より，
$$
p_2=0,\quad q_2=\frac{2}{3},\quad r_2=0,\qquad
p_3=\frac{4}{9},\quad q_3=0,\quad r_3=\frac{2}{9}
$$

---

### (2)

$n\ge2$ のときの一般形を求める。  
「時刻 $n$ まで一度も A に戻らない」という条件のもとでの  
時刻 $n$ の状態を $\{B,D,E\}$，$\{C,F,H\}$，$\{G\}$ にまとめて考える。

#### 遷移の様子

- B,D,E からは A,C,F などへ行くが，  
  「A に戻らない」条件を課すと，A に行く経路は排除される。
- 同様に，各頂点から
  - $\{B,D,E\}$ へ行く確率
  - $\{C,F,H\}$ へ行く確率
  - $\{G\}$ へ行く確率  
  を整理し，「A へ行く分」は捨てる。

実際に，時刻 $n$ で  
- B,D,E のいずれかにいる確率を $p_n$，
- C,F,H のいずれかにいる確率を $q_n$，
- G にいる確率を $r_n$  

として，条件付きの遷移を列挙する。

1. B,D,E にいるとき  
   - 次に行ける先は A,C,F。  
   - A へ行くと「Aに戻らない」条件に反するので，この場合は排除する。  
   - よって条件を満たしながら1ステップ後に残るのは C,F だけであり，  
     各々に確率 $\frac{1}{3}$。  
   結局，「条件を満たす進み方」の全体を $p_n$ で重みづけると  
   $$
   p_n \ \text{から C,F,H, G, B,D,E への寄与は}
   \quad
   \begin{cases}
   \{C,F,H\} へ：\ \dfrac{2}{3}p_n\\
   \text{他は 0}
   \end{cases}
   $$

2. C,F,H にいるとき  
   - 例えば C の隣接は B,D,G。  
   - いずれの頂点からも A に直接は行かないので，全て許される遷移である。
   - 各々 B,D,G へ確率 $\frac{1}{3}$。  
   F,H からも同様に B,D,E,G に行けるが，いずれも A には行かない。
   3つの頂点 C,F,H は対称なので，まとめると  
   $$
   q_n \ \text{から}
   \begin{cases}
   \{B,D,E\}\ へ：\ \dfrac{2}{3}q_n \\
   \{G\}\ へ：\ \dfrac{1}{3}q_n
   \end{cases}
   $$

3. G にいるとき  
   - 隣接頂点は C,F,H。A へは行かない。  
   - したがって
   $$
   r_n \ \text{から}
   \begin{cases}
   \{C,F,H\}\ へ：\ r_n \\
   \text{他は 0}
   \end{cases}
   $$

以上より，$n\ge2$ について次の漸化式が成り立つ：

$$
\begin{cases}
p_{n+1}=\dfrac{2}{3}q_n\\[4pt]
q_{n+1}=\dfrac{2}{3}p_n+r_n\\[4pt]
r_{n+1}=\dfrac{1}{3}q_n
\end{cases}
$$

#### 初期条件の整理

(1) から
$$
p_2=0,\quad q_2=\frac{2}{3},\quad r_2=0
$$

この漸化式を解く。まず $p_n,q_n,r_n$ の間の関係を1本化する。

第1式と第3式より
$$
p_{n+1}=2r_{n+1}
$$
がすべての $n\ge2$ で成り立つ。よって
$$
p_n=2r_n\quad (n\ge3)
$$
である。（$n$ を $n-1$ に置き換えた。）

$q_n$ を $r_n$ で表す。  
第3式 $r_{n+1}=\frac{1}{3}q_n$ より
$$
q_n=3r_{n+1}\quad (n\ge2)
$$

これを第2式に代入すると  
$$
q_{n+1}=\frac{2}{3}p_n+r_n
=\frac{2}{3}\cdot 2r_n+r_n
=\frac{7}{3}r_n
$$
一方で $q_{n+1}=3r_{n+2}$ なので
$$
3r_{n+2}=\frac{7}{3}r_n
\quad\Longrightarrow\quad
r_{n+2}=\frac{7}{9}r_n
$$

$n\ge2$ について成り立つ。  
初期条件として $r_2=0,\ r_3=\frac{2}{9}$ があるので，  
偶数と奇数で場合分けして解く。

- 偶数番目：$n=2k$ の $r_{2k}$  
  $$
  r_2=0,\quad r_4=\frac{7}{9}r_2=0,\quad
  r_6=\frac{7}{9}r_4=0,\ \dots
  $$
  よって
  $$
  r_{2k}=0\quad (k\ge1)
  $$

- 奇数番目：$n=2k+1$ の $r_{2k+1}$  
  $r_3=\frac{2}{9}$ を用いて  
  $$
  r_5=\frac{7}{9}r_3=\frac{2}{9}\left(\frac{7}{9}\right),\quad
  r_7=\frac{7}{9}r_5=\frac{2}{9}\left(\frac{7}{9}\right)^2,\ \dots
  $$
  帰納的に
  $$
  r_{2k+1}=\frac{2}{9}\left(\frac{7}{9}\right)^{k-1}\quad (k\ge1)
  $$

これで $r_n$ が求まった。つぎに $p_n,q_n$ を表す。

- $p_n=2r_n$ より
  $$
  p_{2k}=2r_{2k}=0,\quad
  p_{2k+1}=2r_{2k+1}
         =\frac{4}{9}\left(\frac{7}{9}\right)^{k-1}
  $$
- $q_n=3r_{n+1}$ より  
  偶数・奇数で分ける：
  $$
  \begin{aligned}
  q_{2k}
  &=3r_{2k+1}
   =3\cdot\frac{2}{9}\left(\frac{7}{9}\right)^{k-1}
   =\frac{2}{3}\left(\frac{7}{9}\right)^{k-1},\\
  q_{2k+1}
  &=3r_{2k+2}=3r_{2(k+1)}=0
  \end{aligned}
  $$

$n\ge2$ のとき，まとめると

- 偶数 $n=2k\ (k\ge1)$ のとき
  $$
  p_{2k}=0,\quad
  q_{2k}=\frac{2}{3}\left(\frac{7}{9}\right)^{k-1},\quad
  r_{2k}=0
  $$
- 奇数 $n=2k+1\ (k\ge1)$ のとき
  $$
  p_{2k+1}=\frac{4}{9}\left(\frac{7}{9}\right)^{k-1},\quad
  q_{2k+1}=0,\quad
  r_{2k+1}=\frac{2}{9}\left(\frac{7}{9}\right)^{k-1}
  $$

---

### (3)

$s_m$ を「時刻 $2m$ で A に初めて戻る確率」とする。

初めて戻るとは，「時刻 $2m$ までは一度も A に戻らず，時刻 $2m$ に A にいる」ことである。  
時刻1では必ず A から出発して B,D,E のいずれかに行くので，  
A への復帰は偶数時刻にしか起こりえない。

時刻 $2m-1$ までは A に戻らず，時刻 $2m$ で A に戻るためには，
- 時刻 $2m-1$ に B,D,E のいずれかにいて
- 時刻 $2m$ に B,D,E から A に戻る

ことが必要かつ十分である。  
このとき，「時刻 $2m-1$ まで一度も A に戻らず B,D,E のいずれかにいる確率」は $p_{2m-1}$ であり，  
B,D,E から A に行く確率は常に $\frac{1}{3}$ であるから

$$
s_m = p_{2m-1}\cdot\frac{1}{3}
$$

となる。

(2) より，
$$
p_{2m-1}=\frac{4}{9}\left(\frac{7}{9}\right)^{(m-1)-1}
       =\frac{4}{9}\left(\frac{7}{9}\right)^{m-2}
\quad (m\ge2)
$$

したがって
$$
s_m
=\frac{1}{3}\cdot\frac{4}{9}\left(\frac{7}{9}\right)^{m-2}
=\frac{4}{27}\left(\frac{7}{9}\right)^{m-2}
\quad (m\ge2)
$$

なお $m=1$ のときは，時刻2で A に初めて戻る確率であるが，  
時刻1で B,D,E に移動し，そこから2ステップ目で A に戻る確率は  
$$
3\cdot\left(\frac{1}{3}\cdot\frac{1}{3}\right)=\frac{1}{3}
$$
なので，
$$
s_1=\frac{1}{3}
$$

以上をまとめると，
$$
s_1=\frac{1}{3},\qquad
s_m=\frac{4}{27}\left(\frac{7}{9}\right)^{m-2}\ (m\ge2)
$$