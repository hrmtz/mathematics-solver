## 解答

(1)  

$n\geqq 3$ とする。  
1 回の試行で番号 3 の玉が出る確率は，白・青・赤にそれぞれ番号 3 が 1 個ずつあるので  
$$
\frac{3}{3n}=\frac{1}{n}
$$
である。よって，番号 3 以外の玉が出る確率は $1-\dfrac{1}{n}=\dfrac{n-1}{n}$ である。

3 回の取り出しのあいだに「少なくとも 1 回番号 3 が出る」事象を $B$ とし，  
「3 回の取り出しで番号の合計が 9 である」事象を $A$ とする。

条件付き確率は  
$$
P(A\mid B)=\frac{P(A\cap B)}{P(B)}
$$
で与えられるので，$P(A\cap B)$ と $P(B)$ を求める。

### $P(B)$ の計算

3 回すべてで番号 3 以外が出る確率は  
$$
\left(\frac{n-1}{n}\right)^3
$$
であるから，
$$
P(B)=1-\left(\frac{n-1}{n}\right)^3
$$
となる。

### $P(A\cap B)$ の計算

和が 9 になる 3 個の番号の組 $(x,y,z)$（順序あり）を調べる。  
番号は 1 以上 $n$ 以下の整数だが，ここでは $n\ge 3$ なので 1,2,3,4,5,6,7,8 まで考えれば足りる。

和が 9 になる自然数の組を（順序は一旦無視して）挙げると，
$$
(1,1,7),\ (1,2,6),\ (1,3,5),\ (1,4,4),\ (2,2,5),\ (2,3,4),\ (3,3,3)
$$
がある。このうち「少なくとも 1 個が 3」であるものを選ぶと
$$
(1,3,5),\ (2,3,4),\ (3,3,3)
$$
である。

1 回の取り出しで，色・番号ともに等しい玉は 1 通りなので，「番号 $a$ の玉が出る」確率は常に $\dfrac{3}{3n}=\dfrac{1}{n}$ である。したがって，3 回取り出した番号が（順序付きで）ある決まった 3 つの値 $(a,b,c)$ になる確率は
$$
\left(\frac{1}{n}\right)^3
$$
である。

そこで，和が 9 でかつ少なくとも 1 つが 3 である順序付きの組の個数を数える。

- $(1,3,5)$ 型：要素がすべて異なるので，順列の個数は $3!=6$ 個  
- $(2,3,4)$ 型：同様に $3!=6$ 個  
- $(3,3,3)$ 型：全部同じなので $1$ 個  

よって該当する順序付き組の総数は
$$
6+6+1=13
$$
であり，
$$
P(A\cap B)=13\left(\frac{1}{n}\right)^3=\frac{13}{n^3}
$$
となる。

以上から
$$
P(A\mid B)=\frac{P(A\cap B)}{P(B)}
=\frac{\dfrac{13}{n^3}}{1-\left(\dfrac{n-1}{n}\right)^3}
$$
となる。分母を整理すると，
$$
1-\left(\frac{n-1}{n}\right)^3
=1-\frac{(n-1)^3}{n^3}
=\frac{n^3-(n-1)^3}{n^3}
$$
なので，
$$
P(A\mid B)
=\frac{\dfrac{13}{n^3}}{\dfrac{n^3-(n-1)^3}{n^3}}
=\frac{13}{n^3-(n-1)^3}
$$
である。

従って，求める条件付き確率は
$$
\boxed{\displaystyle \frac{13}{\,n^3-(n-1)^3\,}}
$$
である。

---

(2)  

$n\ge 1$ とする。  
「少なくとも 1 個は番号 1 の赤玉が含まれる」事象を $C$，  
「3 個すべてが赤玉である」事象を $D$ とおく。求める条件付き確率は
$$
p(n)=P(D\mid C)=\frac{P(C\cap D)}{P(C)}
$$
である。

### $P(C)$ の計算

1 回の試行で番号 1 の赤玉が出る確率は  
$$
\frac{1}{3n}
$$
である。したがって，1 回の試行で「番号 1 の赤玉以外」が出る確率は
$$
1-\frac{1}{3n}=\frac{3n-1}{3n}
$$
である。

3 回とも番号 1 の赤玉が出ない確率は
$$
\left(\frac{3n-1}{3n}\right)^3
$$
であるから，
$$
P(C)=1-\left(\frac{3n-1}{3n}\right)^3
$$
となる。

### $P(C\cap D)$ の計算

事象 $C\cap D$ は「3 個とも赤玉で，かつその中に少なくとも 1 個番号 1 の赤玉がある」ことである。

1 回の試行で赤玉が出る確率は，赤玉が $n$ 個なので
$$
\frac{n}{3n}=\frac{1}{3}
$$
である。よって，3 回とも赤玉が出る確率は
$$
P(D)=\left(\frac{1}{3}\right)^3=\frac{1}{27}
$$
である。

また，1 回の試行で
- 「赤玉で番号 1 でない」玉が出る確率は，赤玉のうち番号 1 以外が $n-1$ 個あるので
  $$
  \frac{n-1}{3n}
  $$
  となる。  

したがって，「3 回とも『赤玉で番号 1 でない』玉が出る」確率は
$$
\left(\frac{n-1}{3n}\right)^3
$$
である。これは，「3 回とも赤玉で，しかも全部番号 1 ではない」場合に対応する。

したがって，「3 回とも赤玉で，その中に少なくとも 1 個は番号 1 の赤玉がある」確率は
$$
P(C\cap D)=P(D)-\left(\frac{n-1}{3n}\right)^3
=\frac{1}{27}-\frac{(n-1)^3}{27n^3}
=\frac{n^3-(n-1)^3}{27n^3}
$$
となる。

以上より
$$
p(n)=\frac{P(C\cap D)}{P(C)}
=\frac{\dfrac{n^3-(n-1)^3}{27n^3}}{1-\left(\dfrac{3n-1}{3n}\right)^3}
$$
となる。分母を整理すると，
$$
1-\left(\frac{3n-1}{3n}\right)^3
=\frac{(3n)^3-(3n-1)^3}{(3n)^3}
=\frac{27n^3-(3n-1)^3}{27n^3}
$$
なので，
$$
p(n)=\frac{\dfrac{n^3-(n-1)^3}{27n^3}}{\dfrac{27n^3-(3n-1)^3}{27n^3}}
=\frac{n^3-(n-1)^3}{27n^3-(3n-1)^3}
$$
である。

よって
$$
\boxed{\displaystyle p(n)=\frac{\,n^3-(n-1)^3\,}{\,27n^3-(3n-1)^3\,}}
$$
となる。

---

(3)  

(2) で求めた
$$
p(n)=\frac{n^3-(n-1)^3}{27n^3-(3n-1)^3}
$$
の最小値を求める。

分子分母を展開して整理する。

まず
$$
n^3-(n-1)^3
=n^3-\{n^3-3n^2+3n-1\}
=3n^2-3n+1
$$
である。  

次に
\begin{align*}
(3n-1)^3
&=(3n)^3-3(3n)^2\cdot 1+3(3n)\cdot 1^2-1^3\\
&=27n^3-27n^2+9n-1
\end{align*}
なので
$$
27n^3-(3n-1)^3
=27n^3-\{27n^3-27n^2+9n-1\}
=27n^2-9n+1
$$
となる。したがって
$$
p(n)=\frac{3n^2-3n+1}{27n^2-9n+1}
$$
である。

$n\ge 1$ の整数での最小値を調べる。まず連続変数としての性質を見るため，実数 $x>0$ に対する関数
$$
f(x)=\frac{3x^2-3x+1}{27x^2-9x+1}
$$
を考え，その単調性を調べる。

$f(x)$ の分母は
$$
27x^2-9x+1=27\left(x-\frac{1}{6}\right)^2+\frac{1}{4}>0
$$
より $x>0$ で常に正なので，$f(x)$ の符号や増減は分子と導関数に依存する。

$f(x)$ を微分する。商の微分公式を用いると
$$
f'(x)=\frac{(6x-3)(27x^2-9x+1)-(3x^2-3x+1)(54x-9)}{(27x^2-9x+1)^2}
$$
となる。分母は常に正なので，分子を整理する。

分子を $N(x)$ とおくと
\begin{align*}
N(x)
&=(6x-3)(27x^2-9x+1)-(3x^2-3x+1)(54x-9).
\end{align*}
第 1 項を展開すると
\begin{align*}
(6x-3)(27x^2-9x+1)
&=6x(27x^2-9x+1)-3(27x^2-9x+1)\\
&=162x^3-54x^2+6x-81x^2+27x-3\\
&=162x^3-135x^2+33x-3.
\end{align*}
第 2 項を展開すると
\begin{align*}
(3x^2-3x+1)(54x-9)
&=3x^2(54x-9)-3x(54x-9)+1\cdot(54x-9)\\
&=162x^3-27x^2-162x^2+27x+54x-9\\
&=162x^3-189x^2+81x-9.
\end{align*}
よって
\begin{align*}
N(x)
&=(162x^3-135x^2+33x-3)-(162x^3-189x^2+81x-9)\\
&=54x^2-48x+6.
\end{align*}
したがって
$$
f'(x)=\frac{54x^2-48x+6}{(27x^2-9x+1)^2}
=\frac{6(9x^2-8x+1)}{(27x^2-9x+1)^2}.
$$

分母は $x>0$ で常に正なので，符号は分子の $9x^2-8x+1$ によって決まる。  
これを 0 とおくと
$$
9x^2-8x+1=0
$$
であり，解の公式から
$$
x=\frac{8\pm\sqrt{64-36}}{18}
=\frac{8\pm\sqrt{28}}{18}
=\frac{4\pm\sqrt{7}}{9}
$$
となる。2 つの解を
$$
x_1=\frac{4-\sqrt{7}}{9},\quad x_2=\frac{4+\sqrt{7}}{9}
$$
とおくと，$9x^2-8x+1$ は上に凸の二次式であるから，
$$
x_1<x_2,\quad
x<x_1,\ x_1<x<x_2,\ x>x_2
$$
の各区間で符号はそれぞれ $+$, $-$, $+$ である。

よって $f(x)$ は
- $0<x<x_1$ で増加
- $x_1<x<x_2$ で減少
- $x>x_2$ で増加  

となり，$x_1$ が極大，$x_2$ が極小となる。

問題で考える $n$ は 1 以上の整数なので，$x\ge 1$ の範囲を見ればよい。  
$x_2$ の値は
$$
x_2=\frac{4+\sqrt{7}}{9}\approx\frac{4+2.6458}{9}\approx\frac{6.6458}{9}\approx0.738\ldots
$$
であり，$x_2<1$ である。従って，$x\ge 1$ においては $f'(x)>0$ となり，$f(x)$ は $x\ge 1$ で単調増加である。

したがって，$n\ge 1$ の整数において $p(n)=f(n)$ の最小値は $n=1$ のときにとられる。

$n=1$ を代入すると
$$
p(1)=\frac{3\cdot 1^2-3\cdot 1+1}{27\cdot 1^2-9\cdot 1+1}
=\frac{3-3+1}{27-9+1}
=\frac{1}{19}
$$
となる。

よって，$p(n)$ の最小値は
$$
\boxed{\displaystyle \frac{1}{19}}
$$
である。

---

(4)  

(2) より
$$
p(n)=\frac{3n^2-3n+1}{27n^2-9n+1}
$$
である。分子・分母とも $n$ の 2 次式なので，最高次の係数の比をとれば極限が求まる。具体的には，分子分母を $n^2$ で割ると
$$
p(n)=\frac{3-\dfrac{3}{n}+\dfrac{1}{n^2}}{27-\dfrac{9}{n}+\dfrac{1}{n^2}}
$$
となる。

$n\to\infty$ のとき，$\dfrac{1}{n}\to 0,\ \dfrac{1}{n^2}\to 0$ なので，
$$
\lim_{n\to\infty}p(n)
=\frac{3}{27}
=\frac{1}{9}
$$
である。

したがって
$$
\boxed{\displaystyle \lim_{n\to\infty}p(n)=\frac{1}{9}}
$$
となる。