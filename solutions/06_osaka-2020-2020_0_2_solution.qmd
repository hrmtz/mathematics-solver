## 解答

(1)  

さいころを1回投げたとき，  
- 1の目が出る確率は $\dfrac{1}{6}$（時計回りに1つ進む），  
- 2の目が出る確率は $\dfrac{1}{6}$（反時計回りに1つ進む），  
- 3,4,5,6の目が出る確率は合計 $\dfrac{4}{6}=\dfrac{2}{3}$（動かない）  
である．

A,B,Cは円周を3等分する点なので，隣に1つ進むことは「位置を $+1$（または $-1$）だけ変える」こととみなせる．  
Aを $0$，Bを $1$，Cを $2$（いずれも法3）とおくと，  
1回ごとの変化量 $X$ は  
- $X=+1$（確率 $\dfrac{1}{6}$），
- $X=-1$（確率 $\dfrac{1}{6}$），
- $X=0$（確率 $\dfrac{2}{3}$）  
となる．

Aから出発するので，2回投げたあとの位置は $X_1+X_2$（法3）で与えられる．  
Aに戻る条件は  
$$
X_1+X_2\equiv 0 \pmod{3}
$$
となることである．

取り得る組 $(X_1,X_2)$ とその和を調べると

- $(0,0)$：確率 $\dfrac{2}{3}\cdot\dfrac{2}{3}=\dfrac{4}{9}$，和 $0$
- $(1,1)$：確率 $\dfrac{1}{6}\cdot\dfrac{1}{6}=\dfrac{1}{36}$，和 $2$
- $(-1,-1)$：確率 $\dfrac{1}{6}\cdot\dfrac{1}{6}=\dfrac{1}{36}$，和 $-2$
- $(1,-1),(-1,1)$：それぞれ確率 $\dfrac{1}{36}$，和 $0$

和が $0$（法3）になるのは
- $(0,0)$：和 $0$
- $(1,1)$：和 $2\equiv -1\pmod{3}$ なので不適
- $(-1,-1)$：和 $-2\equiv 1\pmod{3}$ なので不適
- $(1,-1),(-1,1)$：和 $0$

したがって  
$$
p_2 = P\bigl((0,0)\bigr) + P\bigl((1,-1)\bigr) + P\bigl((-1,1)\bigr)
= \frac{4}{9} + \frac{1}{36} + \frac{1}{36}
= \frac{4}{9} + \frac{2}{36}
= \frac{4}{9} + \frac{1}{18}
= \frac{9}{18}
= \frac{1}{2}
$$

よって，
$$
p_2 = \frac{1}{2}
$$
である．

---

(2)  

$n$回投げたあとの位置を
- Aにいる確率：$a_n$
- Bにいる確率：$b_n$
- Cにいる確率：$c_n$
とおくと，初期条件は $a_0=1,\;b_0=c_0=0$ であり，$p_n=a_n$ である．

遷移を考える．  
$n$回目のあとで A にいるためには，$(n-1)$回目のあとに

- Aにいて動かない（3,4,5,6の目）：確率 $a_{n-1}\cdot\dfrac{2}{3}$
- Bにいて反時計回りにAへ（2の目）：確率 $b_{n-1}\cdot\dfrac{1}{6}$
- Cにいて時計回りにAへ（1の目）：確率 $c_{n-1}\cdot\dfrac{1}{6}$  

のいずれかであるから，
$$
a_n = \frac{2}{3}a_{n-1} + \frac{1}{6}b_{n-1} + \frac{1}{6}c_{n-1}
$$

同様に，$n$回後に B, C にいる確率についても
$$
b_n = \frac{2}{3}b_{n-1} + \frac{1}{6}a_{n-1} + \frac{1}{6}c_{n-1}
$$
$$
c_n = \frac{2}{3}c_{n-1} + \frac{1}{6}a_{n-1} + \frac{1}{6}b_{n-1}
$$
が成り立つ．

ここで，$a_n+b_n+c_n=1$ であることから
$$
b_{n-1}+c_{n-1} = 1-a_{n-1}
$$
であり，これを $a_n$ の式に代入すると
$$
a_n
= \frac{2}{3}a_{n-1} + \frac{1}{6}(b_{n-1}+c_{n-1})
= \frac{2}{3}a_{n-1} + \frac{1}{6}(1-a_{n-1})
$$
$$
= \frac{2}{3}a_{n-1} + \frac{1}{6} - \frac{1}{6}a_{n-1}
= \left(\frac{2}{3}-\frac{1}{6}\right)a_{n-1} + \frac{1}{6}
= \frac{1}{2}a_{n-1} + \frac{1}{6}
$$

したがって $p_n=a_n$ を用いると
$$
p_{n+1} = \frac{1}{2}p_n + \frac{1}{6}
$$
となる．

---

(3)  

(2)で得た漸化式
$$
p_{n+1} = \frac{1}{2}p_n + \frac{1}{6}
$$
を初期条件 $p_0=1$ のもとで解く．

この一次不定漸化式を解くために，定数解を調べる．  
$p_{n+1}=p_n=p$ とおくと
$$
p = \frac{1}{2}p + \frac{1}{6}
$$
より
$$
\frac{1}{2}p = \frac{1}{6} \quad\Rightarrow\quad p=\frac{1}{3}
$$
である．この定数解 $p=\dfrac{1}{3}$ を用いて，$q_n = p_n - \dfrac{1}{3}$ とおくと
$$
q_{n+1} = p_{n+1} - \frac{1}{3}
= \left(\frac{1}{2}p_n + \frac{1}{6}\right) - \frac{1}{3}
= \frac{1}{2}p_n - \frac{1}{6}
$$
一方で
$$
\frac{1}{2}q_n = \frac{1}{2}\left(p_n - \frac{1}{3}\right)
= \frac{1}{2}p_n - \frac{1}{6}
$$
であるから
$$
q_{n+1} = \frac{1}{2}q_n
$$
となる．

初期条件は
$$
q_0 = p_0 - \frac{1}{3} = 1 - \frac{1}{3} = \frac{2}{3}
$$
なので，
$$
q_n = q_0\left(\frac{1}{2}\right)^n
= \frac{2}{3}\left(\frac{1}{2}\right)^n
$$
である．

したがって
$$
p_n = q_n + \frac{1}{3}
= \frac{2}{3}\left(\frac{1}{2}\right)^n + \frac{1}{3}
$$
となり，整理すると
$$
p_n = \frac{1}{3} + \frac{2}{3}\left(\frac{1}{2}\right)^n
$$

よって
$$
p_n = \frac{1}{3} + \frac{2}{3}\left(\frac{1}{2}\right)^n
$$
である．