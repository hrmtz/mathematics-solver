(1)  

カードはA, A, Bの3枚なので，1回の試行でAが出る確率は  
$$
P(A)=\frac23,\quad P(B)=\frac13
$$
である。

### $p_2,\,q_2,\,r_2$ の計算

$n=2$ のとき，長さ2の文字列でAAAやBBは生じないので，  
可である条件は自動的に満たされる。

- 右端2文字がAA となる確率  
  $p_2 = P(\text{AA}) = \left(\frac23\right)^2 = \frac49$

- 右端2文字がBA となる確率  
  $q_2 = P(\text{BA}) = \frac13\cdot\frac23 = \frac29$

- 右端の文字がB となる確率  
  $r_2 = P(\text{*B}) = \frac23\cdot\frac13 + \frac13\cdot\frac13 
  = \frac{2}{9}+\frac{1}{9} = \frac{1}{3}$  

したがって
$$
p_2=\frac49,\quad q_2=\frac29,\quad r_2=\frac13
$$
である。

### 漸化式の導出

長さ $n$ の可な文字列のうち，
- 右端2文字がAAの確率：$p_n$
- 右端2文字がBAの確率：$q_n$
- 右端文字がBの確率：$r_n$

とおく。長さ $n+1$ の文字列について考える。

#### (i) $p_{n+1}$（右端2文字がAA）

右端2文字がAAとなるには，最後にAを引き，その1つ前もAである必要がある。

可でかつ右端2文字がAAで終わる長さ $n$ の文字列は，長さ $n+1$ にAを付け加えるとAAAで終わり不可になるので使えない。

したがって，長さ $n$ の時点で可でかつ右端2文字がBAである場合（確率 $q_n$）に，  
最後にAを引けば，右端2文字がAAとなり，AAAもBBも生じない。

よって
$$
p_{n+1} = \frac{2}{3}q_n
$$
である。

#### (ii) $q_{n+1}$（右端2文字がBA）

右端2文字がBAとなるには，最後の2文字が「B,A」と並ぶ必要がある。  
すなわち，長さ $n$ の時点で右端文字がBであり（確率 $r_n$），  
その次にAを引く場合である。

このとき  
- 右端がB であり，その直前もB であったら，もともとBBで不可であるから，  
$r_n$ にはそのような列は含まれていない。
- Aを付けてもBBB などは生じず，AAAも生じない。

したがって
$$
q_{n+1} = \frac23 r_n
$$
である。

#### (iii) $r_{n+1}$（右端文字がB）

右端がBとなるには，長さ $n$ の時点で可であり，最後にBを引く場合である。

- 長さ $n$ の時点で右端がB（確率 $r_n$）の場合にBを引くとBBとなり不可だから，  
この場合は使えない。
- 長さ $n$ の時点で右端がAである可な列にBを付ければ，  
BBは生じず，AAAも生じない。

右端がAである可な列の確率は，「右端2文字がAA」または「右端2文字がBA」の場合に限られるので，  
確率は $p_n + q_n$ である。

よって
$$
r_{n+1} = \frac13(p_n + q_n)
$$
である。

以上より
$$
p_{n+1}=\frac23 q_n,\quad
q_{n+1}=\frac23 r_n,\quad
r_{n+1}=\frac13(p_n+q_n)
$$
を得る。

---

(2)  

$$
s_n = p_n + 2q_n + 2r_n
$$
とおく。まず $s_2$ を求める。

(1)の結果より
$$
s_2 = p_2 + 2q_2 + 2r_2
= \frac49 + 2\cdot\frac29 + 2\cdot\frac13
= \frac49 + \frac49 + \frac{8}{12}
= \frac89 + \frac{6}{9}
= \frac{14}{9}
$$

次に $s_{n+1}$ を $s_n$ で表す。  
(1)の漸化式と $p_{n+1}+2q_{n+1}+2r_{n+1}$ を用いる：

\[
\begin{aligned}
s_{n+1}
&= p_{n+1} + 2q_{n+1} + 2r_{n+1} \\
&= \frac23 q_n + 2\cdot\frac23 r_n 
   + 2\cdot\frac13(p_n+q_n) \\
&= \frac23 q_n + \frac43 r_n + \frac23 p_n + \frac23 q_n \\
&= \frac23 p_n + \frac43 q_n + \frac43 r_n \\
&= \frac23 (p_n + 2q_n + 2r_n)\cdot\frac{1}{1} \\
&= \frac23 s_n
\end{aligned}
\]

よって
$$
s_{n+1} = \frac23 s_n
$$
である。この1次漸化式を解くと，  
初期値 $s_2=\dfrac{14}{9}$ より
$$
s_n = s_2\left(\frac23\right)^{n-2}
= \frac{14}{9}\left(\frac23\right)^{n-2}
$$
となる。

したがって
$$
p_n + 2q_n + 2r_n
= \frac{14}{9}\left(\frac23\right)^{n-2}
$$
である。

---

(3)  

$$
z_n = p_n + i q_n - (1+i) r_n
$$
とおく。$z_n$ を $n$ の式で表す。

### 漸化式の導出

(1)の漸化式を用いて $z_{n+1}$ を $p_n,q_n,r_n$ で表す：

\[
\begin{aligned}
z_{n+1}
&= p_{n+1} + i q_{n+1} - (1+i) r_{n+1} \\
&= \frac23 q_n + i\cdot\frac23 r_n
   - (1+i)\cdot\frac13(p_n+q_n) \\
&= \frac23 q_n + \frac{2i}{3} r_n
   - \frac13(1+i)p_n - \frac13(1+i)q_n \\
&= -\frac13(1+i)p_n 
   + \left(\frac23 - \frac13(1+i)\right)q_n
   + \frac{2i}{3} r_n
\end{aligned}
\]

中括弧の係数を計算する：
\[
\frac23 - \frac13(1+i)
= \frac{2}{3} - \frac{1}{3} - \frac{i}{3}
= \frac{1}{3} - \frac{i}{3}
= \frac{1-i}{3}
\]

したがって
\[
z_{n+1}
= -\frac{1+i}{3}p_n + \frac{1-i}{3}q_n + \frac{2i}{3}r_n
\]

ここで $z_n$ の定義式
$$
z_n = p_n + i q_n - (1+i) r_n
$$
を用いて $p_n,q_n,r_n$ の線形和として $z_n$ を表し，  
$z_{n+1}$ との関係を見つける。

$z_n$ に $1+i$ をかけると
\[
\begin{aligned}
(1+i)z_n
&= (1+i)p_n + i(1+i)q_n - (1+i)^2 r_n\\
&= (1+i)p_n + (i-1)q_n - 2 i r_n
\end{aligned}
\]

よって
\[
\begin{aligned}
-z_{n+1}
&= \frac{1+i}{3}p_n - \frac{1-i}{3}q_n - \frac{2i}{3}r_n \\
&= \frac{1}{3}\bigl[(1+i)p_n + (i-1)q_n - 2i r_n\bigr]\\
&= \frac{1}{3}(1+i)z_n
\end{aligned}
\]

したがって
$$
z_{n+1} = -\frac{1+i}{3} z_n
$$
となる。

### 解の一般形

これは1次の複素数列の漸化式であり，
$$
z_{n+1} = c z_n,\quad c=-\frac{1+i}{3}
$$
の形であるから
$$
z_n = z_2\,c^{\,n-2}
$$
と表せる。

まず $z_2$ を求める。  
(1)より $p_2=\frac49,\ q_2=\frac29,\ r_2=\frac13$ なので
\[
\begin{aligned}
z_2
&= p_2 + i q_2 - (1+i) r_2 \\
&= \frac49 + i\cdot\frac29 - (1+i)\cdot\frac13 \\
&= \frac49 + \frac{2i}{9} - \frac{1}{3} - \frac{i}{3} \\
&= \left(\frac49 - \frac{3}{9}\right)
   + \left(\frac{2i}{9} - \frac{3i}{9}\right) \\
&= \frac{1-i}{9}
\end{aligned}
\]

よって
\[
\begin{aligned}
z_n
&= \frac{1-i}{9}
   \left(-\frac{1+i}{3}\right)^{n-2}\\
&= \frac{1-i}{9}\,(-1)^{n-2}
   \left(\frac{1+i}{3}\right)^{n-2}
\end{aligned}
\]

ここで $1+i = \sqrt{2}\,e^{i\pi/4}$ を用いてもよいが，  
問題文は $n$ による式を求めればよいので，  
このまま書いておく。

したがって
$$
p_n + i q_n - (1+i) r_n
= \frac{1-i}{9}\left(-\frac{1+i}{3}\right)^{n-2}
$$
である。

---

(4)  

$p_n = r_n$ となる $n$ の必要十分条件を求める。

$p_n = r_n$ は
$$
p_n - r_n = 0
$$
と同値である。これを (3) で得た式と (2) の式から判定する。

まず $p_n = r_n$ と仮定すると
\[
\begin{aligned}
z_n
&= p_n + i q_n - (1+i) r_n \\
&= (r_n) + i q_n - (1+i) r_n \\
&= i q_n - i r_n \\
&= i(q_n - r_n)
\end{aligned}
\]
となる。従って $p_n=r_n$ ならば $z_n$ は純虚数である。

(3)の結果を用いると
\[
z_n = \frac{1-i}{9}\left(-\frac{1+i}{3}\right)^{n-2}
\]
なので，これが純虚数となる $n$ を考える。

$1-i = \sqrt{2}\,e^{-i\pi/4}$，$1+i = \sqrt{2}\,e^{i\pi/4}$ とおくと
\[
\begin{aligned}
z_n
&= \frac{1}{9}\,(\sqrt{2}e^{-i\pi/4})
          \left(-\frac{\sqrt{2}e^{i\pi/4}}{3}\right)^{n-2} \\
&= \frac{1}{9}\,(\sqrt{2}e^{-i\pi/4})
   \left(\frac{\sqrt{2}}{3}e^{i\pi/4}\cdot(-1)\right)^{n-2} \\
&= \frac{1}{9}\left(\frac{2}{3}\right)^{n-2}
   e^{-i\pi/4}
   \left(e^{i\pi/4}\cdot e^{i\pi}\right)^{n-2} \\
&= \frac{1}{9}\left(\frac{2}{3}\right)^{n-2}
   e^{-i\pi/4}
   e^{i(\pi/4 + \pi)(n-2)} \\
&= \frac{1}{9}\left(\frac{2}{3}\right)^{n-2}
   e^{i\left[(n-2)\frac{5\pi}{4} - \frac{\pi}{4}\right]} \\
&= \frac{1}{9}\left(\frac{2}{3}\right)^{n-2}
   e^{i\frac{5n-11}{4}\pi}
\end{aligned}
\]

したがって $z_n$ の偏角は
$$
\theta_n = \frac{5n-11}{4}\pi
$$
（$2\pi$ を法として）である。

$z_n$ が純虚数であることは，偏角が $\frac{\pi}{2}$ または $\frac{3\pi}{2}$（すなわち $\frac{\pi}{2}+\pi k$）であることと同値なので，
$$
\frac{5n-11}{4}\pi \equiv \frac{\pi}{2} \pmod{\pi}
$$
すなわち
$$
\frac{5n-11}{4}\pi = \frac{\pi}{2} + k\pi
\quad(k\in\mathbb{Z})
$$
とおける。両辺を $\pi$ で割り，4倍して
\[
5n - 11 = 2 + 4k
\]
したがって
\[
5n = 13 + 4k
\]

ここで $n$ は整数なので，$5n \equiv 13 \pmod{4}$，すなわち
\[
n \equiv 13 \pmod{4}
\]
となる。$13 \equiv 1 \pmod{4}$ だから，
$$
n \equiv 1 \pmod{4}
$$
すなわち
$$
n = 4m+1\quad(m\in\mathbb{Z})
$$
である。

$n\ge 2$ であるから，実際には $m\ge 1$ であり，
$$
n = 4m+1\quad(m\ge 1\text{ の整数})
$$
が可能な $n$ である。

逆に $n\equiv 1\pmod{4}$ のとき $z_n$ は純虚数となり，上の式から $p_n=r_n$ が成り立つ。

以上より，$p_n = r_n$ となる $n$ の必要十分条件は
$$
n\equiv 1 \pmod{4},\ \text{すなわち}\ n=4m+1\ (m\ge 1)
$$
である。