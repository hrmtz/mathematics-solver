## 解答

(1)  

さいころの出る目は $1,2,3,4,5,6$ の 6 通りで，$X_1,X_2$ は独立に一様に分布している．  

### $L_2=5$ となる確率

$L_2=\operatorname{lcm}(X_1,X_2)=5$ となるには，$X_1,X_2$ の値は 5 の約数で，かつ最小公倍数が 5 でなければならない．  
5 の正の約数は $1,5$ のみなので，$(X_1,X_2)$ の可能性は
$$(1,5),(5,1),(5,5)$$
の 3 通りである．

全事象数は $6\times 6=36$ 通りなので，
$$
P(L_2=5)=\frac{3}{36}=\frac{1}{12}
$$
である．

### $G_2=5$ となる確率

$G_2=\gcd(X_1,X_2)=5$ となるには，$X_1$ と $X_2$ の両方が 5 の倍数であり，かつ共通因数が 5 だけでなければならない．  
しかし，さいころの目で 5 の倍数は 5 のみなので，$X_1=X_2=5$ である．  
このとき $\gcd(5,5)=5$ で条件を満たす．従って，$(X_1,X_2)=(5,5)$ の 1 通りだけである．

よって
$$
P(G_2=5)=\frac{1}{36}
$$
となる．

---

(2)  

$L_n$ が素数である場合を考え，その余事象を用いて求める．  
$L_n$ が素数であるとき，この素数を $p$ とおくと，$X_1,\dots,X_n$ のすべての値は $p$ の約数であり，かつ最小公倍数が $p$ であるから，$p$ 以外の素因数をもつ数は出てこない．  
さいころの目 $\{1,2,3,4,5,6\}$ の中で素数は $2,3,5$ の 3 個である．

#### 場合分けによる $L_n$ が素数となる事象の列挙

- $L_n=2$ のとき  
  各 $X_k$ は $2$ の約数であり，かつ最小公倍数が $2$ である．  
  2 の約数は $1,2$ なので，$X_k\in\{1,2\}$ であり，少なくとも 1 回は 2 が出る．
  よって確率は
  $$
  P(L_n=2)=\left(\frac{2}{6}\right)^n-\left(\frac{1}{6}\right)^n
           =\left(\frac{1}{3}\right)^n-\left(\frac{1}{6}\right)^n
  $$

- $L_n=3$ のとき  
  同様に 3 の約数は $1,3$ なので，$X_k\in\{1,3\}$ であり，少なくとも 1 回は 3 が出る．
  よって
  $$
  P(L_n=3)=\left(\frac{2}{6}\right)^n-\left(\frac{1}{6}\right)^n
           =\left(\frac{1}{3}\right)^n-\left(\frac{1}{6}\right)^n
  $$

- $L_n=5$ のとき  
  5 の約数は $1,5$ なので，$X_k\in\{1,5\}$ であり，少なくとも 1 回は 5 が出る．
  よって
  $$
  P(L_n=5)=\left(\frac{2}{6}\right)^n-\left(\frac{1}{6}\right)^n
           =\left(\frac{1}{3}\right)^n-\left(\frac{1}{6}\right)^n
  $$

これら 3 つの事象は互いに排反であるので，
$$
P(L_n\ \text{が素数})=3\left\{\left(\frac{1}{3}\right)^n-\left(\frac{1}{6}\right)^n\right\}
$$

したがって，$L_n$ が素数でない確率は
$$
\begin{aligned}
P(L_n\ \text{が素数でない})
&=1-P(L_n\ \text{が素数}) \\
&=1-3\left\{\left(\frac{1}{3}\right)^n-\left(\frac{1}{6}\right)^n\right\}
\end{aligned}
$$
となる．

---

(3)  

$G_n$ が素数である場合を考え，同様に余事象を用いる．  
$G_n$ が素数 $p$ であるとき，すべての $X_k$ は $p$ の倍数であり，かつ最大公約数がちょうど $p$ である必要がある．  
さいころの目のうち，2 の倍数は $\{2,4,6\}$，3 の倍数は $\{3,6\}$，5 の倍数は $\{5\}$ なので，素数ごとに場合分けする．

#### $G_n=2$ のとき

各 $X_k$ は 2 の倍数なので $X_k\in\{2,4,6\}$ である．  
このときの確率全体は $\left(\frac{3}{6}\right)^n=\left(\frac{1}{2}\right)^n$ である．  
さらに，$\gcd(X_1,\dots,X_n)=2$ となるには，共通因数が 2 だけでなければならないから，
- 全ての $X_k$ が 4 または 6（=2の2倍または3倍）であれば，最大公約数は $2$ またはそれ以上になる可能性があるので注意して数える必要がある．  
ここでは「最大公約数が 4 または 6 となる場合」を排除して考える．

実際には，$X_k$ が 2 の倍数であるとき，それぞれを $2Y_k$ とおくと，$Y_k\in\{1,2,3\}$ であり，
$$
G_n=2 \iff \gcd(Y_1,\dots,Y_n)=1
$$
が成り立つ（最大公約数の性質より）．

そこで，$Y_k$ を 1,2,3 が等確率で出る独立な試行とみなす．  
$\gcd(Y_1,\dots,Y_n)=1$ の余事象は，$\gcd(Y_1,\dots,Y_n)>1$，つまり全ての $Y_k$ が 2 の倍数か 3 の倍数である場合である．  
2 の倍数は $\{2\}$，3 の倍数は $\{3\}$ なので，  
- 全て 2 である場合：確率 $\left(\frac{1}{3}\right)^n$  
- 全て 3 である場合：確率 $\left(\frac{1}{3}\right)^n$  
この 2 つは排反なので，
$$
P(\gcd(Y_1,\dots,Y_n)>1)=2\left(\frac{1}{3}\right)^n
$$
よって
$$
P(\gcd(Y_1,\dots,Y_n)=1)=1-2\left(\frac{1}{3}\right)^n
$$

元に戻すと，$X_k$ がすべて 2 の倍数である確率は $\left(\frac{1}{2}\right)^n$ であり，その条件の下で $\gcd(Y_1,\dots,Y_n)=1$ となる確率が上で求めたものなので，
$$
P(G_n=2)=\left(\frac{1}{2}\right)^n\left\{1-2\left(\frac{1}{3}\right)^n\right\}
$$

#### $G_n=3$ のとき

各 $X_k$ は 3 の倍数なので $X_k\in\{3,6\}$ である．確率全体は $\left(\frac{2}{6}\right)^n=\left(\frac{1}{3}\right)^n$．  
$X_k=3Z_k$ とおくと，$Z_k\in\{1,2\}$ であり，
$$
G_n=3 \iff \gcd(Z_1,\dots,Z_n)=1
$$
である．

$Z_k$ は 1,2 を等確率 $\frac{1}{2}$ でとる．  
$\gcd(Z_1,\dots,Z_n)=1$ とならないのは，全ての $Z_k$ が 2 のときだけなので，
$$
P(\gcd(Z_1,\dots,Z_n)=1)=1-\left(\frac{1}{2}\right)^n
$$
したがって
$$
P(G_n=3)=\left(\frac{1}{3}\right)^n\left\{1-\left(\frac{1}{2}\right)^n\right\}
$$

#### $G_n=5$ のとき

各 $X_k$ は 5 の倍数である必要があり，さいころの目のうち 5 の倍数は 5 しかないので，全て $X_k=5$ でなければならない．  
このとき確率は
$$
P(G_n=5)=\left(\frac{1}{6}\right)^n
$$

#### $G_n$ が素数となる確率と，その余事象

上の 3 つの事象は互いに排反なので，
$$
\begin{aligned}
P(G_n\ \text{が素数})
&=P(G_n=2)+P(G_n=3)+P(G_n=5) \\
&=\left(\frac{1}{2}\right)^n\left\{1-2\left(\frac{1}{3}\right)^n\right\}
 +\left(\frac{1}{3}\right)^n\left\{1-\left(\frac{1}{2}\right)^n\right\}
 +\left(\frac{1}{6}\right)^n
\end{aligned}
$$

したがって，
$$
\begin{aligned}
P(G_n\ \text{が素数でない})
&=1-P(G_n\ \text{が素数}) \\
&=1-\left(\frac{1}{2}\right)^n\left\{1-2\left(\frac{1}{3}\right)^n\right\}
   -\left(\frac{1}{3}\right)^n\left\{1-\left(\frac{1}{2}\right)^n\right\}
   -\left(\frac{1}{6}\right)^n
\end{aligned}
$$
となる．