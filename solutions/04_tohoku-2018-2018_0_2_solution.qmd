## 解答

番号札は $1,2,\dots,n$ の $n$ 種類があり，各回独立に一様分布する（確率 $1/n$）。

$a$ 回目で初めて和が $n$ 以上になるとは，
  
- $(a-1)$ 回目までの和が $n$ 未満であり，
- $a$ 回目までの和が $n$ 以上

となることである。

各小問ごとに考える。

---

(1) $p(1)$ と $p(n)$ を求める。

### $p(1)$

1回目で和が初めて $n$ 以上になるとは，  
1回目の取り出しで和が $n$ 以上，すなわち「1回目に $n$ の札を引く」ことに等しい。

よって  
$$
p(1)=\Pr(\text{1回目の札} = n) = \frac{1}{n}.
$$

### $p(n)$

$n$ 回目で初めて和が $n$ 以上になるとは，

- 1回目から $(n-1)$ 回目までの和が $n-1$ 以下（すなわち $n$ 未満），
- $n$ 回目で和が $n$ 以上

であることを意味する。

まず，1回から $n$ 回までに出る最大の和は，各回で $n$ を引いたときの $n\cdot n = n^2$，  
最小の和は全て $1$ を引いたときの $n$ である。  
よって，$n$ 回までのどの段階でも和が $n$ 以上にならないためには，
和が $n-1$ 以下でなければならないが，$n$ 回の最小の和が $n$ であるから不可能である。

したがって，

- $n$ 回終了までに一度も和が $n$ 未満から $n$ 以上へ「初めて」到達しないような試行列は存在せず，
- 従って「ちょうど $n$ 回目に初めて $n$ 以上に到達する」ことも起こり得ない。

よって  
$$
p(n)=0.
$$

---

(2) $p(2)$ を求めよ。

2回目で初めて和が $n$ 以上になるとは，

- 1回目の和が $n$ 未満（自明に成り立つ，ただし $n$ を引いたときは $n$ 以上になるので注意），
- 2回目までの和が $n$ 以上

であることを意味する。

具体的には，

- 1回目に引いた数を $x$，2回目を $y$ とすると  
  条件は  
  $$
  x < n,\quad x+y \geq n
  $$
  である。
- ただし $x$ は $1,2,\dots,n-1$ のいずれか，$y$ は $1,2,\dots,n$ のいずれかである。

確率は独立性より，
$$
p(2)=\sum_{x=1}^{n-1}\Pr(X_1=x,\ X_1+X_2\geq n).
$$
ここで $X_1,X_2$ は1,2回目の出た数を表す。

$X_1=x$ となる確率は $\displaystyle \frac{1}{n}$ であり，そのとき  
$X_2\geq n-x$ となる確率は，
$$
\Pr(X_2\ge n-x)=\frac{\text{整数 }n-x,n-x+1,\dots,n \text{ の個数}}{n}=\frac{x+1}{n}.
$$

よって
$$
p(2)=\sum_{x=1}^{n-1}\frac{1}{n}\cdot\frac{x+1}{n}
=\frac{1}{n^2}\sum_{x=1}^{n-1}(x+1).
$$

ここで
$$
\sum_{x=1}^{n-1}(x+1)=\sum_{x=1}^{n-1}x+\sum_{x=1}^{n-1}1
=\frac{(n-1)n}{2}+(n-1)
=(n-1)\Bigl(\frac{n}{2}+1\Bigr)
=\frac{(n-1)(n+2)}{2}.
$$

したがって
$$
p(2)
=\frac{1}{n^2}\cdot\frac{(n-1)(n+2)}{2}
=\frac{(n-1)(n+2)}{2n^2}.
$$

---

(3) $p(n-1)$ を求めよ。

$(n-1)$ 回目で初めて和が $n$ 以上になるとは，

- $(n-1)$ 回目までの和が $n$ 以上，
- どの $k$ 回目（$1\le k\le n-2$）でもその時点までの和が $n$ 未満

である。

ここで，各回の最小値は $1$ なので，

- $n-2$ 回までの最小の和は $n-2$，
- $n-1$ 回までの最小の和は $n-1$，

である。したがって，

- $(n-1)$ 回目までの和が $n$ 以上になるためには，少なくともどこかの段階で和が $n$ 以上になっていなければならない。
- 特に，$n-1$ 回目で初めて $n$ 以上に到達したと仮定すると，  
  $1,2,\dots,n-2$ 回目までの和はすべて $n-1$ 以下でなければならないが，  
  $n-1$ 回目で和が初めて $n$ 以上になるためには，$n-1$ 回目の直前（すなわち $n-2$ 回目まで）の和は $n-1$ 以下であり，  
  なおかつ $n-1$ 回目に足す数は最大でも $n$ なので，$n-1$ 回目までの和の最大値を考える。

実際には，和が $n$ 以上になる「初めての瞬間」は，  
1回目から遅くとも $(n-1)$ 回目までのいずれかに必ず現れるかを検討したいところだが，  
$n-1$ 回までの最小の和が $n-1$ であり，まだ $n$ に達しないことに注意する。

より直接に考えるために，最大値・最小値から検討する。

- $n-1$ 回の試行で得られる和の最小値は，全て $1$ を引いたときの $n-1$ である。
- よって $n-1$ 回目終了時点で和が $n$ 以上となるには，  
  少なくともどこかで $1$ より大きい数を引かなければならない。
- しかし，$n-2$ 回目までの和の最小値は $n-2$ であり，まだ $n$ に達しないので，  
  「初めて $n$ 以上になる瞬間」が $n-1$ 回目より前に来るには，  
  $n-2$ 回までで和が $n$ 以上になる必要があるが，それは不可能である。

ここで決定的なのは：

- $n-2$ 回までの最大の和は，もし毎回 $n$ を引いたとしても $(n-2)\cdot n$ であり，これはもちろん $n$ より大きいが，  
  「初めて $n$ 以上になる回」がどこかに存在することを考えるとき，  
  $n-1$ 回目で初めて和が $n$ 以上になる可能性があるかどうかを個別に吟味する必要がある。

しかし，実際にはより簡単な考察が成り立つ。

各回の値は $1$ 以上 $n$ 以下なので，

- もし $(n-1)$ 回目で初めて和が $n$ 以上になるとすると，  
  $(n-2)$ 回目までの和は必ず $n-1$ 以下である。
- $(n-2)$ 回までの和の最大値は，各回で $n$ を引いたときの $(n-2)n$ であるが，この値は $n$ より大きいので，  
  「常に $n-1$ 以下である」という条件を満たすような系列を具体的に考える必要がある。

ここで重要な事実を用いる：  
$n-1$ 回までの最小の和が $n-1$ であることから，  
$n-1$ 回目に到達する前（$n-2$ 回目まで）に和が $n$ 以上になることは「可能」であるが，  
「常に $n-1$ 以下で抑え続けるための取り出し方」が存在するかどうかを検討する。

しかし，$n-2$ 回までの最小の和は $n-2$，最大の和は $(n-2)n$ と非常に大きく，  
$1,2,\dots,n$ からの取り出し方によって様々な値をとり得る。  
ここで「初めて $n$ 以上になる回」が $n-1$ 回目になるための列を構成しようとしても，  
$n-1$ 回目で和が $n$ 以上となるには，$n-1$ 回までの和が $n$ 以上である必要があり，  
一方でそれより前の全ての段階では和が $n-1$ 以下でなければならない。

しかし，重要な点に気づく：

- 1回から $(n-1)$ 回までの各回の取り出しが，いずれも $1$ であったとすると，  
  和は $n-1$ にしかならず，$n$ 以上にはならない。
- そこから「どこか1回でも $1$ より大きい数を引く」と，  
  それまでの和に「$1$ 以外」が加わるため，ある段階で
  $$
  \text{和} \ge (n-1)+1 = n
  $$
  となる。

したがって，

- $(n-1)$ 回目までに一度でも $2$ 以上の数を引けば，  
  その回以前かその回で和が $n$ 以上になってしまう。
- $(n-1)$ 回目まで一度も $2$ 以上の数を引かないなら，全て $1$ なので和は $n-1$ のままであり，  
  やはり $n$ 以上にはならない。

よって，「ちょうど $(n-1)$ 回目に初めて和が $n$ 以上になる」ような場合は存在しない。

ゆえに
$$
p(n-1)=0.
$$