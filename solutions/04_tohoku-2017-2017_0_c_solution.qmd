## 解答

(1)  
袋には全部で $n$ 個の玉が入っているから，その中から 3 個を取り出す場合の総数は組合せを用いて  
$$
{}_n\mathrm{C}_3
$$
である。

取り出した 3 個のうち 2 個が赤玉，1 個が青玉となるためには，
- 赤玉 $k$ 個から 2 個を選ぶ方法が ${}_k\mathrm{C}_2$ 通り，
- 青玉 $(n-k)$ 個から 1 個を選ぶ方法が ${}_{n-k}\mathrm{C}_1$ 通り

あるので，条件を満たす場合の数は  
$$
{}_k\mathrm{C}_2\cdot {}_{n-k}\mathrm{C}_1
$$
である。

したがって，求める確率 $p(n,k)$ は
$$
p(n,k)=\dfrac{{}_k\mathrm{C}_2\cdot {}_{n-k}\mathrm{C}_1}{{}_n\mathrm{C}_3}
$$
となる。

(2)  
$n$ は 3 の倍数で $n\geq 6$ とし，この $n$ を固定して $3\leq k<n$ の範囲で $k$ を動かすときの $p(n,k)$ の最大値とそのときの $k$ を求める。

まず，(1) の式を具体的に計算する。  
組合せの公式
$$
{}_a\mathrm{C}_b=\dfrac{a!}{b!(a-b)!}
$$
より，
$$
{}_k\mathrm{C}_2=\dfrac{k(k-1)}{2},\quad {}_{n-k}\mathrm{C}_1=n-k,\quad {}_n\mathrm{C}_3=\dfrac{n(n-1)(n-2)}{6}
$$
であるから，
$$
p(n,k)
=\dfrac{\dfrac{k(k-1)}{2}\,(n-k)}{\dfrac{n(n-1)(n-2)}{6}}
=\dfrac{3\,k(k-1)(n-k)}{n(n-1)(n-2)}
$$
となる。

$n$ は固定されているので，分母 $n(n-1)(n-2)$ は一定である。したがって，$p(n,k)$ を最大にすることは，分子
$$
f(k)=k(k-1)(n-k)
$$
を最大にすることと同値である。

$f(k)$ を展開すると
$$
f(k)=k(k-1)(n-k)
= (k^2-k)(n-k)
= -k^3 + (n+1)k^2 - nk
$$
である。$k$ は整数だが，まず実数として考え，$f(k)$ を最大にする $k$ を求める。

$f(k)$ は $k$ の 3 次関数であるので，微分して極値を調べる。
$$
f'(k) = -3k^2 + 2(n+1)k - n
$$
これを 0 とおくと，
$$
-3k^2 + 2(n+1)k - n = 0
$$
であり，両辺に $-1$ をかけて
$$
3k^2 - 2(n+1)k + n = 0
$$
となる。解の公式を用いると，
$$
k = \dfrac{2(n+1)\pm\sqrt{4(n+1)^2 - 12n}}{6}
= \dfrac{2(n+1)\pm 2\sqrt{(n+1)^2 - 3n}}{6}
= \dfrac{(n+1)\pm\sqrt{n^2-n+1}}{3}
$$
である。

ここで $n\geq 6$ なので，$\sqrt{n^2-n+1}$ は $n$ より少し小さい正の数であり，
$$
\frac{(n+1)-\sqrt{n^2-n+1}}{3}
$$
は $1$ より小さくなることが確かめられる（実際には $k=0$ 付近の値）。一方，
$$
\frac{(n+1)+\sqrt{n^2-n+1}}{3}
$$
は $k$ の範囲 $3\leq k<n$ の中に入る値であり，$f(k)$ は 3 次関数であることと $f(0)=0$，$f(n)=0$ から，$0<k<n$ の範囲で 1 つの極大値を持つことがわかる。その極大点は上式のうち大きい方
$$
k_0=\dfrac{(n+1)+\sqrt{n^2-n+1}}{3}
$$
である。

さらに，$n$ は 3 の倍数と仮定しているので，$n=3m$ とおくと，
$$
n^2-n+1 = 9m^2-3m+1 = (3m-1)^2
$$
となる。よって
$$
\sqrt{n^2-n+1} = 3m-1 = n-1
$$
であり，
$$
k_0=\dfrac{(n+1)+(n-1)}{3}=\dfrac{2n}{3}
$$
となる。したがって，$k=\dfrac{2n}{3}$ において $f(k)$（したがって $p(n,k)$）は極大となる。

$n$ は 3 の倍数であり，$n\geq 6$ なので $\dfrac{2n}{3}$ も整数で，条件 $3\leq k<n$ を満たす。よって，$k=\dfrac{2n}{3}$ が $p(n,k)$ を最大にする整数 $k$ である。

このときの $p(n,k)$ の値を求める。$k=\dfrac{2n}{3}$ を (1) の式に代入する：
$$
p\!\left(n,\dfrac{2n}{3}\right)
= \dfrac{{}_{\frac{2n}{3}}\mathrm{C}_2\cdot {}_{\frac{n}{3}}\mathrm{C}_1}{{}_n\mathrm{C}_3}
$$
と計算してもよいが，上で求めた式
$$
p(n,k)=\dfrac{3\,k(k-1)(n-k)}{n(n-1)(n-2)}
$$
を用いると，
$$
p\!\left(n,\dfrac{2n}{3}\right)
= \dfrac{3\cdot \dfrac{2n}{3}\left(\dfrac{2n}{3}-1\right)\left(n-\dfrac{2n}{3}\right)}{n(n-1)(n-2)}
$$
となる。分子を順に計算すると，
$$
\dfrac{2n}{3}-1=\dfrac{2n-3}{3},\quad n-\dfrac{2n}{3}=\dfrac{n}{3}
$$
なので，
$$
\text{分子}=3\cdot \dfrac{2n}{3}\cdot \dfrac{2n-3}{3}\cdot \dfrac{n}{3}
= 2n\cdot \dfrac{2n-3}{3}\cdot \dfrac{n}{3}
= \dfrac{2n^2(2n-3)}{9}
$$
したがって
$$
p\!\left(n,\dfrac{2n}{3}\right)
= \dfrac{\dfrac{2n^2(2n-3)}{9}}{n(n-1)(n-2)}
= \dfrac{2n(2n-3)}{9(n-1)(n-2)}
$$
となる。

以上より，$n$ を 3 の倍数で $n\geq 6$ としたとき，$p(n,k)$ は
- $k=\dfrac{2n}{3}$ のときに最大となり，
- その最大値は
  $$
  \dfrac{2n(2n-3)}{9(n-1)(n-2)}
  $$
  である。

まとめると，
- (1)  
  $$p(n,k)=\dfrac{{}_k\mathrm{C}_2\,{}_{n-k}\mathrm{C}_1}{{}_n\mathrm{C}_3}
  =\dfrac{3\,k(k-1)(n-k)}{n(n-1)(n-2)}$$

- (2) $n$ が 3 の倍数で $n\geq 6$ のとき，  
  $k=\dfrac{2n}{3}$ で $p(n,k)$ は最大となり，  
  その最大値は
  $$
  \dfrac{2n(2n-3)}{9(n-1)(n-2)}
  $$
  である。