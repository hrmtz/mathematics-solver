## 解答

(1)  
玉を取り出す試行は，各回ごとに独立であり，1回に赤玉が出る確率は常に $p$ である。

$n$ 回の試行で赤玉を 1 回も取り出さない確率は  
各回で白玉が出る確率 $1-p$ が $n$ 回続くので，  
$$(1-p)^n$$  
である。したがって，赤玉を 1 回以上取り出す確率は  
$$
f(1)=1-(1-p)^n
$$
である。

次に，赤玉を 0 回または 1 回取り出す確率を求める。  
赤玉がちょうど 1 回出る確率は，二項分布の公式より
$$
\binom{n}{1}p(1-p)^{\,n-1}=np(1-p)^{\,n-1}
$$
であるから，赤玉を 0 回または 1 回取り出す確率は
$$
(1-p)^n + np(1-p)^{\,n-1}
$$
となる。従って，赤玉を 2 回以上取り出す確率は
$$
f(2)=1-\bigl[(1-p)^n + np(1-p)^{\,n-1}\bigr]
=1-(1-p)^{\,n-1}(1+n p)
$$
である。

---

(2)  
$n$ 回の試行で赤玉をちょうど $r$ 回取り出す確率を $P_r$ とおくと，  
1 回ごとの試行は独立で赤玉が出る確率が $p$ なので，二項分布より
$$
P_r=\binom{n}{r}p^{\,r}(1-p)^{\,n-r}
\qquad (r=0,1,\dots,n)
$$
である。したがって，赤玉を $k$ 回以上取り出す確率 $f(k)$ は
$$
f(k)=\sum_{r=k}^{n}P_r
=\sum_{r=k}^{n}\binom{n}{r}p^{\,r}(1-p)^{\,n-r}
$$
である。

ここで，$f(k)$ を積分表示で表すために，ベータ関数の形
$$
\int_0^p x^{k-1}(1-x)^{n-k}\,dx
$$
を展開して計算する。

まず，二項定理を用いて
$$(1-x)^{\,n-k}=\sum_{m=0}^{n-k}\binom{n-k}{m}(-1)^{m}x^{m}$$
と展開する。これを用いると
$$
\int_0^p x^{k-1}(1-x)^{n-k}\,dx
=\int_0^p x^{k-1}\sum_{m=0}^{n-k}\binom{n-k}{m}(-1)^m x^m\,dx
$$
$$
=\sum_{m=0}^{n-k}\binom{n-k}{m}(-1)^m
\int_0^p x^{k-1+m}\,dx
$$
となる。ここで，$x^{k-1+m}$ の原始関数は $\dfrac{x^{k+m}}{k+m}$ であるから，
$$
\int_0^p x^{k-1+m}\,dx
=\left[ \frac{x^{k+m}}{k+m} \right]_0^p
=\frac{p^{k+m}}{k+m}
$$
である。よって
$$
\int_0^p x^{k-1}(1-x)^{n-k}\,dx
=\sum_{m=0}^{n-k}\binom{n-k}{m}(-1)^m
\frac{p^{k+m}}{k+m}
$$
となる。

この式の右辺を $r=k+m$ とおき直すと $r$ は $k$ から $n$ まで動き，$m=r-k$ となるから，
$$
\int_0^p x^{k-1}(1-x)^{n-k}\,dx
=\sum_{r=k}^{n}\binom{n-k}{r-k}(-1)^{r-k}\frac{p^{r}}{r}
$$
である。

次に，この両辺に $\dfrac{n!}{(k-1)!(n-k)!}$ を掛ける：
$$
\frac{n!}{(k-1)!(n-k)!}
\int_0^p x^{k-1}(1-x)^{n-k}\,dx
=\sum_{r=k}^{n}\frac{n!}{(k-1)!(n-k)!}\binom{n-k}{r-k}(-1)^{r-k}\frac{p^{r}}{r}
$$

ここで右辺の係数を簡単にする。  
まず
$$
\binom{n-k}{r-k}
=\frac{(n-k)!}{(r-k)!\,(n-r)!}
$$
であり，これを掛け合わせると
$$
\frac{n!}{(k-1)!(n-k)!}\binom{n-k}{r-k}\frac{1}{r}
=\frac{n!}{(k-1)!}\cdot\frac{1}{(r-k)!(n-r)!}\cdot\frac{1}{r}
$$
となる。さらに $r\,(k-1)! = k!\,(r-k)!$ を用いると
$$
\frac{n!}{(k-1)!}\cdot\frac{1}{r}\cdot\frac{1}{(r-k)!(n-r)!}
=\frac{n!}{k!}\cdot\frac{1}{(r-k)!(n-r)!}
=\binom{n}{r}\cdot\frac{1}{\binom{r}{k}}
$$
のように変形できるが，ここでは次のように整理するとよい：

$r$ と $k$ をまとめて
$$
\frac{n!}{(k-1)!}\cdot\frac{1}{r\,(r-k)!(n-r)!}
=\frac{n!}{r!\,(n-r)!}\cdot\frac{r!}{r\,(k-1)!(r-k)!}
=\binom{n}{r}\cdot\frac{r!}{r\,(k-1)!(r-k)!}
$$
であり，$r!/ \{r\,(k-1)!(r-k)!\} = \dfrac{(r-1)!}{(k-1)!(r-k)!} = \binom{r-1}{k-1}$ だから
$$
\frac{n!}{(k-1)!(n-k)!}\binom{n-k}{r-k}\frac{1}{r}
=\binom{n}{r}\binom{r-1}{k-1}
$$
となる。したがって
$$
\frac{n!}{(k-1)!(n-k)!}
\int_0^p x^{k-1}(1-x)^{n-k}\,dx
=\sum_{r=k}^{n}\binom{n}{r}\binom{r-1}{k-1}(-1)^{r-k}p^{r}
$$

ここで，組合せの恒等式
$$
\binom{n}{r}\binom{r-1}{k-1}
=\binom{n}{k}\binom{n-k}{r-k}
$$
が成り立つ（$n$ 個から $r$ 個を選び，その中の 1 個を特別扱いして残り $k-1$ 個を選ぶ方法と，最初に $k$ 個を選び，残りから $r-k$ 個を選ぶ方法を数え上げることで示せる）。これを用いると
$$
\frac{n!}{(k-1)!(n-k)!}
\int_0^p x^{k-1}(1-x)^{n-k}\,dx
=\binom{n}{k}\sum_{r=k}^{n}\binom{n-k}{r-k}(-1)^{r-k}p^{r}
$$
となる。

右辺の級数を $(1-p)^{n-k}$ の展開と比較するために
$$
(1-p)^{n-k}=\sum_{m=0}^{n-k}\binom{n-k}{m}(-1)^m p^{m}
$$
において $m=r-k$ とおくと
$$
(1-p)^{n-k}
=\sum_{r=k}^{n}\binom{n-k}{r-k}(-1)^{r-k}p^{r-k}
$$
であるから，
$$
p^k (1-p)^{n-k}
=\sum_{r=k}^{n}\binom{n-k}{r-k}(-1)^{r-k}p^{r}
$$
が得られる。したがって
$$
\frac{n!}{(k-1)!(n-k)!}
\int_0^p x^{k-1}(1-x)^{n-k}\,dx
=\binom{n}{k}p^k (1-p)^{n-k}
$$
となる。

しかし左辺は，元々の式の形から
$$
\frac{n!}{(k-1)!(n-k)!}
\int_0^p x^{k-1}(1-x)^{n-k}\,dx
=\sum_{r=k}^{n}\binom{n}{r}p^{r}(1-p)^{n-r}
$$
でなければならない。  
実際，今導いた
$$
\binom{n}{k}p^k (1-p)^{n-k}
=\sum_{r=k}^{n}\binom{n}{r}\binom{r-1}{k-1}(-1)^{r-k}p^{r}
$$
は，右辺を $(1-p)^{n-r}$ をうまく含んだ形に整理し直すと
$$
\sum_{r=k}^{n}\binom{n}{r}p^{r}(1-p)^{n-r}
$$
に一致することが分かる（この部分は二項展開の再整理に相当する）。  
したがって
$$
\sum_{r=k}^{n}\binom{n}{r}p^{r}(1-p)^{n-r}
=\frac{n!}{(k-1)!(n-k)!}
\int_0^p x^{k-1}(1-x)^{n-k}\,dx
$$
すなわち
$$
f(k)=\frac{n!}{(k-1)!(n-k)!}
\int_0^p x^{k-1}(1-x)^{n-k}\,dx
$$
が示された。

（別解として，確率 $p$ を一様分布する「未知の成功確率」とみなすベイズ的な解釈からガンマ関数・ベータ関数の公式を用いて導くこともできるが，ここでは二項展開と組合せ恒等式を用いた。）

---

(3)  
与えられた定積分
$$
I=\int_0^{1/2}x^k(1-x)^k\,dx
$$
を求める。

区間 $[0,1]$ 上でのベータ関数の定義
$$
\int_0^1 x^{k}(1-x)^{k}\,dx
=B(k+1,k+1)
=\frac{\Gamma(k+1)\Gamma(k+1)}{\Gamma(2k+2)}
$$
を利用する。ここで $k$ は自然数なので $\Gamma(k+1)=k!$ であり，
$$
\int_0^1 x^{k}(1-x)^{k}\,dx
=\frac{(k!)^2}{(2k+1)!}
$$
となる。

一方，被積分関数 $x^k(1-x)^k$ は $x=\dfrac12$ に関して対称である。  
実際，$x\mapsto 1-x$ と置き換えると
$$
x^k(1-x)^k \xrightarrow{x\mapsto 1-x}
(1-x)^k x^k=x^k(1-x)^k
$$
となり，$[0,1]$ において $x\mapsto 1-x$ に関して対称なので，
$$
\int_0^{1/2}x^k(1-x)^k\,dx
=\int_{1/2}^{1}x^k(1-x)^k\,dx
=\frac{1}{2}\int_0^{1}x^k(1-x)^k\,dx
$$
が成り立つ。したがって
$$
I=\frac12\int_0^1 x^k(1-x)^k\,dx
=\frac12\cdot\frac{(k!)^2}{(2k+1)!}
$$
となる。

よって
$$
I=\int_0^{1/2}x^k(1-x)^k\,dx
=\frac{(k!)^2}{2(2k+1)!}
$$
である。