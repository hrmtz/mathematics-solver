## 解答

3次関数
$$
y = x^3 - kx^2 + kx + 1
$$
について考える。

### (1) 極値をもつための条件

まず微分して，極値の存在条件を調べる。

$$
y' = 3x^2 - 2kx + k
$$

この2次方程式 $3x^2 - 2kx + k = 0$ が異なる2つの実数解をもつとき，元の3次関数は極大値と極小値をもつ。  
判別式を $D$ とすると

$$
D = (-2k)^2 - 4\cdot 3 \cdot k = 4k^2 - 12k = 4(k^2 - 3k)
$$

であるから，$D > 0$ より

$$
k^2 - 3k > 0
$$

これを解くと

$$
k(k-3) > 0 \quad \Rightarrow \quad k < 0 \text{ または } k > 3
$$

したがって，極大値と極小値をもつためには $k<0$ または $k>3$ である。

### (2) 極大値・極小値の差を求める

$y' = 0$ の解を $x$ 座標とする点で極値をとる。  
まず $y'$ を用いて極値の $x$ 座標を求める。

$$
3x^2 - 2kx + k = 0
$$

を解の公式により解くと，

$$
x = \frac{2k \pm \sqrt{4k^2 - 12k}}{2\cdot 3}
   = \frac{2k \pm 2\sqrt{k^2 - 3k}}{6}
   = \frac{k \pm \sqrt{k^2 - 3k}}{3}
$$

よって，

$$
x_1 = \frac{k - \sqrt{k^2 - 3k}}{3}, \quad
x_2 = \frac{k + \sqrt{k^2 - 3k}}{3}
$$

とおく。

上に凸から下に凸への変化を考えると，$x_1 < x_2$ であり，$x_1$ で極大値，$x_2$ で極小値をとる。  
よって，求める差は

$$
\text{極大値} - \text{極小値} = y(x_1) - y(x_2)
$$

である。

ここで，3次関数の微分方程式 $y' = 3x^2 - 2kx + k$ を用いて，  
極値の差 $y(x_1) - y(x_2)$ を計算する別の方法をとる。

$y$ は $x$ の関数なので，平均値の定理や積分を用いて

$$
y(x_1) - y(x_2) = \int_{x_2}^{x_1} y'(x)\,dx
$$

が成り立つ。したがって

$$
y(x_1) - y(x_2) = \int_{x_2}^{x_1} (3x^2 - 2kx + k)\,dx
$$

である。  
これは，原始関数 $Y(x)$ を

$$
Y(x) = x^3 - kx^2 + kx
$$

とおけば $Y'(x) = 3x^2 - 2kx + k = y'(x)$ であるから，

$$
\int_{x_2}^{x_1} (3x^2 - 2kx + k)\,dx = Y(x_1) - Y(x_2)
$$

となる。もともとの $y(x) = x^3 - kx^2 + kx + 1$ なので，

$$
y(x_1) - y(x_2) = \left( x_3 - kx^2 + kx + 1 \right)_{x=x_1}
               - \left( x^3 - kx^2 + kx + 1 \right)_{x=x_2}
$$

より，定数項が打ち消し合って

$$
y(x_1) - y(x_2) = Y(x_1) - Y(x_2)
$$

が成り立つことと一致している。

したがって

$$
y(x_1) - y(x_2) = Y(x_1) - Y(x_2)
= \int_{x_2}^{x_1} (3x^2 - 2kx + k)\,dx
$$

を直接計算する。

まず $3x^2 - 2kx + k$ を因数分解する。  
$3x^2 - 2kx + k = 3(x - x_1)(x - x_2)$ となることを確かめる。

$3(x - x_1)(x - x_2)$ を展開すると，

$$
3(x^2 - (x_1 + x_2)x + x_1x_2)
= 3x^2 - 3(x_1 + x_2)x + 3x_1x_2
$$

一方で $3x^2 - 2kx + k$ と比較する。  
2次方程式の解と係数の関係より，

$$
x_1 + x_2 = \frac{2k}{3}, \quad x_1x_2 = \frac{k}{3}
$$

であるから，

$$
-3(x_1 + x_2) = -3\cdot \frac{2k}{3} = -2k,\quad
3x_1x_2 = 3\cdot \frac{k}{3} = k
$$

となり，確かに

$$
3x^2 - 2kx + k = 3(x - x_1)(x - x_2)
$$

である。

したがって，

$$
y(x_1) - y(x_2)
= \int_{x_2}^{x_1} 3(x - x_1)(x - x_2)\,dx
$$

ここで積分区間 $[x_2, x_1]$ では $x_2 < x_1$ であるから，  
積分計算をしやすくするために変数変換を工夫する。

区間の長さを

$$
L = x_1 - x_2
$$

とおく。  
次に，$x$ を $x = x_2 + Lt$ とおく（$t$ は $0$ から $1$ まで動く）。  
このとき

$$
dx = L\,dt
$$

となり，$x = x_2$ のとき $t = 0$，$x = x_1$ のとき $t = 1$ となる。

また

$$
x - x_1 = x_2 + Lt - x_1 = Lt - L = L(t - 1), 
$$

$$
x - x_2 = x_2 + Lt - x_2 = Lt
$$

であるから，

$$
(x - x_1)(x - x_2) = L(t-1)\cdot Lt = L^2 t(t-1)
$$

したがって，

$$
y(x_1) - y(x_2)
= \int_{x_2}^{x_1} 3(x - x_1)(x - x_2)\,dx
= \int_{0}^{1} 3\cdot L^2 t(t-1)\cdot L\,dt
= 3L^3 \int_{0}^{1} t(t-1)\,dt
$$

ここで積分を計算すると，

$$
\int_{0}^{1} t(t-1)\,dt
= \int_{0}^{1} (t^2 - t)\,dt
= \left[ \frac{t^3}{3} - \frac{t^2}{2} \right]_{0}^{1}
= \frac{1}{3} - \frac{1}{2} = -\frac{1}{6}
$$

よって，

$$
y(x_1) - y(x_2)
= 3L^3 \cdot \left(-\frac{1}{6}\right)
= -\frac{1}{2}L^3
$$

ここで，$L = x_1 - x_2 < 0$ であるから $L^3 < 0$ であり，  
$-\dfrac{1}{2}L^3$ は正となり，極大値から極小値を引いた値として符号が整合する。

$L = x_1 - x_2$ を具体的に計算する。

$$
L = x_1 - x_2
= \frac{k - \sqrt{k^2 - 3k}}{3} - \frac{k + \sqrt{k^2 - 3k}}{3}
= \frac{-2\sqrt{k^2 - 3k}}{3}
$$

したがって，

$$
L^3 = \left( \frac{-2\sqrt{k^2 - 3k}}{3} \right)^3
= \frac{-8(k^2 - 3k)^{3/2}}{27}
$$

これを上式に代入すると，

$$
y(x_1) - y(x_2)
= -\frac{1}{2}L^3
= -\frac{1}{2}\cdot \frac{-8(k^2 - 3k)^{3/2}}{27}
= \frac{4}{27}(k^2 - 3k)^{3/2}
$$

よって，極大値から極小値を引いた値は

$$
\frac{4}{27}(k^2 - 3k)^{3/2}
$$

である。

### (3) 与えられた条件から $k$ を求める

問題の条件より，「極大値から極小値を引いた値が $4|k|^3$ になる」から，

$$
\frac{4}{27}(k^2 - 3k)^{3/2} = 4|k|^3
$$

両辺を $4$ で割ると，

$$
\frac{1}{27}(k^2 - 3k)^{3/2} = |k|^3
$$

両辺とも非負であるから，両辺を3乗根をとることを考える。  
まず両辺を2乗してもよいが，ここでは3乗根の形で整理する。  
$(k^2 - 3k)^{3/2}$ を $\left( (k^2 - 3k)^{1/2} \right)^3$ とみなすと，

$$
\frac{1}{27}\left( (k^2 - 3k)^{1/2} \right)^3 = |k|^3
$$

両辺を3乗根（すなわち $1/3$ 乗）すると，

$$
\frac{1}{3}(k^2 - 3k)^{1/2} = |k|
$$

ここで，$k^2 - 3k$ は極値をもつ条件から $>0$ であるので，  
左辺は実数として定義される。

両辺を2乗して，

$$
\frac{1}{9}(k^2 - 3k) = k^2
$$

これを整理すると，

$$
k^2 - 3k = 9k^2
$$

$$
-8k^2 - 3k = 0
$$

$$
k(8k + 3) = 0
$$

よって候補は，

$$
k = 0,\quad k = -\frac{3}{8}
$$

である。

しかし，極値をもつためには $k^2 - 3k > 0$，すなわち $k<0$ または $k>3$ であった。  
$k=0$ はこの条件を満たさないので不適である。  
一方，$k=-\dfrac{3}{8}$ は $k<0$ を満たすので極値をもつ。

また，途中で両辺の2乗などを行っているので，最終的に条件を満たすか確認する。

$k = -\dfrac{3}{8}$ のとき

$$
k^2 - 3k = \left( \frac{9}{64} \right) - 3\left( -\frac{3}{8} \right)
= \frac{9}{64} + \frac{9}{8}
= \frac{9}{64} + \frac{72}{64}
= \frac{81}{64}
$$

したがって，

$$
(k^2 - 3k)^{3/2} = \left( \frac{81}{64} \right)^{3/2}
= \left( \left( \frac{9}{8} \right)^2 \right)^{3/2}
= \left( \frac{9}{8} \right)^3
= \frac{729}{512}
$$

これを

$$
\frac{4}{27}(k^2 - 3k)^{3/2}
$$

に代入すると，

$$
\frac{4}{27}\cdot \frac{729}{512}
= \frac{4\cdot 729}{27\cdot 512}
= \frac{4\cdot 27}{512}
= \frac{108}{512}
= \frac{27}{128}
$$

一方，

$$
4|k|^3 = 4\left| -\frac{3}{8} \right|^3
= 4\cdot \left( \frac{3}{8} \right)^3
= 4\cdot \frac{27}{512}
= \frac{108}{512}
= \frac{27}{128}
$$

となり，一致しているので条件を満たす。

したがって，求める $k$ の値は

$$
k = -\frac{3}{8}
$$

である。