## 解答

$n$回の投げで生じる表裏の列を，隣り合う2つのコインの組に注目して考える．  
$Y_n=\sum_{k=2}^n X_{k-1}X_k$ は，隣り合う2回がともに表（$11$）となる位置の個数に等しい．  
すなわち，長さ $n$ の $0,1$ 列の中に現れる部分列 $11$ の個数を数えている．

したがって，$Y_n$ が奇数となるのは，「部分列 $11$ が奇数回出現する列」が出る場合である．  
この条件を調べやすくするため，列の形をまとめて分類する．

### 1. $1$ の連続ブロックでの書き換え

列中の $1$ の連続部分（ブロック）に注目する．例えば
- $1110$ には長さ $3$ のブロックが1つ，
- $01101110$ には長さ $2$ のブロックと長さ $3$ のブロックが1つずつ

というように分解できる．

長さ $m\ (\ge 2)$ の $1$ のブロックには，$11$ という隣り合う表の組が  
$m-1$ 個現れる．したがって，$Y_n$ の値は

$$
Y_n = \sum_{\text{各ブロック}} (\text{そのブロックの長さ}-1)
$$

となる．この和を奇数か偶数かで判定したい．  
ここで，各ブロックの長さを $m$ とすると，$m$ が偶数なら $m-1$ は奇数，$m$ が奇数なら $m-1$ は偶数である．  
よって $Y_n$ の奇偶は，「偶数長のブロックがいくつあるか」で決まる．

すなわち，

- ブロック長が偶数のブロックの個数を $E$ とすると
- $Y_n$ は $E$ と同じ奇偶性をもつ

ので，$Y_n$ が奇数であることと，「偶数長ブロックの個数 $E$ が奇数であること」は同値である．

よって，求める確率 $p_n$ は

$$
p_n = P(E \text{ が奇数})
$$

と書き換えられる．

### 2. $10$ の連続ブロックによる別表現

次に，長さ2の部分列 $10$ に注目する．$10$ が現れた直後から次の $0$ の直前までを 1 本のまとまりとみなして，

- $10$ が続けて $k$ 回現れる部分は  
  $1 0 1 0 1 0 \cdots 1 0$ （$10$ が $k$ 回並ぶ）であり，
- この部分には $1$ のブロックがちょうど $k$ 個，すべて長さ1のブロックとして現れる．  
  よって，この部分は $Y_n$ に寄与しない（$11$ が含まれない）．

一方で，$11$ のように，$1$ が続くところは，そこに対応する $10$ の並び方とは無関係に $Y_n$ に寄与する．  
このことから，$E$（偶数長ブロックの個数）は，「$10$ の並び方とは独立に，$1$ の連続数の偶奇だけで決まる」と言える．

ところが，公平なコイン投げにおいては，長さ $n$ の全ての $0,1$ 列が等確率 $2^{-n}$ で出現するので，

- 「ある列」のビットを全て反転した列（$0\leftrightarrow1$）を対応させる写像は全体の集合を2分割する．
- この写像は $Y_n$ の「偶奇」を変えないかどうかを調べると，以下のようになる：

元の列を $a_1,a_2,\dots,a_n$ とし，反転列を $1-a_1,\dots,1-a_n$ とおくと，

$$
X_{k-1}X_k = 1 \iff a_{k-1}=1,\ a_k=1,
$$
$$
\tilde X_{k-1}\tilde X_k = 1 \iff a_{k-1}=0,\ a_k=0
$$

であるから，反転により「$11$ の個数」と「$00$ の個数」が入れ替わる．したがって

- $Y_n$ は「$11$ の個数」，  
- 反転後の列での同じ和 $\tilde Y_n$ は「$00$ の個数」

となる．

よって，「$11$ の個数が奇数である列」と「$00$ の個数が奇数である列」とは，同じ個数だけ存在する．  
更に，「$00$ の個数が奇数である列」は，ビット反転のもう一回の適用（元に戻す）で「$11$ の個数が奇数である列」に1対1に対応するから，

$$
P(Y_n \text{ が奇数}) = P(\tilde Y_n \text{ が奇数})
$$

が成り立つ．

ところで，$Y_n$ は「長さ $n$ の全列」のうち，  
$Y_n$ 偶数の列と $Y_n$ 奇数の列とを互いに入れ替える明らかな対称性が存在する：

- 先頭ビット $X_1$ を 0/1 で固定すると，残り $X_2,\dots,X_n$ の $2^{n-1}$ 通りの列は対等であり，
- 各列を「$X_2,\dots,X_n$ の全ビットを反転させる」操作で1対1に対応させると，  
  $Y_n$ の奇偶が反転する（$X_{k-1}X_k$ に含まれる 1 の位置が $11\leftrightarrow 00$ で入れ替わる）．

よって，$Y_n$ が偶数の列の個数と奇数の列の個数は等しい．  
全体の列の総数は $2^n$ 通りなので，

$$
P(Y_n \text{ が奇数}) = P(Y_n \text{ が偶数}) = \frac{1}{2}
$$

が成立する．

### 3. 結論

以上より，どのような $n\ (\ge 2)$ に対しても，$Y_n$ が奇数となる確率 $p_n$ は

$$
p_n = \frac{1}{2}
$$

である．