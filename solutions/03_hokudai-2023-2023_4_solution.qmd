## 解答

(1)  
$K_3$ を書き直すと  
$$
K_3 = |1-a_1| + |a_1-a_2| + |a_2-a_3| + |a_3-6|
$$
となる。  
ここで，$1$ から $a_1$，$a_1$ から $a_2$，$a_2$ から $a_3$，$a_3$ から $6$ への数直線上の移動を考えると，三角不等式より  
$$
K_3 \ge |1-6| = 5
$$
が常に成り立つ。

等号 $K_3 = 5$ が成り立つのは，  
$$
|1-a_1|+|a_1-a_2|+|a_2-a_3|+|a_3-6| = |1-6|
$$
となるときであり，これは 1, $a_1$, $a_2$, $a_3$, 6 がすべて同一直線上で「同じ向き」に並ぶ，すなわち  
$$
1 \le a_1 \le a_2 \le a_3 \le 6 \quad \text{または} \quad 1 \ge a_1 \ge a_2 \ge a_3 \ge 6
$$
が必要である。しかし $1 \ge a_1 \ge a_2 \ge a_3 \ge 6$ は不可能なので，  
$$
1 \le a_1 \le a_2 \le a_3 \le 6
$$
が必要十分条件となる。

$a_1,a_2,a_3$ はそれぞれ 1 から 6 まで等確率に出るので，全事象数は $6^3=216$ 通りである。  
$1 \le a_1 \le a_2 \le a_3 \le 6$ を満たす組 $(a_1,a_2,a_3)$ の個数を求める。

これは重複を許す 1～6 からの 3 個の非減少数列の個数であり，いわゆる重複組合せの個数に等しい。  
したがって個数は  
$$
{}_{6+3-1}C_3 = {}_8C_3 = 56
$$
である。

よって，求める確率は
$$
\frac{56}{216} = \frac{7}{27}
$$
である。

---

(2)  
一般の $n$ について
$$
K_n = |1-a_1| + |a_1-a_2| + \cdots + |a_{n-1}-a_n| + |a_n-6|
$$
とおく。三角不等式を $n+1$ 個の点 $1,a_1,a_2,\dots,a_n,6$ に適用すると，
$$
K_n \ge |1-6| = 5
$$
が任意の $n$ で成り立つ。したがって $q_n \ge 5$ である。

一方，(1) で見たように $n=3$ のときには $K_3=5$ となる場合が存在する。  
また，$n \ge 3$ では，例えば
$$
a_1 = 2,\ a_2 = 3,\ a_3 = 4,\ a_4 = 4,\dots,a_n = 4
$$
とすれば
$$
K_n = |1-2|+|2-3|+|3-4|+0+\cdots+0+|4-6|
     = 1+1+1+2=5
$$
となる。

よって，$n \ge 3$ に対して $K_n$ は 5 をとりうるので  
$$
q_n = 5
$$
である。

次に，$K_n = q_n = 5$ となるための必要十分条件を求める。  
三角不等式の等号成立条件より
$$
|1-a_1| + |a_1-a_2| + \cdots + |a_{n-1}-a_n| + |a_n-6|
 = |1-6|
$$
が成り立つためには，1 から 6 へ向かう途中で，  
$$
1 \le a_1 \le a_2 \le \cdots \le a_n \le 6
$$
が成り立ち，しかも 1 から 6 の方向と逆向きの動き（値の減少）が一切ないことが必要十分である。

従って，
$$
K_n = q_n = 5 \ \Longleftrightarrow\ 1 \le a_1 \le a_2 \le \cdots \le a_n \le 6
$$
である。

（補足：$n=2$ のときも同様に $K_2 \ge |1-6|=5$ であり，例えば $(a_1,a_2)=(2,4)$ で $K_2=5$ となるから $q_2=5$ で，上の条件も同様に成り立つ。）

---

(3)  
$n \ge 4$ とし，
$$
L_n = K_n + |a_4-4|
$$
とおく。$L_n$ の最小値を $r_n$，そのときの確率を $p_n$ とする。

まず下限を求める。  
(2) より $K_n \ge 5$ であり，また $|a_4-4| \ge 0$ だから
$$
L_n = K_n + |a_4-4| \ge 5
$$
である。従って $r_n \ge 5$ である。

一方，(2) で述べたように  
$$
1 \le a_1 \le a_2 \le \cdots \le a_n \le 6
$$
を満たすとき $K_n = 5$ となる。このとき $a_4$ も 1 以上 6 以下の整数である。  
特に $a_4 = 4$ となるようにとることが可能であり，そのとき
$$
|a_4-4| = 0
$$
となるから
$$
L_n = 5 + 0 = 5
$$
が実現できる。従って
$$
r_n = 5
$$
である。

次に $L_n = r_n = 5$ となる条件を調べる。  
$L_n = 5$ であるから
$$
K_n + |a_4-4| = 5
$$
である。一方 $K_n \ge 5$，$|a_4-4| \ge 0$ より，これは
$$
K_n = 5,\quad |a_4-4|=0
$$
すなわち
$$
K_n = 5,\quad a_4 = 4
$$
と同値である。

(2) より $K_n = 5$ となるのは  
$$
1 \le a_1 \le a_2 \le \cdots \le a_n \le 6
$$
が成り立つときである。したがって
$$
L_n = 5 \Longleftrightarrow
\begin{cases}
1 \le a_1 \le a_2 \le \cdots \le a_n \le 6,\\
a_4 = 4
\end{cases}
$$
である。

以下，この条件を満たす場合の数を数える。  
$a_1,\dots,a_n$ は独立に 1～6 の一様分布なので，全事象数は $6^n$ 通りである。

$L_n = 5$ となるのは $1 \le a_1 \le \cdots \le a_n \le 6$ かつ $a_4=4$ のときである。  
$a_4=4$ のもとで，単調非減少条件を満たすには  
$$
1 \le a_1 \le a_2 \le a_3 \le 4,\quad
4 \le a_5 \le a_6 \le \cdots \le a_n \le 6
$$
が必要十分である。

よって，まず $(a_1,a_2,a_3)$ については，1～4 からの重複あり順序付き非減少列の個数だから
$$
{}_{4+3-1}C_3 = {}_6C_3 = 20
$$
通りである。

次に $(a_5,\dots,a_n)$ については，4～6 の 3 種類から長さ $n-4$ の非減少列であるから，重複組合せの個数より
$$
{}_{3+(n-4)-1}C_{n-4} 
= {}_{n-2}C_{n-4}
= {}_{n-2}C_2
$$
通りである。

したがって，有利な事象数は
$$
20 \cdot {}_{n-2}C_2
$$
通りとなる。

よって，求める確率 $p_n$ は
$$
p_n = \frac{20 \cdot {}_{n-2}C_2}{6^n}
$$
である。