## 解答

(この問題の操作列は，いわゆる「バブルソート」を  
左から右へ1回なで，下から上へ1回なでする操作と同じ形になっているが，  
ここではその知識を前提せずに議論を進める。)

---

## 解答

### (1)

背理法で示す。  
$A_1$と$A_2$の両方が $3$ 以上であると仮定する。

1 から $n$ までの数字がちょうど 1 回ずつ現れるので，  
$1,2$ は $A_3,A_4,\dots,A_n$ の中に含まれる。

ここで「左側にある小さい数は，右側との比較操作でさらに左へ進むことはあっても，  
右へ押し出されることはない」ことを用いる。  
操作 $(T_i)$ は「左が右より大きければ交換する」という形なので，

- 左側の札が **より小さい** 場合には交換は起こらず，その位置より右へは動かない。

従って，全操作を通じて，
  
- $1$ は，初期状態で自分より左にあるどの札よりも右に行くことはない。  
- $2$ も，同様に自分より左にある札より右へ押し出されることはない。

特に，$A_1\ge 3, A_2\ge 3$ であるから，最初に $1$ と $2$ が存在する位置を  
それぞれ $i_1, i_2$ とおくと，$i_1\ge 3, i_2\ge 3$ である。  
したがって，いかなる操作を行っても，

- $1$ は，それより左にあった札より右へ移動することはないから，最終的にも  
  位置 $1$ には来られない。
- 同様に $2$ も，それより左にあった札より右へ押しやられることはないから，  
  位置 $2$ には来られない。

ところが問題文の条件より，最終的な並びは $1,2,\dots,n$ であり，  
特に左から 1 番目に $1$，2 番目に $2$ が並んでいる。  
これは上述の考察と矛盾する。

したがって，「$A_1$と$A_2$の両方が3以上である」という仮定は誤りであり，  
$A_1$と$A_2$のうち少なくとも一方は $2$ 以下である。

---

### (2)

$n\ge 4$ を整数とし，条件を満たす初期配置の個数を $c_n$ とする。  
$A_1$ と $A_2$ の値によって場合分けをする。

#### 1. $A_1 = 1$ の場合

最初から $A_1=1$ であるとする。  
操作 $(T_1),\dots,(T_{n-1})$，続けて $(T_{n-1}),\dots,(T_1)$ を行っても，

- 1 はどの札よりも小さいので，常に左側に置かれ，  
  他の札との交換で右へ移動することはない。

従って，全操作後も 1 は常に先頭にあり，  
残り $n-1$ 枚（右から 2 番目以降）の並びは，  
「1 を取り除いたときの長さ $n-1$ の問題」と全く同じ条件を満たす。

よって，$A_1=1$ の場合に許される配置数は $c_{n-1}$ である。

#### 2. $A_2 = 1$ の場合

次に $A_2=1$ であるとする。  
(1) より，このとき $A_1 \ge 2$ だが，  
最終的には左から $1,2,\dots,n$ と並ぶので，  
最初に $1$ が位置 2 にあるにもかかわらず，  
全ての操作後には位置 1 に来ていなければならない。

ここで，操作列全体の中で 1 が関わる交換は常に「1 が右側にあり，左側にそれより大きい数があるとき」だけであり，  
そのときに限り 1 とその数は入れ替わる。  
したがって，$A_2=1$ かつ，最終的に $1$ が位置 1 に来るためには，

- 操作 $(T_1)$ において，$A_1>1$ ならば必ず交換が行われ，  
  直ちに 1 は先頭に移動する。

よって，$A_2=1$ の場合，操作列のごく初期に 1 が先頭に来る。  
その後の動きは「1 が元々先頭にあった場合」と区別がなくなる。  

より形式的には，

1. 最初に $(T_1)$ を行うと，$A_1>1$ より $A_1$ と $1$ が交換され，  
   並びは $1, A_1, A_3,\dots,A_n$ となる。
2. これ以降の操作（$T_2,\dots,T_{n-1}, T_{n-1},\dots,T_1$）においても，  
   1 は常にそれより小さい値をもつので，右へ移動することはなく，  
   先頭に固定される。

従って，この場合も結局「先頭に 1 を固定した長さ $n-1$ の問題」と同じになり，  
許される配置数は $c_{n-1}$ である。

#### 3. $A_1=2,\ A_2\ge 3$ の場合

(1) の結果と今までの 2 つの場合を合わせると，  
残る可能性は

- $A_1=2$ かつ $A_2\ge 3$

の場合のみである。  
このとき 1 はどこか 3 番目以降に存在する。

1 と 2 の最終位置はそれぞれ 1 番目と 2 番目でなければならないから，  
操作列の途中経過において，まず 1 がある位置から左へと移動し，  
その過程で 2 とも入れ替わることが必要になる。

ここで「最初の操作列の前半 $(T_1),\dots,(T_{n-1})$ は，  
右端側から順に大きい数が右へ追いやられていく操作」であることを用いると，

- 前半の $(T_1),\dots,(T_{n-1})$ を終えた時点で，  
  最大の数 $n$ は必ず最右端 (位置 $n$) に来ている。

これは，任意の隣り合う 2 枚について左の方が大きければ右へ送る，  
という操作を左から右へ一巡することにより，
より大きい数が右へ少しずつ押しやられ，  
最も大きい $n$ が最後まで右へ進むためである。

問題文の条件では，この前半に続いて  
後半 $(T_{n-1}),\dots,(T_1)$ を行ったときに最終的に $1,2,\dots,n$ となる。  
したがって，

- 前半終了時点で $n$ は既に一番右にあり，  
- 後半で 1 と 2 を所定の位置まで左へ移動させて整列が完成する。

ここで注目すべきは，$A_1=2,\ A_2\ge 3$ のときには，

- 1 は右側にあるので，前半・後半を通じて常に「より大きい数とだけ交換し，左へ進む」  
  という動きをする。
- 一方，2 は 1 より左にあるため，1 が2の左側を通過することはあり得ない。  
  よって，1 が先頭に来る途中で必ず 2 と一度交換し，2 は 1 の右隣に移動する。

このとき，1 と 2 は互いの位置をすれ違うが，その様子は  
「1,2 をともに取り除いた残りの $n-2$ 枚の札の並び方に対して，  
長さ $n-2$ の同じ種の操作を行って整列する」  
場合と一対一に対応するとみなすことができる。

より具体的には，

1. 初期状態から 1 と 2 を取り除き，残る $n-2$ 枚を  
   左から順に $B_1,B_2,\dots,B_{n-2}$ とおく（ただし，1,2 を除いた値を  
   「相対的な大小関係を保ったまま」見ていると思えばよい）。
2. 上で見たように，最大の数 $n$ は前半の操作で右端に移るから，  
   以降は「1 と 2 を固定し，残りを整列させる過程」は  
   長さ $n-2$ の同種の問題と同型になる。

従って，$A_1=2,\ A_2\ge 3$ の場合に許される配置数は $c_{n-2}$ である。

（ここで，$n\ge 4$ を仮定しているので $n-2\ge 2$ が成り立ち，  
$c_{n-2}$ は定義されていることに注意する。）

#### 4. 場合分けの統合

以上より，$n\ge 4$ のとき，  
条件を満たす初期配置は

- $A_1=1$ の場合：$c_{n-1}$ 通り  
- $A_2=1$ の場合：$c_{n-1}$ 通り  
- $A_1=2,\ A_2\ge 3$ の場合：$c_{n-2}$ 通り

があり，しかもこれらは互いに排反である。  
よって，

$$
c_n \;=\; c_{n-1} + c_{n-1} + c_{n-2}
\;=\; 2c_{n-1} + c_{n-2}
$$

が成り立つ。

したがって，$n\ge 4$ のとき，

$$
\boxed{\,c_n = 2c_{n-1} + c_{n-2}\,}
$$

と表される。