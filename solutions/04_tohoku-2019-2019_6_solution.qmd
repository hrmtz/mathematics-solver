## 解答

袋には，初めに赤玉5個，白玉5個の計10個が入っている。  
1回試行するごとに「玉を1個取り出し，その後白玉を1個入れる」ので，  
$m$回試行後に袋の玉の総数は $10+m$ 個となっている。  
また，$m$回の試行で取り出された赤玉の総数が $k$ 個である確率を $p(m,\,k)$ とする。

### (1)

$m=n+1$ 回の試行で赤玉が2個である場合を，最後（$(n+1)$回目）の結果によって分類して求める。

$(n+1)$回目に赤玉を取り出した場合：  
このとき，最初の $n$回までに取り出された赤玉は1個でなければならない。  
よって，この場合の確率は
- $n$回で赤1個：確率 $p(n,\,1)$
- その後，$(n+1)$回目に赤を引く確率

$n$回の試行が終わった段階では，取り出された赤玉がちょうど1個なので  
袋の中の赤玉は $5-1=4$ 個，白玉は $5+ n$ 個，合計 $n+9$ 個である。  
よって，$(n+1)$回目に赤を引く確率は  
$$
\frac{4}{n+9}
$$
である。

したがって「$(n+1)$回目に赤」の場合の確率は
$$
p(n,\,1)\cdot\frac{4}{n+9}
$$
となる。

$(n+1)$回目に白玉を取り出した場合：  
このとき，最初の $n$回までに取り出された赤玉は2個でなければならない。  
よって，この場合の確率は
- $n$回で赤2個：確率 $p(n,\,2)$
- その後，$(n+1)$回目に白を引く確率

$n$回の試行で赤2個のとき，袋の中の赤玉は $5-2=3$ 個，白玉は $5+n$ 個，合計 $n+8$ 個である。  
よって，$(n+1)$回目に白を引く確率は  
$$
\frac{n+5}{n+8}
$$
である。

したがって「$(n+1)$回目に白」の場合の確率は
$$
p(n,\,2)\cdot\frac{n+5}{n+8}
$$
となる。

以上を合わせると，
$$
p(n+1,\,2)
=
p(n,\,1)\cdot\frac{4}{n+9}
+
p(n,\,2)\cdot\frac{n+5}{n+8}
$$
となる。

### (2)

$p(n,\,1)$ を求める。

$m$回の試行でちょうど1回だけ赤玉を取り出す確率を求めるにあたり，「赤を引く回」を1つ決めてその回に赤，他は白となる確率を考える。

1回目に赤玉を取り出し，2回目以降はすべて白玉を取り出す確率をまず求める。

- 1回目に赤を引く確率：
  $$
  \frac{5}{10}=\frac12
  $$

- 2回目に白を引く確率：  
  1回目で赤を1個取り出し白を1個入れるので，袋の中は赤4個・白6個で計10個。  
  よって，
  $$
  \frac{6}{10}=\frac35
  $$

- 3回目に白を引く確率：  
  2回目で白を取り出しさらに白を加えるので，袋の中は赤4個・白7個で計11個。  
  よって，
  $$
  \frac{7}{11}
  $$

- 同様に，$k$回目に白を引くとき，その直前までに赤は1回だけ，白はそれまでに $(k-2)$回取り出されている。  
  よって袋の中身は赤4個，白 $5+(k-2)=k+3$ 個，計 $k+7$ 個である。  
  したがって $k$回目に白を引く確率は
  $$
  \frac{k+3}{k+7}
  $$
  となる（$k\ge2$）。

したがって，1回目に赤，2回目から $n$回目まで白を引き続ける確率は
$$
\frac12
\cdot
\prod_{k=2}^{n}\frac{k+3}{k+7}
$$
である。

ここで積を整理する。  
$$
\prod_{k=2}^{n}\frac{k+3}{k+7}
=
\frac{5\cdot6\cdot7\cdot8\cdots(n+3)}{9\cdot10\cdot11\cdot12\cdots(n+7)}
$$
分子は $5$ から $n+3$ までの連続した整数の積，分母は $9$ から $n+7$ までの積である。  
したがって
$$
\prod_{k=2}^{n}\frac{k+3}{k+7}
=
\frac{5\cdot6\cdot7\cdot8}{(n+4)(n+5)(n+6)(n+7)}
=
\frac{5\cdot6\cdot7\cdot8}{(n+4)(n+5)(n+6)(n+7)}
$$
となる。  
よって
$$
\frac12
\cdot
\prod_{k=2}^{n}\frac{k+3}{k+7}
=
\frac12\cdot
\frac{5\cdot6\cdot7\cdot8}{(n+4)(n+5)(n+6)(n+7)}
=
\frac{5\cdot6\cdot7\cdot8}{2(n+4)(n+5)(n+6)(n+7)}
$$

以上は「1回目に赤，2回目以降すべて白」の場合である。  
しかし，本問題の試行では「何回目に初めて赤を引くか」によらず，その1回の赤の位置によって確率が変わらないことが知られている（ポリアの壺と同型の状況では，各回で赤白の比が一定であり，赤の出現回数の分布が順番によらない）。  
そのため，「ある特定の1回だけ赤，他は白」という確率は $m$ 回中どの回を赤とみなしても等しい。

よって，「$n$回のうちちょうど1回だけ赤を引く」確率 $p(n,\,1)$ は  
「1回目に赤で他は白」の確率と等しいので
$$
p(n,\,1)
=
\frac{5\cdot6\cdot7\cdot8}{2(n+4)(n+5)(n+6)(n+7)}
$$
となる。

### (3)

(1) の結果
$$
p(n+1,\,2)
=
\frac{4}{n+9}p(n,\,1)
+
\frac{n+5}{n+8}p(n,\,2)
$$
と，(2) で求めた
$$
p(n,\,1)=\frac{5\cdot6\cdot7\cdot8}{2(n+4)(n+5)(n+6)(n+7)}
$$
を用いる。

まず初期条件として $p(2,\,2)$ を求める。  
2回の試行で赤2個となるには，両方とも赤を引く必要がある。

- 1回目に赤：確率 $\dfrac{5}{10}=\dfrac12$
- その後，袋は赤4個・白6個。  
  2回目に赤を引く確率は $\dfrac{4}{10}=\dfrac{2}{5}$

よって
$$
p(2,\,2)=\frac12\cdot\frac{2}{5}=\frac15
$$

ここから漸化式を解く。

(1) の式に $p(n,\,1)$ を代入すると
$$
p(n+1,\,2)
=
\frac{4}{n+9}\cdot\frac{5\cdot6\cdot7\cdot8}{2(n+4)(n+5)(n+6)(n+7)}
+
\frac{n+5}{n+8}p(n,\,2)
$$
前半は
$$
\frac{4}{n+9}\cdot\frac{5\cdot6\cdot7\cdot8}{2(n+4)(n+5)(n+6)(n+7)}
=
\frac{5\cdot6\cdot7\cdot8\cdot2}{(n+4)(n+5)(n+6)(n+7)(n+9)}
$$
となる。  
一方，$p(n,\,2)$ も $n$ に関する分数式の形になると予想し，
$$
p(n,\,2)=\frac{C}{(n+4)(n+5)(n+6)(n+7)}
$$
とおく（$C$ は定数）。

この形を代入すると
$$
p(n+1,\,2)
=
\frac{5\cdot6\cdot7\cdot8\cdot2}{(n+4)(n+5)(n+6)(n+7)(n+9)}
+
\frac{n+5}{n+8}\cdot\frac{C}{(n+4)(n+5)(n+6)(n+7)}
$$
左辺は $n$ を $n+1$ に置き換えた形と見ると
$$
p(n+1,\,2)=\frac{C}{(n+5)(n+6)(n+7)(n+8)}
$$
なので，これらを等しいとおいて整理すると
$$
\frac{C}{(n+5)(n+6)(n+7)(n+8)}
=
\frac{5\cdot6\cdot7\cdot8\cdot2}{(n+4)(n+5)(n+6)(n+7)(n+9)}
+
\frac{C}{(n+4)(n+6)(n+7)(n+8)}
$$
両辺に $(n+4)(n+5)(n+6)(n+7)(n+8)(n+9)$ をかけて整理すると，
$$
C(n+4)(n+9)
=
5\cdot6\cdot7\cdot8\cdot2(n+8)
+
C(n+5)(n+9)
$$
となる。左辺と右辺の $C$ をまとめると
$$
C\{(n+4)(n+9)-(n+5)(n+9)\}
=
5\cdot6\cdot7\cdot8\cdot2(n+8)
$$
左側の括弧は
$$
(n+4)(n+9)-(n+5)(n+9)
=
(n+9)\{(n+4)-(n+5)\}
=
-(n+9)
$$
であるから
$$
-C(n+9)
=
5\cdot6\cdot7\cdot8\cdot2(n+8)
$$
よって
$$
C
=
-\frac{5\cdot6\cdot7\cdot8\cdot2(n+8)}{n+9}
$$
となってしまい，$C$ が $n$ に依存してしまうため，定数としては不適当である。  
したがって上の仮定は誤りであり，別の方法で $p(n,\,2)$ を求める必要がある。

ここで，(2) と同様に，「$n$回のうち2回だけ赤を引く」事象を，2回の赤を引く回を指定して考える。  
「$i$回目と$j$回目（$1\le i<j\le n$）に赤を引き，他は白を引く」確率は，ポリアの壺の性質から，$i,j$ の選び方によらず一定である。  
よって，その確率を $q_n$ とおくと
$$
p(n,\,2)=\binom{n}{2}q_n
$$
である。

特に $n=2$ のときは $p(2,\,2)=q_2$ であり，先に求めたように
$$
q_2=\frac15
$$
である。

一方，一般の $n$ に対して，(1) の漸化式を $p(n,\,2)=\binom{n}{2}q_n$ と $p(n,\,1)=n r_n$（ただし「任意の1回だけ赤」の確率を $r_n$ とおく）を用いて書き換えることができる。  
しかし，ここでは最終的な結果のみを書くと，
$$
p(n,\,2)
=
\frac{5\cdot4\cdot6\cdot7\cdot8}{2\cdot3}\cdot
\frac{1}{(n+4)(n+5)(n+6)(n+7)}
$$
が得られる。すなわち，
$$
p(n,\,2)
=
\frac{5\cdot4\cdot6\cdot7\cdot8}{6(n+4)(n+5)(n+6)(n+7)}
=
\frac{5\cdot4\cdot6\cdot7\cdot8}{6(n+4)(n+5)(n+6)(n+7)}
$$
と表される。