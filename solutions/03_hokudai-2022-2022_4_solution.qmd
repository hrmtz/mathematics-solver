## 解答

(以下，すべての玉は区別できない同種の文字として扱う。円順列では回転による同一配置は同じとみなす。)

## 解答

(1)  
8個の玉 A, D, H, I, K, K, O, O を円形に並べる。

まず，全ての円順列の総数を求める。  
異なる文字数は A(1個), D(1個), H(1個), I(1個), K(2個), O(2個) であるから，円順列の総数は

$$
\frac{(8-1)!}{2!\,2!}=\frac{7!}{2\cdot2}=\frac{5040}{4}=126
$$

となる。

次に，「時計回りに HOKKAIDO」と並ぶ円順列の数を考える。  
円順列では回転は同一とみなすので，「HOKKAIDO」と書かれた配置は 1 通りしかない。

よって，求める確率は

$$
\frac{1}{126}
$$

である。

---

(2)  
「隣り合う子音が存在する確率」を求める。  
ここで子音は D, H, K の 3文字（玉は D 1個, H 1個, K 2個の計 4個）である。

求めやすいように，「隣り合う子音が存在しない確率」を先に求め，その余事象をとる。

### 隣り合う子音が存在しない並べ方の数

母音は A, I, O, O の4個，子音は D, H, K, K の4個である。

1. まず母音 A, I, O, O を円形に並べる。  
   O が2個重複しているので，母音だけの円順列の総数は
   $$
   \frac{(4-1)!}{2!}=\frac{3!}{2}=3
   $$

2. 子音を，母音の間の「すき間」に入れる。  
   円周上で母音4個を並べると，母音と母音の間のすき間は4か所ある。  
   子音どうしが隣り合わないためには，各すき間に高々1個ずつ子音を入れる必要がある。  
   子音は4個あり，すき間も4か所なので，各すき間にちょうど1個ずつ子音を入れることになる。

   母音を一つの円順列に固定したとき，4か所のすき間に D, H, K, K を1つずつ入れる並べ方は  
   直線順列として
   $$
   \frac{4!}{2!}=12
   $$
   通りある（K が2個重複）。

したがって，「子音が互いに隣り合わない円順列」の総数は

$$
3 \times 12 = 36
$$

である。

### 求める確率

全ての円順列の総数は(1)で求めたように $126$ 通りであるから，

- 隣り合う子音が存在しない確率は  
  $$
  \frac{36}{126}=\frac{2}{7}
  $$

したがって，「隣り合う子音が存在する確率」は

$$
1-\frac{2}{7}=\frac{5}{7}
$$

である。

---

(3)  
「隣り合う子音が存在するとき，それが KK だけである」条件つき確率を求める。

条件つき確率の定義より，

$$
\text{求める確率}
= \frac{\{\text{隣り合う子音が存在し，それが KK だけである並べ方の数}\}}
       {\{\text{隣り合う子音が存在する並べ方の数}\}}
$$

である。

分母は(2)で求めたので，まずそれを整理し，次に分子を求める。

### 分母：隣り合う子音が存在する並べ方の数

全ての円順列は $126$ 通り，子音が互いに隣り合わない並べ方は $36$ 通りなので，

$$
\{\text{隣り合う子音が存在する並べ方の数}\}
=126-36=90
$$

である。

### 分子：隣り合う子音が存在し，それが KK だけである並べ方の数

条件を満たす配置の特徴を整理する。

- 子音は D, H, K, K の4個である。
- 隣り合う子音は KK の1組だけ存在し，D と H は他の子音と隣接してはならない。
- したがって，D, H は母音としか隣り合わない。
- KK は2個が隣接して1つの「ブロック」となり，このブロックが他の子音（D, H）と隣り合ってはならない。

この配置を数えやすくするために，「KK」ブロックと残りの文字に分けて考える。

#### Step 1：先に KK ブロックを除いた並べ方を考える

KK をひとかたまりの1個のブロック $X$ とみなすと，残りの文字は

- $X$（KKブロック）1個
- 子音 D, H 各1個
- 母音 A, I, O, O の4個

合計 1+2+4=7 個の「もの」を円形に並べることになる。  
ただし，このままだと D, H が互いに隣り合ったり，$X$ と隣り合ったりしてしまう可能性がある。  
求めたいのは，「D, H は互いに隣接せず，かつ $X$ とも隣接しない」場合なので，以下の方針で数える。

1. まず，$X$ を除いた  
   D, H と母音 A, I, O, O（計6個）を円形に並べる。
2. その後，できたすき間に $X$ を挿入することで，「$X$ の隣が母音になる」ようにする。

このとき，D, H は母音と母音の間にのみ入り，D-H 間で隣接しないようにしておけば，あとから $X$ を母音どうしのあいだに入れる限り，D, H は $X$ と隣り合わず，他の子音とも隣接しない。

#### Step 2：D, H が互いに隣接せずに配置される並べ方

まず母音 A, I, O, O を円形に並べる。  
これは(2)と同様に $3$ 通りである。

このとき母音は円周上に4個あり，その間のすき間は4か所ある。  
子音 D, H は互いに隣接してはならないので，異なる2つのすき間を選んで1つずつ置く。

- 4つのすき間から2つを選ぶ方法は $ \binom{4}{2}=6 $ 通り。
- 選んだ2つのすき間のどちらに D，どちらに H を置くかが $2! = 2$ 通り。

したがって，母音列が1つ固定されたとき，D, H を隣り合わないように入れる方法は

$$
6 \times 2 = 12 \text{通り}
$$

母音列自体が3通りなので，D, H が互いに隣接せずに配置された円順列の数は

$$
3 \times 12 = 36
$$

通りである。

この状態では，6個（母音4＋D＋H）が円周上にいて，母音と母音の間のすき間に D, H が入っている形になっている。

#### Step 3：KK ブロック X を挿入

上でできた 6個の円順列のうち，母音は4個あるから，  
「母音どうしの間」のすき間は 4 か所存在する。

（D や H はすでに母音間に置かれているが，  
  「母音の直後〜次の母音の直前」が1つの母音区間になっており，  
  各母音区間内には子音が高々1個であることに注意。）

KK ブロック $X$ が子音と隣り合わないためには，  
$X$ の両隣が母音でなければならない。  
したがって，$X$ は「母音と母音にはさまれた部分」にのみ置ける。

上の議論から，そのような場所は 4 か所あるので，各円順列に対して $X$ の挿入位置は 4 通りである。

よって，条件を満たす円順列の総数は

$$
36 \times 4 = 144
$$

ではなく，ここで注意が必要である。  
今数えた「36」は，D, H と母音 A, I, O, O の6個の「円順列」の総数であり，  
各円順列について「母音と母音にはさまれた区間」は 4 か所あるので，  
「D, H, A, I, O, O の並びに $X$ を挿入して得られる7個の円順列」の総数は

$$
36 \times 4 = 144
$$

「直線順列」としての数であるが，もともと円順列を扱っており，  
$X$ の挿入で回転による重複が生じていないかを確認する必要がある。

しかし，次のように見ると，この 144 はそのまま「円順列の数」になっている。

- 6個（D, H, A, I, O, O）の円順列は，もともと回転による同一配置を 1 通りとして数えている。
- その各円順列に対し，「どの母音区間に $X$ を入れるか」で 4 通りの挿入位置があるが，  
  $X$ の位置は円周上の特定の場所を決めるので，  
  異なる母音区間に入れたものは回転させても一致しない。  
  よって，これら4通りは円順列としても互いに異なる。

したがって，上記 144 通りはそのまま「7個（A, D, H, I, O, O, X）の円順列」の数である。

ところが，ここで忘れてはならないのは，$X$ は KK ブロックであり，  
円周上に 7個配置されたあとで，さらに円順列として回転を同一視する必要があるかどうか，という点である。  

実は，上の数え方の出発点が「6個の円順列」を基準にしているため，  
最終的に得られた 144 通りはすでに回転を同一視した後の「7個の円順列」の数になっている。  
（円順列どうしの対応は一対一で保たれている。）  

よって，このまま 144 を採用してよいように見えるが，  
ここまでの議論は煩雑であり，数え方に混乱が生じている。  
実際のところ，この方法は不要に複雑であり，  
より直接的な方法で分子を数え直すのが安全である。

#### 別法（より直接的な数え方）

「隣り合う子音が存在し，それが KK だけである」  
とは，  
「子音どうしの隣り合いは KK の1組のみであり，D, H はいずれも他の子音と隣接しない」  
という意味である。

そこで，

1. まず KK を 1 つのブロック $X$ とみなす。
2. $X$, D, H は互いに隣接しない（子音どうしは隣り合わない）ように配置し，
3. ただし $X$ については，後で KK を展開しても問題ない（$X$ の内部は常に KK）。

このとき，「$X$, D, H が互いに隣接しないで配置される並べ方」を数えればよい。

すると，問題(2)で行った「子音が互いに隣り合わない並べ方」の考え方と全く同じ構造になる。

- 対象となる「子音」は $X, D, H$ の3個。
- 母音は A, I, O, O の4個。

母音4個を円形に並べる方法は，Oが2個重複なので 3 通り。  
母音4個の間のすき間は4か所。  
子音 $X, D, H$ 3個を，互いに隣接しないように配置するには，  
4つのすき間から3つを選び（$\binom{4}{3}=4$ 通り），  
選ばれた3つのすき間に $X, D, H$ をそれぞれ 1 通りずつ割り当てる（$3! = 6$ 通り）。

したがって，$X, D, H$ が互いに隣り合わない円順列の総数は

$$
3 \times \binom{4}{3} \times 3!
= 3 \times 4 \times 6
= 72
$$

通りである。

このとき，子音どうしは互いに隣接していないので，  
本来の文字に戻したとき，子音間で隣り合うのは KK の内部（$X$ の中）のみであり，  
D, H は他の子音と隣接しない。

したがって，この 72 通りが，「隣り合う子音が存在し，それが KK だけである並べ方」の総数である。

よって，分子は $72$ である。

### 条件つき確率

よって，求める条件つき確率は

$$
\frac{72}{90}=\frac{4}{5}
$$

となる。

---

以上より，

(1) $\displaystyle \frac{1}{126}$  
(2) $\displaystyle \frac{5}{7}$  
(3) $\displaystyle \frac{4}{5}$

である。