## 解答

(1)  
$a_1=a$ とおくと  
$$
a_2=3\left[a_1+\frac12\right]-2a_1
=3\left[a+\frac12\right]-2a
$$
である。$0\le a<1$ より $0\le a_1<1$ なので，$0\le x<1$ とおいて $(x,y)=(a_1,a_2)$ と書くと，
$$
y=3\left[x+\frac12\right]-2x
$$
となる。

$x$ の範囲 $0\le x<1$ で $[x+\tfrac12]$ を調べる。  
$[x+\tfrac12]$ は $x+\tfrac12$ 以下の最大の整数なので，

- $0\le x<\frac12$ のとき，$0\le x+\frac12<1$ より $[x+\tfrac12]=0$，したがって  
  $$
  y=3\cdot 0-2x=-2x
  $$
- $\frac12\le x<1$ のとき，$1\le x+\frac12<\frac32$ より $[x+\tfrac12]=1$，したがって  
  $$
  y=3\cdot 1-2x=3-2x
  $$

また，$x$ の端点での値を調べると
- $x=0$ のとき $y=-2\cdot 0=0$，よって点 $(0,0)$ を通る。
- $x\to\frac12-0$ のとき $y\to -2\cdot\frac12=-1$，よって直線 $y=-2x$ の上で点 $\left(\frac12,-1\right)$ は含まれない。
- $x=\frac12$ のとき $y=3-2\cdot\frac12=2$，よって点 $\left(\frac12,2\right)$ を通る。
- $x\to 1-0$ のとき $y\to 3-2\cdot 1=1$，よって直線 $y=3-2x$ の上で点 $(1,1)$ は含まれない。

したがって軌跡は  
区間 $0\le x<\frac12$ 上の直線 $y=-2x$（左端 $(0,0)$ は含むが右端 $\left(\frac12,-1\right)$ は含まない）と，  
区間 $\frac12\le x<1$ 上の直線 $y=3-2x$（左端 $\left(\frac12,2\right)$ は含むが右端 $(1,1)$ は含まない）  
からなる折れ線である。

---

(2)  
$a_n-[a_n]$ は $a_n$ の小数部分であり，$0\le a_n-[a_n]<1$ が成り立つ。  
条件 $a_n-[a_n]\ge\frac12$ より，
$$
[a_n+\tfrac12]=[a_n]+1
$$
が成り立つ（理由：$a_n+[1/2]=[a_n]+\{a_n\}+\frac12$ で $\{a_n\}\ge\frac12$ なので整数部分が 1 だけ増える）。

このとき漸化式より
$$
a_{n+1}
=3\left[a_n+\frac12\right]-2a_n
=3([a_n]+1)-2a_n
=3[a_n]+3-2a_n
$$
であるから
$$
a_{n+1}-a_n
=3[a_n]+3-3a_n
=3\bigl([a_n]+1-a_n\bigr)
=3\left(1-(a_n-[a_n])\right)
$$
となる。ここで $a_n-[a_n]\le 1$ なので，$1-(a_n-[a_n])\ge 0$ である。また $a_n-[a_n]<1$ だから  
$1-(a_n-[a_n])>0$ が成り立つ。したがって
$$
a_{n+1}-a_n>0
$$
すなわち $a_n<a_{n+1}$ が示された。

---

(3)  
$a_n>a_{n+1}$ と仮定する。  
漸化式
$$
a_{n+1}=3\left[a_n+\frac12\right]-2a_n
$$
に着目し，$[a_n+\tfrac12]$ の値を場合分けする。

$a_n-[a_n]=\{a_n\}$ とおくと $0\le\{a_n\}<1$ であり，
- $\{a_n\}<\frac12$ のとき  
  $[a_n+\tfrac12]=[a_n]$，
- $\{a_n\}\ge\frac12$ のとき  
  $[a_n+\tfrac12]=[a_n]+1$

が成り立つ。

まず $\{a_n\}<\frac12$ の場合を考える。このとき
$$
a_{n+1}=3[a_n]-2a_n
$$
であり，
$$
a_n-a_{n+1}
=a_n-(3[a_n]-2a_n)
=3(a_n-[a_n])
=3\{a_n\}
$$
となる。$\{a_n\}\ge 0$ なので $a_{n+1}\le a_n$ であり，$\{a_n\}>0$ なら $a_{n+1}<a_n$ が成り立つ。  
したがって $a_n>a_{n+1}$ はこの場合に矛盾しない（むしろこの場合に起こりうる）。

次に $\{a_n\}\ge\frac12$ の場合を考える。このとき(2)で示したように
$$
a_{n+1}-a_n=3\left(1-(a_n-[a_n])\right)
=3(1-\{a_n\})>0
$$
となるので，$a_{n+1}>a_n$ となってしまう。これは $a_n>a_{n+1}$ と矛盾する。

よって $a_n>a_{n+1}$ が成り立つためには必ず
$$
a_n-[a_n]<\frac12
$$
すなわち $\{a_n\}<\frac12$ でなければならない。このとき
$$
[a_n+\tfrac12]=[a_n]
$$
だから
$$
a_{n+1}=3[a_n]-2a_n
$$
が従う。

さらに，このときの $[a_{n+1}]$ を求める。  
$a_n=[a_n]+\{a_n\}$ とおくと
$$
a_{n+1}
=3[a_n]-2([a_n]+\{a_n\})
=[a_n]-2\{a_n\}
$$
となる。ここで $0\le\{a_n\}<\frac12$ より
$$
[a_n]-1<[a_n]-2\{a_n\}\le [a_n]
$$
が成り立つ。左辺の不等式は $\{a_n\}<\frac12$ から
$$
[a_n]-2\{a_n\}>[a_n]-1
$$
となること，右辺の不等式は $\{a_n\}\ge 0$ から明らかである。

また $[a_n]-2\{a_n\}$ は整数でない（$\{a_n\}>0$ なら非整数，$\{a_n\}=0$ のときは $a_n$ が整数であり，このとき $a_n>a_{n+1}$ を満たすかどうかは次で考える）。  
$a_n>a_{n+1}$ が成り立つには
$$
a_n-a_{n+1}=3\{a_n\}>0
$$
だから $\{a_n\}>0$ であり，したがって $a_{n+1}$ は整数でない。  
したがって区間 $([a_n]-1,[a_n])$ の中にある実数 $a_{n+1}$ の整数部分は
$$
[a_{n+1}]=[a_n]-1
$$
となる。

以上より
$$
a_n>a_{n+1}\ \Rightarrow\ 
a_{n+1}=3[a_n]-2a_n,\quad [a_{n+1}]=[a_n]-1
$$
が示された。

---

(4)  
ある $k\ge 2$ について
$$
a_1>a_2>\cdots>a_k
$$
が成り立つとする。このとき各 $n=1,2,\dots,k-1$ について $a_n>a_{n+1}$ なので，(3)より
$$
a_{n+1}=3[a_n]-2a_n,\quad [a_{n+1}]=[a_n]-1
$$
が成り立つ。特に
$$
[a_{n+1}]=[a_n]-1
$$
を $n=1,2,\dots,k-1$ に対して繰り返し用いると
$$
[a_k]=[a_1]-(k-1)
$$
が従う。

ここで $a_1=a$ であり $0\le a<1$ なので $[a_1]=[a]=0$ であるから
$$
[a_k]=-(k-1)
$$
を得る。よって $a_k$ は
$$
a_k=-(k-1)+\{a_k\}
$$
と書ける。ただし $\{a_k\}=a_k-[a_k]$ は $a_k$ の小数部分である。

さらに，各 $n$ で $a_n>a_{n+1}$ なので (3) の議論から
$$
0<\{a_n\}<\frac12
$$
が成り立つ。特に $n=k$ のとき
$$
0<\{a_k\}<\frac12
$$
である。

次に $a_k$ を $a$ を用いて直接表す。  
(3) の式
$$
a_{n+1}=3[a_n]-2a_n
$$
を用いる。$[a_n]$ はすでに
$$
[a_n]=[a_1]-(n-1)=-(n-1)
$$
と分かっているので，
$$
a_{n+1}=3\bigl(-(n-1)\bigr)-2a_n
=-3n+3-2a_n
$$
が成り立つ。これは $a_n$ の一次不定漸化式である。

$n=1$ から $k-1$ まで順に用いて一般項を求める。  
まず $n=1$ のとき
$$
a_2=-3\cdot 1+3-2a_1=-3+3-2a=-2a
$$
よって $a_2=-2a$。

次に $n=2$ のとき
$$
a_3=-3\cdot 2+3-2a_2=-6+3-2(-2a)=-3+4a
$$

$n=3$ のとき
$$
a_4=-3\cdot 3+3-2a_3=-9+3-2(-3+4a)=-6+6-8a=-8a
$$

ここから $a_n$ の形を類推し，一般の形 $a_n=\alpha_n a+\beta_n$ とおくと，  
漸化式
$$
a_{n+1}=-3n+3-2a_n
$$
に代入して
$$
\alpha_{n+1}a+\beta_{n+1}=-3n+3-2(\alpha_n a+\beta_n)
=-2\alpha_n a+(-3n+3-2\beta_n)
$$
が成り立つから
$$
\alpha_{n+1}=-2\alpha_n,\quad
\beta_{n+1}=-3n+3-2\beta_n
$$
を得る。初期条件は $a_1=a$ より
$$
\alpha_1=1,\quad \beta_1=0
$$
である。

まず $\alpha_n$ を解くと，一次の等比漸化式  
$\alpha_{n+1}=-2\alpha_n,\ \alpha_1=1$ より
$$
\alpha_n=(-2)^{n-1}
$$
である。

次に $\beta_n$ を解く。  
$$
\beta_{n+1}+3n+3= -2\beta_n
$$
と書き直してもよいが，ここでは $a_n$ 全体として解く方が簡単なので，別の方法をとる。

元の漸化式
$$
a_{n+1}+3n+3=-2a_n
$$
に対し，$b_n=a_n+\gamma n+\delta$ とおいて $b_{n+1}=r b_n$ の形に変形できるかを調べる。  
$b_n=a_n+pn+q$ とおくと
$$
b_{n+1}=a_{n+1}+p(n+1)+q
=-3n+3-2a_n+p(n+1)+q
$$
一方
$$
-2b_n=-2a_n-2pn-2q
$$
であるから，$b_{n+1}=-2b_n$ を満たすには
$$
-3n+3-2a_n+p(n+1)+q=-2a_n-2pn-2q
$$
が任意の $n$ で成り立たねばならない。$a_n$ の項はすでに一致しているので，$n$ と定数項について比較すると
$$
-3+p=-2p,\quad 3+p+q=-2q
$$
より
$$
3p=3\ \Rightarrow\ p=1,\quad
3+1+q=-2q\ \Rightarrow\ 3q=-4\ \Rightarrow\ q=-\frac43
$$
となる。

したがって $b_n=a_n+n-\frac43$ とおけば
$$
b_{n+1}=-2b_n
$$
が成り立つ。初期条件は
$$
b_1=a_1+1-\frac43=a+1-\frac43=a-\frac13
$$
であり，等比数列の一般項として
$$
b_n=(-2)^{n-1}\left(a-\frac13\right)
$$
を得る。よって
$$
a_n=b_n-n+\frac43
=(-2)^{\,n-1}\left(a-\frac13\right)-n+\frac43
$$
となる。特に $n=k$ として
$$
a_k=(-2)^{\,k-1}\left(a-\frac13\right)-k+\frac43
$$
が得られる。

これを少し整理して
$$
a_k=(-2)^{k-1}a-\frac13(-2)^{k-1}-k+\frac43
$$
としてもよい。

以上より，条件 $a_1>a_2>\cdots>a_k$ のもとで
$$
a_k=(-2)^{\,k-1}\left(a-\frac13\right)-k+\frac43
$$
と $a$ で表せた。