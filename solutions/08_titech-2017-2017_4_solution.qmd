## 解答

(1)  

まず，長さ $n$ の文字列全体の個数は，各文字に $a,b,c$ の3通りの選び方があるので  
$$
|A_n|=3^n
$$
である．

次に，条件(＊)「文字 $c$ が2つ以上連続して現れない」文字列の個数を求める．

長さ $n$ の条件(＊)を満たす文字列の個数を $f_n$ とおく．  
先頭の文字に着目して場合分けする．

- 先頭が $a$ または $b$ のとき：その後ろに続く長さ $n-1$ の部分も条件(＊)を満たさなければならないので，この場合の個数は $2f_{n-1}$ 個である．
- 先頭が $c$ のとき：2つ以上連続して $c$ が現れてはならないので，2文字目は $a$ または $b$ に限られ，その後ろの長さ $n-2$ の部分が条件(＊)を満たす．したがってこの場合の個数は $2f_{n-2}$ 個である．

よって
$$
f_n = 2f_{n-1} + 2f_{n-2}
$$
という漸化式を得る．  
初期条件を求める．

- $n=1$ のとき，$a,b,c$ の3通りすべて条件(＊)を満たすので $f_1=3$．
- $n=2$ のとき，全部で $3^2=9$ 個あり，条件(＊)を満たさないのは $cc$ だけなので $f_2=8$．

よって
$$
f_1=3,\quad f_2=8,\quad f_n=2f_{n-1}+2f_{n-2}\ (n\geq3)
$$
と定まる．

この漸化式を解く．特性方程式
$$
\lambda^2 - 2\lambda - 2 = 0
$$
を解くと
$$
\lambda = 1\pm\sqrt3
$$
であるから，一般解は
$$
f_n = A(1+\sqrt3)^n + B(1-\sqrt3)^n
$$
の形になる．初期条件から係数 $A,B$ を定める．

$n=1$ より
$$
f_1 = A(1+\sqrt3) + B(1-\sqrt3) = 3
$$
$n=2$ より
$$
f_2 = A(1+\sqrt3)^2 + B(1-\sqrt3)^2 = 8
$$
ここで
$$
(1+\sqrt3)^2 = 4+2\sqrt3,\quad (1-\sqrt3)^2 = 4-2\sqrt3
$$
を用いると
$$
\begin{cases}
(1+\sqrt3)A + (1-\sqrt3)B = 3\\[4pt]
(4+2\sqrt3)A + (4-2\sqrt3)B = 8
\end{cases}
$$
となる．

第1式を2倍して第2式から引く：
$$
\{(4+2\sqrt3)A + (4-2\sqrt3)B\} - 2\{(1+\sqrt3)A + (1-\sqrt3)B\} = 8-2\cdot3
$$
左辺を整理すると
$$
\{4+2\sqrt3-2-2\sqrt3\}A + \{4-2\sqrt3-2+2\sqrt3\}B = 2A + 2B
$$
よって
$$
2A+2B = 2 \quad\Rightarrow\quad A+B=1
$$
これを第1式に代入して $B=1-A$ とおくと
$$
(1+\sqrt3)A + (1-\sqrt3)(1-A) = 3
$$
左辺を展開して
$$
(1+\sqrt3)A + (1-\sqrt3) - (1-\sqrt3)A = 3
$$
$$
\{(1+\sqrt3)-(1-\sqrt3)\}A + (1-\sqrt3) = 3
$$
$$
2\sqrt3\,A + 1 - \sqrt3 = 3
$$
$$
2\sqrt3\,A = 2+\sqrt3
$$
より
$$
A = \frac{2+\sqrt3}{2\sqrt3},\quad
B = 1-A = 1-\frac{2+\sqrt3}{2\sqrt3} = \frac{\sqrt3-2}{2\sqrt3}
$$

したがって
$$
f_n = \frac{2+\sqrt3}{2\sqrt3}(1+\sqrt3)^n + \frac{\sqrt3-2}{2\sqrt3}(1-\sqrt3)^n
$$
となる．

求める確率 $P(n)$ は
$$
P(n) = \frac{f_n}{3^n}
$$
であるから，
$$
P(n) = \frac{1}{3^n}\left\{\frac{2+\sqrt3}{2\sqrt3}(1+\sqrt3)^n + \frac{\sqrt3-2}{2\sqrt3}(1-\sqrt3)^n\right\}
$$
すなわち
$$
P(n)
 = \frac{2+\sqrt3}{2\sqrt3}\left(\frac{1+\sqrt3}{3}\right)^n
 + \frac{\sqrt3-2}{2\sqrt3}\left(\frac{1-\sqrt3}{3}\right)^n
$$
となる．


(2)  

$n\geq12$ とし，$A_n$ から条件(＊)を満たす文字列を選び，かつその7番目の文字が $c$ であるという条件のもとで，10番目の文字が $c$ となる確率 $Q(n)$ を求める．最終的に $\displaystyle\lim_{n\to\infty}Q(n)$ を求める．

条件(＊)の下で2つ以上 $c$ が連続して現れないので，「7番目が $c$」という条件から  
6番目，8番目の文字は $c$ ではなく，$a$ または $b$ となる．

今，「7番目が $c$」という条件のもとで長さ $n$ の条件(＊)を満たす文字列全体を眺めると，
- 6番目，7番目，8番目はそれぞれ $(a\text{ または }b),\ c,\ (a\text{ または }b)$ に固定される．
- 1〜5番目の部分（長さ5）は，条件(＊)を満たす任意の文字列でよい．
- 9〜$n$ 番目の部分（長さ $n-8$）も，条件(＊)を満たす任意の文字列でよい．

ただし，6番目と7番目，7番目と8番目の境界ではすでに「$c$ が2つ続かない」ことが保証されている（6,8番目が $a$ または $b$ であるため），したがって前後の部分は互いに独立に，条件(＊)を満たす文字列として数え上げてよい．

よって，「7番目が $c$ で条件(＊)を満たす文字列」の総数は
$$
\underbrace{f_5}_{1\sim5\text{文字}}
\cdot
\underbrace{2}_{6\text{文字目 }a\text{ or }b}
\cdot
\underbrace{1}_{7\text{文字目 }c}
\cdot
\underbrace{2}_{8\text{文字目 }a\text{ or }b}
\cdot
\underbrace{f_{n-8}}_{9\sim n\text{文字}}
=
4\,f_5\,f_{n-8}
$$
である．

次に，これらのうち「10番目も $c$」となるものを数える．  
10番目が $c$ であり，かつ条件(＊)を満たすには，「9番目は $a$ または $b$」でなければならない．さらに，6〜8番目は上と同様に $(a\text{ or }b),c,(a\text{ or }b)$ である．

したがってこの場合のパターンは
- 1〜5番目：条件(＊)を満たす任意の長さ5の文字列 $\Rightarrow f_5$ 通り
- 6番目：$a$ または $b$ $\Rightarrow 2$ 通り
- 7番目：$c$ （固定） $\Rightarrow 1$ 通り
- 8番目：$a$ または $b$ $\Rightarrow 2$ 通り
- 9番目：$a$ または $b$ （10番目が $c$ なので，$c$ は不可）$\Rightarrow 2$ 通り
- 10番目：$c$ （固定）$\Rightarrow 1$ 通り
- 11〜$n$ 番目：条件(＊)を満たす長さ $n-10$ の文字列 $\Rightarrow f_{n-10}$ 通り

となる．6〜10番目の境界部は，すべて $c$ が2つ続かないことが構造から保証されているので，このように単純に積で数えてよい．

よって「7番目が $c$ かつ10番目も $c$ で条件(＊)を満たす文字列」の個数は
$$
f_5 \cdot 2\cdot1\cdot2\cdot2\cdot1\cdot f_{n-10}
= 8\,f_5\,f_{n-10}
$$
である．

したがって，条件付き確率の定義から
$$
Q(n) = 
\frac{\text{7番目が $c$ かつ10番目が $c$ で条件(＊)を満たす個数}}
{\text{7番目が $c$ で条件(＊)を満たす個数}}
=
\frac{8\,f_5\,f_{n-10}}{4\,f_5\,f_{n-8}}
=
2\cdot\frac{f_{n-10}}{f_{n-8}}
$$
となる．

ここで(1)で得た一般項
$$
f_m = A(1+\sqrt3)^m + B(1-\sqrt3)^m,
\quad
A=\frac{2+\sqrt3}{2\sqrt3},\ 
B=\frac{\sqrt3-2}{2\sqrt3}
$$
を用いると，
$$
\frac{f_{n-10}}{f_{n-8}}
=
\frac{A(1+\sqrt3)^{n-10} + B(1-\sqrt3)^{n-10}}%
{A(1+\sqrt3)^{n-8} + B(1-\sqrt3)^{n-8}}
$$
である．$(1-\sqrt3)$ の絶対値は $|1-\sqrt3| = \sqrt3-1 > 1$ だが，$(1+\sqrt3)$ と比べると
$$
\left|\frac{1-\sqrt3}{1+\sqrt3}\right| < 1
$$
であるから，$n\to\infty$ のとき
$$
\left(\frac{1-\sqrt3}{1+\sqrt3}\right)^{n-k}\to0
$$
となり，分子・分母ともに主項は $A(1+\sqrt3)^{n-\cdots}$ に支配される．

具体的に，
$$
\frac{f_{n-10}}{f_{n-8}}
=
\frac{(1+\sqrt3)^{n-10}\left\{A + B\left(\frac{1-\sqrt3}{1+\sqrt3}\right)^{n-10}\right\}}%
{(1+\sqrt3)^{n-8}\left\{A + B\left(\frac{1-\sqrt3}{1+\sqrt3}\right)^{n-8}\right\}}
=
\frac{1}{(1+\sqrt3)^2}
\cdot
\frac{A + B r_{n-10}}{A + B r_{n-8}}
$$
ただし
$$
r_k = \left(\frac{1-\sqrt3}{1+\sqrt3}\right)^k
$$
とおいた．$n\to\infty$ で $r_{n-10}, r_{n-8}\to0$ なので
$$
\lim_{n\to\infty}\frac{f_{n-10}}{f_{n-8}}
=
\frac{1}{(1+\sqrt3)^2}
$$
となる．したがって
$$
\lim_{n\to\infty}Q(n)
=
2\cdot\lim_{n\to\infty}\frac{f_{n-10}}{f_{n-8}}
=
\frac{2}{(1+\sqrt3)^2}
$$
となる．これを有理化しておくとよい．

$(1+\sqrt3)^2 = 4+2\sqrt3$ なので
$$
\frac{2}{(1+\sqrt3)^2}
=
\frac{2}{4+2\sqrt3}
=
\frac{1}{2+\sqrt3}
=
\frac{2-\sqrt3}{(2+\sqrt3)(2-\sqrt3)}
=
2-\sqrt3
$$

よって
$$
\lim_{n\to\infty}Q(n) = 2-\sqrt3
$$
である．