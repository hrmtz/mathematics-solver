## 解答

(1)  
黒玉3個，赤玉4個，白玉5個を一列に並べるときの全ての場合の数は，  
12個の玉のうち，黒3個，赤4個，白5個を並べる順列の数なので

$$
\text{全事象の数}
= \frac{12!}{3!\,4!\,5!}
$$

である。

次に「どの赤玉も隣り合わない」場合の数を求める。  
まず，赤玉以外の黒玉3個と白玉5個，合計8個を並べる。

黒3個，白5個の並べ方は

$$
\frac{8!}{3!\,5!}
$$

通りである。

この8個を一列に並べたとき，玉と玉の間および両端に，赤玉を挿入できる「すきま」は

$$
8+1 = 9 \text{か所}
$$

ある。どの赤玉も隣り合わないためには，これら9個のすきまの中から4か所を選び，それぞれに赤玉を1個ずつ入れればよい。

よって，其の場合の数は

$$
\binom{9}{4} \times \frac{8!}{3!\,5!}
$$

となる。

したがって，求める確率 $p$ は

$$
p = 
\frac{
\binom{9}{4}\dfrac{8!}{3!\,5!}
}{
\dfrac{12!}{3!\,4!\,5!}
}
= \binom{9}{4}\frac{8!}{3!\,5!}\cdot\frac{3!\,4!\,5!}{12!}
= \binom{9}{4}\cdot\frac{8!\,4!}{12!}.
$$

ここで

$$
\binom{9}{4} = \frac{9!}{4!\,5!},\quad 12! = 12\cdot11\cdot10\cdot9!
$$

を用いると，

$$
p
= \frac{9!}{4!\,5!}\cdot\frac{8!\,4!}{12!}
= \frac{9!\,8!}{5!\,12!}
= \frac{9\cdot8!}{5!\cdot12\cdot11\cdot10\cdot9!}
= \frac{9}{5!\cdot12\cdot11\cdot10\cdot9}.
$$

さらに $5! = 120$，$12\cdot11\cdot10\cdot9 = 11880$ より，

$$
p = \frac{9}{120\cdot11880} = \frac{9}{1\,425\,600} = \frac{1}{158\,400}.
$$

よって，

$$
p = \frac{1}{158\,400}
$$

である。

---

(2)  
(1)の条件「どの赤玉も隣り合わない」を満たしているときに，さらに「どの黒玉も隣り合わない」条件付き確率 $q$ を求める。

(1)と同様に，赤玉が隣り合わない並べ方の総数を改めて数えると，

$$
N_{\text{赤離}} = \binom{9}{4}\cdot \frac{8!}{3!\,5!}
$$

通りである（これが条件「赤玉が隣り合わない」下での「全事象」の数となる）。

次に，「赤玉も黒玉も互いに隣り合わない」並べ方の数を数える。

まず赤玉は互いに隣り合わないので，赤玉4個を一列に並べるときに作られるすきまは

$$
4+1 = 5 \text{か所}
$$

である。

黒玉が互いに隣り合わないためには，この5か所のすきまのうちから3か所を選び，各すきまに黒玉を1個ずつ入れる。すきまを選ぶ方法は

$$
\binom{5}{3}
$$

通りである。

ここまでで，赤4個と黒3個の相対的な配置は決まり，その順序は赤玉や黒玉が同種で区別できないことから一意である。

次に，残っているのは白玉5個であり，これは赤玉・黒玉間のすきまには入れず，単純に12個のうちの残った5個の位置に白玉が入る形になる。  
実際には，赤4個と黒3個の並び方が一意に決まり，空いている残り5個の位置に白玉が入ることになるので，白玉の並べ方は1通りである。

したがって，

「赤玉も黒玉も互いに隣り合わない」並べ方の総数は

$$
N_{\text{赤黒離}} = \binom{5}{3}
$$

通りである。

よって，求める条件付き確率 $q$ は

$$
q = \frac{N_{\text{赤黒離}}}{N_{\text{赤離}}}
= \frac{\binom{5}{3}}{\binom{9}{4}\cdot\dfrac{8!}{3!\,5!}}
= \binom{5}{3}\cdot \frac{3!\,5!}{\binom{9}{4}\,8!}.
$$

ここで

$$
\binom{5}{3} = \frac{5!}{3!\,2!},\quad \binom{9}{4} = \frac{9!}{4!\,5!}
$$

を用いると，

$$
q = \frac{5!}{3!\,2!}\cdot\frac{3!\,5!}{\dfrac{9!}{4!\,5!}\,8!}
= \frac{5!}{2!}\cdot\frac{5!\,4!\,5!}{9!\,8!}.
$$

直接計算してもよいが，ここでは途中で簡単に具体値を用いて計算する。  
$\binom{5}{3} = 10$，$\binom{9}{4} = 126$，$\dfrac{8!}{3!\,5!} = 56$ なので，

$$
N_{\text{赤離}} = 126 \times 56 = 7056,\quad
N_{\text{赤黒離}} = 10.
$$

従って

$$
q = \frac{10}{7056} = \frac{5}{3528}.
$$

よって，

$$
q = \frac{5}{3528}
$$

となる。