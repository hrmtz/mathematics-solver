## 解答

(1)  
1回の操作で，点Pは反時計回り(表)なら1つ進み，時計回り(裏)なら1つ戻るから，各操作で頂点番号は  
「$+1$ または $-1$ をする」ことに対応する（ただし $A,B,\dots,H$ を 0,1,…,7 番とみなし，8 で割った余りで考える）。

点Pは最初に点Aにあるので，はじめを 0 とし，10回の操作後の位置を  
$$
(+1)\text{ を表の回数} -1\text{ を裏の回数} 
$$
の和で表すと，これは  
「表が $k$ 回，裏が $(10-k)$ 回出たときの位置」  
$$
k - (10-k) = 2k - 10
$$
に等しい（この値を 8 で割った余りで頂点を決める）。

事象S「10回後に点Aにある」とは，この最終位置が 0 (≡A) になることなので，
$$
2k - 10 \equiv 0 \pmod{8}
$$
が必要である。整理すると
$$
2k - 10 \equiv 0 \pmod{8}
\;\Longleftrightarrow\;
2k \equiv 10 \equiv 2 \pmod{8}
\;\Longleftrightarrow\;
k \equiv 1 \pmod{4}
$$
となる。$0\le k\le 10$ の範囲で $k\equiv 1\pmod{4}$ を満たすのは  
$$
k = 1,5,9
$$
の3通りである。

よって，事象Sが起こる確率は
$$
P(S)
= \sum_{k=1,5,9} \binom{10}{k}\left(\frac12\right)^{10}
= \frac{ \binom{10}{1} + \binom{10}{5} + \binom{10}{9} }{2^{10}}
$$
である。ここで $\binom{10}{9}=\binom{10}{1}=10$，$\binom{10}{5}=252$ より
$$
P(S)=\frac{10+252+10}{2^{10}}
=\frac{272}{1024}
=\frac{17}{64}
$$
となる。

答：$\displaystyle P(S)=\frac{17}{64}$

---

(2)  
まず，事象T「1回目から10回目の操作によって，点Pは少なくとも1回，点Fに移動する」を解析する。  
点Fは，Aから反時計回りに5つ進んだ頂点なので，F を 5 番とみなす。

$n$ 回目の操作直後の位置を $X_n$ とし，表の回数を $k$ とすると，(1)と同様に  
$$
X_n \equiv 2k - n \pmod{8}
$$
で表される。したがって，$n$ 回目の直後に点F (≡5) にいる条件は
$$
2k - n \equiv 5 \pmod{8}
$$
である。これは
$$
2k \equiv n + 5 \pmod{8}
$$
と同値であるが，$2$ は $8$ と互いに素ではないので，右辺の偶奇により解の有無が決まる。

右辺 $n+5$ が奇数であるとき，$2k$ は常に偶数であるから合同式は解をもたない。  
$n+5$ が偶数，すなわち $n$ が奇数のときにのみ解が存在し，
$$
n \text{ が奇数のとき}
\quad\Longrightarrow\quad
2k \equiv n+5 \pmod{8}
$$
である。$n=2m+1$ とおくと $n+5=2m+6=2(m+3)$ より
$$
2k \equiv 2(m+3) \pmod{8}
\;\Longleftrightarrow\;
k \equiv m+3 \pmod{4}
$$
となる。したがって，$n=2m+1$ 回目直後にFにいるための表の回数 $k$ は
$$
k = m+3 + 4r \quad (r\text{ は整数})
$$
である。ただし $0\le k\le n=2m+1$ を満たさなければならない。

---

ここから，事象「S と T ともに起こる」つまり

- 10回後にAにいる（$S$），
- 1〜10回のどこかの時点でFにいた（$T$）

という経路を数えたい。

全経路は $2^{10}$ 通りであるから，
$$
P(S\cap T) = \frac{\text{(SかつTとなる経路数)}}{2^{10}}
$$
である。直接 $S\cap T$ を数える代わりに，
$$
S\cap T = S - (S\cap T^c)
$$
を用いて
$$
P(S\cap T) = P(S) - P(S\cap T^c)
$$
とする。ここで $T^c$ は「一度もFに行かない」事象である。

したがって
$$
P(S\cap T)
= P(S) - P(\text{10回後にAにいて，かつ一度もFに行かない})
$$
となるので，「一度もFに行かずにAに戻る経路」の本数を数えればよい。

---

A,B,C,D,E,F,G,H を 0,1,2,3,4,5,6,7 とし，F(=5) を禁制点とする。  
偶数回の後にAにいる可能性があるのは，(1) の議論で得た通り

- 2回後にAにいるには $k\equiv 1\pmod4$，$0\le k\le2$ より $k=1$（表1,裏1）
- 6回後にAにいるには $k\equiv 1\pmod4$，$0\le k\le6$ より $k=1,5$
- 10回後にAにいるには $k\equiv 1\pmod4$，$0\le k\le10$ より $k=1,5,9$

しかないことが使える。ここで「一度もFに行かない」制約のもとで，A→A と戻るには「遠くまで行き過ぎない」必要がある。

実際の経路を調べる：

- そもそもF(=5) に到達するには，(1)で用いた合同式より，「奇数回目」にしかあり得ない。
- A(0) からスタートして，±1ずつしか動かないので，5に達するまでに，途中で 4 や 6 を通る。
- Fに行かないためには，頂点番号が 5 に達しない，すなわち反時計回り方向に4まで，時計回り方向に3までに動きが制限される。

ここで，「10回後にAに戻る」には，反時計回り方向と時計回り方向のバランスがかなり崩れる（$k=1,5,9$ のいずれか）ことから，実際に経路が F を避けて閉じることができるかを検査する。

- $k=1$ のとき：表1回・裏9回  
  最終位置は $2k-10 = 2-10 = -8 \equiv 0$ でAに戻る。  
  動きとしては，ほとんど時計回り（裏）で回るので，一周近く動く。  
  実際，裏9回のうちに H,G,F,… と必ずFを通過するので，$T^c$ には含まれない。

- $k=9$ のとき：表9回・裏1回  
  これは $k=1$ の場合を反時計回りと時計回りを入れ替えただけで，本質的に同じ。  
  こちらも一周近く反時計回りに回るため，途中でFを必ず通る。

したがって，「Fを一度も通らない」可能性があるとすれば $k=5$ の場合だけである。

---

$k=5$（表5回，裏5回）の場合を詳しく見る。

A(0) から出発し，10歩でAに戻るためには，途中の位置は  
$$
X_n \equiv 2k_n - n \pmod{8}
$$
で決まる。ただし $k_n$ は $n$ 回目までの表の回数である。最終的に $k_{10}=5$ で $X_{10}=0$ となる。

F(=5) を避けるためには，すべての $n=1,\dots,10$ について
$$
X_n \not\equiv 5 \pmod{8}
$$
でなければならない。

ところが，$k_{10}=5$ で $X_{10}=0$ になるためには，途中の歩みの中で反時計回り方向（表）が5回ある。  
A(0) から表を重ねていくと 1,2,3,4,5 と順に辿る経路が最短であり，  
「表を5回打つまでに一度も5に達しない」ためには，表は必ず裏で相殺されて  
「常に4以下の範囲にとどまる」必要がある。

しかし，裏(時計回り)を混ぜると今度は負方向に3,2,1,0,7,6,… と進み，  
10歩のうちに反時計回り5回・時計回り5回を使ってAに戻るには，  
反時計回り方向と時計回り方向の「行き過ぎ」を途中で打ち消し合う動きが必要である。  
このとき，頂点の番号変化は  
$$
\text{最大でも }+5\text{，最小でも }-5
$$
の範囲を必ず一度は達成する（対称ランダムウォークの性質：原点に戻るには，最大値か最小値として±5のいずれかに達する）。  

$+5$ に達すればFに到達し，$-5\equiv 3$ に達すれば，そこから原点に戻るために反対側にも大きく動く必要があり，やはり途中で +5 側にも達してしまうことが分かる（1次元ランダムウォークで，原点から始めて時間10で原点に戻る経路は，「最大値が a，最小値が b」となり，$a-b\ge 10$ である；$a\le4$ なら $b\le -6$ が必要など，F を避けるのは不可能）。

以上より，$k=5$ の場合にも，「一度もFに行かずにAに戻る」経路は存在しない。

したがって，「10回後にAにいて，かつ一度もFに行かない」経路数は 0 本であり，
$$
P(S\cap T^c) = 0
$$
となる。

よって
$$
P(S\cap T) = P(S) - P(S\cap T^c) = P(S) = \frac{17}{64}
$$
である。

答：$\displaystyle P(S\cap T)=\frac{17}{64}$