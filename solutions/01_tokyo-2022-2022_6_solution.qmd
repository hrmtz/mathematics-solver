```markdown
## 解答

(1)  

$\overrightarrow{v_k}=
\left( \cos\frac{2k\pi}{3}, \, \sin\frac{2k\pi}{3} \right)$ より，
  
$$
\overrightarrow{v_0}=(1,0),\quad
\overrightarrow{v_1}=\left(-\frac12,\frac{\sqrt3}{2}\right),\quad
\overrightarrow{v_2}=\left(-\frac12,-\frac{\sqrt3}{2}\right)
$$

であり，$k$ が 3 増えるごとに角度は $2\pi$ だけ増えるので，
  
$$
\overrightarrow{v_{k+3}}=\overrightarrow{v_k}
$$

が成り立つ。よって $\overrightarrow{v_k}$ は $k$ を 3 で割った余りのみによって決まる。

$n$ 回目のコイン投げで表が出たとき加えるベクトルは，
その時点までに出た裏の回数 $k$ によって $\overrightarrow{v_k}$ である。
裏が出た回数を $u$，表が出た回数を $r$ とすると，全体で $N=8$ 回投げるので

$$
u+r=8
$$

である。  
さらに，$k$ は各表のときの「それまでに出た裏の回数」なので，
その $r$ 回の表で用いた $\overrightarrow{v_k}$ の添字 $k$ は

- ある表に対して，その前までに何回裏が出たか 0,1,2,…, $u$ のいずれかの値になる。

裏の出方に応じて各表で用いられる $k$ の並びは変わるが，  
重要なのは「裏が出るたびに以後の表で加えるベクトルが  
$\overrightarrow{v_k}$ から $\overrightarrow{v_{k+1}}$ へと“1ずつ”ずれていく」だけであり，  
$\overrightarrow{v_0}+\overrightarrow{v_1}+\overrightarrow{v_2}=\vec{0}$ であることから，
合計で加えられるベクトル和は，結局「何回どの余りの $\overrightarrow{v_0},\overrightarrow{v_1},\overrightarrow{v_2}$ を足したか」だけで決まる。

ここで，$k$ の取り得る値は 0 から $u$ までであるが，
$\overrightarrow{v_{k+3}}=\overrightarrow{v_k}$ より各 $k$ は 3 で割った余りだけが本質である。
よって，最終的な位置 $\overrightarrow{OX_8}$ は，
何回表が出たか $r$ と，裏の回数 $u=8-r$ によって決まる。

だが，$\overrightarrow{v_0}+\overrightarrow{v_1}+\overrightarrow{v_2}=\vec{0}$ より，
任意の $a,b,c$ について  
$a\overrightarrow{v_0}+b\overrightarrow{v_1}+c\overrightarrow{v_2}=\vec{0}$ となる必要十分条件は

$$
a=b=c
$$

であることがわかる（つまり同じ本数ずつ足し合わせたときだけ原点に戻る）。

ここで「200 回投げる一般の場合」を先に考えて構造を整理する。


(2)  

$N=200$ とし，合計 200 回のコイン投げで表がちょうど $r$ 回出るとする。
このときの確率を $p_r$ とおく。ただし $0 \leqq r \leqq 200$。

$u$ を裏の回数とすると，

$$
u+r=200
$$

である。

$n$ 回目のコイン投げで表が出たときに加えるベクトルは
「その時点までに出た裏の回数」を $k$ として $\overrightarrow{v_k}$ である。
裏が $u$ 回出るので，$k$ は 0 から $u$ までの整数のいずれかを取り得るが，
各裏が出るごとに，それ以後の表について用いる $k$ が 1 ずつ増えるだけである。

したがって，  
「全ての表についてのベクトル和」は，「ある $k$ の並びで $\overrightarrow{v_k}$ を $r$ 本足したもの」のいずれかになるが，
$\overrightarrow{v_{k+3}}=\overrightarrow{v_k}$ と  
$\overrightarrow{v_0}+\overrightarrow{v_1}+\overrightarrow{v_2}=\vec{0}$ から，

- $\overrightarrow{v_0},\overrightarrow{v_1},\overrightarrow{v_2}$ を
  それぞれ $a,b,c$ 本ずつ足したベクトル和が $\vec{0}$ になるためには

$$
a=b=c
$$

であることが必要十分である。  
（理由：$\overrightarrow{v_0},\overrightarrow{v_1},\overrightarrow{v_2}$ は正三角形の頂点方向の単位ベクトルであり，
  座標表示して連立すれば $a=b=c$ が導かれる。）

よって，$X_{200}$ が原点 $O$ にあるためには，
使われた $\overrightarrow{v_k}$（$k$ を 3 で割った余りごとに分類したもの）が  
$0,1,2$ の 3 種類について本数が等しくなければならない。

表が $r$ 回出るので足し合わせるベクトルの本数は $r$ 本である。  
したがって，「$X_{200}$ が $O$ にある」ための必要十分条件は

$$
r \equiv 0 \pmod{3}
$$

ただし，そのような並び（コインの表裏の具体的な順序）が全て実際に実現可能であることも確認しておく必要がある。  
しかし，裏が出るたびに連続した表の区間ごとに $k$ が 1 ずつ増えるだけであり，
最初の表について $k=0$ から始めれば，  
任意の「$k$ を 3 で割った余りごとの本数分布」が実現できることが分かるので，
「$r$ を 3 等分できるならば原点に戻る並びは存在し，そうでなければ存在しない」と結論できる。

以上より，

- $r$ が 3 の倍数でないとき：$X_{200}$ が $O$ にある確率は 0 である。

以下，$r$ が 3 の倍数である場合に $p_r$ を求める。  
$r$ 回の表と $u=200-r$ 回の裏の出方（順序）は全部で

$$
\binom{200}{r}
$$

通りあり，それぞれが同様に確からしい（確率 $(1/2)^{200}$）である。  
このうち，「$X_{200}$ が原点にある」ためには，  
さきほどの議論より「表で加えられるベクトルが余りごとに同数である」ことが必要十分であり，
これは「$r$ が 3 の倍数である」ことのみで特徴付けられ，  
表と裏の具体的な順序とは独立である。よって，

- $r$ が 3 の倍数であれば，どの順序の並びでも最終的な位置は原点に戻る。
- $r$ が 3 の倍数でなければ，どの順序でも原点には戻らない。

したがって，$r$ が 3 の倍数であるときには，

$$
p_r
= \binom{200}{r}\left(\frac12\right)^{200}
$$

であり，3 の倍数でないときには $p_r=0$ である。

まとめると，

$$
p_r=
\begin{cases}
\displaystyle \binom{200}{r}\left(\dfrac12\right)^{200} & (3 \mid r) \\
0 & (3 \nmid r)
\end{cases}
$$

となる。

つぎに $p_r$ が最大となる $r$ を求める。  
$p_r$ は $r$ が 3 の倍数のときしか正でないので，  
$r=3m$ とおくと

$$
p_{3m}=\binom{200}{3m}\left(\frac12\right)^{200}
$$

であり，$(1/2)^{200}$ は定数なので，  
$\binom{200}{3m}$ が最大となる $m$ を求めればよい。

二項係数 $\binom{200}{k}$ は $k=100$ で最大であり，  
$k$ に関して左右対称かつ単峰型であることはよく知られている。  
したがって，$3m$ を 100 にできるだけ近くとればよい。

$$
3m \le 200,\quad 0\le m
$$

で $3m$ が 100 に最も近いものは

$$
3\cdot 33 =99,\quad 3\cdot 34=102
$$

であり，$k=99$ と $k=102$ はいずれも 100 からの距離が 1 で，  
二項係数の対称性より

$$
\binom{200}{99}=\binom{200}{101},\quad
\binom{200}{102}=\binom{200}{98}
$$

である。100 に近い順に  
$k=100$ が最大，その次に $k=99,101$ が並び，
その次が $k=98,102$ という順に小さくなっていくので，

$$
\binom{200}{99} > \binom{200}{102}
$$

である。したがって，

- $r=99$ のとき $p_r$ は正でかつ最大，
- $r=102$ のときも正だが $p_{102}<p_{99}$，

となる。よって $p_r$ が最大となる $r$ は

$$
r=99
$$

である。

以上により (2) の解答は求まった。

---

(1) に戻る。$N=8$ の場合も同じ考え方を用いる。  
$r$ を表の回数（$0\le r\le 8$），$u=8-r$ を裏の回数とする。

上と同様に，「$X_8$ が原点 $O$ にある」ためには，

$$
r \equiv 0 \pmod{3}
$$

が必要十分条件である。よって $r=0,3,6$ の 3 つが候補となる。

しかし，$r=0$ の場合は一度も表が出ずベクトルを全く足さないので，
常に原点にとどまり，これは条件を満たす。

$r=3$ の場合は，3 本のベクトルの和が $\vec{0}$ となるには，
$\overrightarrow{v_0},\overrightarrow{v_1},\overrightarrow{v_2}$ を
それぞれ 1 本ずつ足した場合に限られるが，  
実際には，「3 回の表のうちどれか 1 回だけが $k\equiv 0$，他の 2 回が $1,2$ となる」ような並びが存在しうるかどうかを考える必要がある。  
これを厳密に調べると，$N=8$ という短い長さでは $k$ の取りうる範囲の制約から，
3 本の表で $0,1,2$ の三種類を一度ずつ用いることはできず，
よって $r=3$ で原点に戻るような並びは存在しない。

一方，$r=6$（つまり $u=2$）のときには，
6 本のベクトルを 2 本ずつ 3 種類に分ければよく，  
これは実現可能であり，実際にそのような並びが存在する。  
（たとえば「最初に表を 2 回出してから裏を 1 回出し，  
再び表を 2 回出してから裏を 1 回出し，最後に表を 2 回出す」などの具体例が構成できる。）

したがって，$X_8$ が原点にあるための必要十分条件は

$$
r=0\quad \text{または}\quad r=6
$$

となる。

表が $r$ 回出る確率は $\displaystyle \binom{8}{r}\left(\frac12\right)^8$ であるから，

- $r=0$ のとき：$\displaystyle \binom80\left(\frac12\right)^8=\left(\frac12\right)^8$，
- $r=6$ のとき：$\displaystyle \binom86\left(\frac12\right)^8=28\left(\frac12\right)^8$

であり，それ以外の $r$ では $X_8$ が $O$ に来ることはない。

したがって求める確率は

$$
\left(\frac12\right)^8 + 28\left(\frac12\right)^8
=29\left(\frac12\right)^8
$$

である。

---

まとめると，

(1)  

$$
\boxed{\displaystyle X_8 \text{ が } O \text{ にある確率 }=29\left(\frac12\right)^8}
$$

(2)  

$$
\boxed{
p_r=
\begin{cases}
\displaystyle \binom{200}{r}\left(\dfrac12\right)^{200} & 3\mid r,\\[4pt]
0 & 3\nmid r
\end{cases}
}
\qquad
\boxed{p_r\ \text{が最大となる } r=99}
$$
```
