## 解答

(1) 状態の整理  

与えられた6点を  
$A=(0,0),\ B=(0,1),\ C=(1,0),\ D=(1,1),\ E=(2,0),\ F=(2,1)$  
とおく．

図から，各点から出る線分で結ばれている点（隣接点）は

- $A$：$B,\ C$
- $B$：$A,\ D$
- $C$：$A,\ D,\ E$
- $D$：$B,\ C,\ F$
- $E$：$C,\ F$
- $F$：$D,\ E$

であり，それぞれ等確率で移動する．  
時刻 $n$ における動点Xが各点にいる確率を

$$
a_n=P(X_n=A),\ b_n=P(X_n=B),\ 
c_n=P(X_n=C),\ d_n=P(X_n=D),\ 
e_n=P(X_n=E),\ f_n=P(X_n=F)
$$

とおく．初期条件は時刻0で $A$ にいるから

$$
a_0=1,\quad b_0=c_0=d_0=e_0=f_0=0
$$

である．  

$n$ 秒後に $x$ 座標が $0$ である確率は，$X_n$ が $A$ または $B$ にいる確率
$$
P_n=a_n+b_n
$$
である．これを求める．

---

(2) 漸化式の導出  

確率の全事象分解（前の時刻の位置からの遷移）より，各点について

- $A$ に来るには，直前に $B$ または $C$ にいて $A$ に移動する必要がある．  
  $B\to A$ は $1/2$，$C\to A$ は $1/3$ の確率なので
  $$
  a_{n+1}=\frac12 b_n+\frac13 c_n
  $$

- $B$ に来るには，直前に $A$ または $D$ にいて $B$ に移動する：
  $A\to B$ は $1/2$，$D\to B$ は $1/3$ だから
  $$
  b_{n+1}=\frac12 a_n+\frac13 d_n
  $$

- $C$ に来るには，直前に $A,\ D,\ E$ にいてそれぞれ $C$ に来る場合：
  $A\to C$ は $1/2$，$D\to C$ は $1/3$，$E\to C$ は $1/2$ より
  $$
  c_{n+1}=\frac12 a_n+\frac13 d_n+\frac12 e_n
  $$

- $D$ に来るには，直前に $B,\ C,\ F$ にいてそれぞれ $D$ に来る場合：
  $B\to D$ は $1/2$，$C\to D$ は $1/3$，$F\to D$ は $1/2$ より
  $$
  d_{n+1}=\frac12 b_n+\frac13 c_n+\frac12 f_n
  $$

- $E$ に来るには，直前に $C$ または $F$ にいて $E$ に移動する：
  $C\to E$ は $1/3$，$F\to E$ は $1/2$ より
  $$
  e_{n+1}=\frac13 c_n+\frac12 f_n
  $$

- $F$ に来るには，直前に $D$ または $E$ にいて $F$ に移動する：
  $D\to F$ は $1/3$，$E\to F$ は $1/2$ より
  $$
  f_{n+1}=\frac13 d_n+\frac12 e_n
  $$

---

(3) 対称性の利用  

図は $x=1$ の直線に関して左右対称であり，遷移の仕方もその対称性を保っている．  
初期状態は $A=(0,0)$ で，その対称点は $E=(2,0)$ であるが，この2点は「交換する」対称変換になっていても確率分布は変わらない（遷移規則が対称）ので，

$$
a_n = e_n,\quad b_n = f_n
$$

がすべての $n$ について成り立つと考えられる．  
これを以下，漸化式からも確認して用いる．

$e_{n+1}$ の式で $e_n$ を $a_n$，$f_n$ を $b_n$ とおき

$$
e_{n+1}=\frac13 c_n+\frac12 f_n
      =\frac13 c_n+\frac12 b_n
$$

一方 $a_{n+1}=\dfrac12 b_n+\dfrac13 c_n$ であり，右辺は同じなので

$$
a_{n+1}=e_{n+1}
$$

となる．初期条件 $a_0=e_0=0$ より，数学的帰納法から全ての $n$ で $a_n=e_n$ である．  
同様に $b_{n+1}=\dfrac12 a_n+\dfrac13 d_n$，$f_{n+1}=\dfrac13 d_n+\dfrac12 e_n$ に $e_n=a_n$ を代入すると両者は等しいので，$b_0=f_0=0$ と合わせて $b_n=f_n$ も全ての $n$ に対して成り立つ．

したがって，左右対称な2点の確率は常に等しい．

---

(4) $x$ 座標によるまとめと簡略化  

$x$ 座標が同じ点をまとめて考える：

- $x=0$ の点：$A,B$  
  確率の和を $P_n=a_n+b_n$
- $x=1$ の点：$C,D$  
  確率の和を $Q_n=c_n+d_n$
- $x=2$ の点：$E,F$  
  確率の和を $R_n=e_n+f_n$

とおくと，全体で必ずどこかの点にいるので

$$
P_n+Q_n+R_n=1
$$

である．また上で示した対称性から

$$
a_n=e_n,\quad b_n=f_n
\quad\Rightarrow\quad
P_n = a_n+b_n = e_n+f_n = R_n
$$

したがって，$R_n=P_n$ であるから

$$
P_n+Q_n+P_n=1
\quad\Rightarrow\quad
Q_n=1-2P_n
$$

となる．

次に $P_{n+1}$ を $P_n$ のみで表す漸化式を求める．

$$
\begin{aligned}
P_{n+1}
&=a_{n+1}+b_{n+1} \\
&=\left(\frac12 b_n+\frac13 c_n\right)+\left(\frac12 a_n+\frac13 d_n\right) \\
&=\frac12(a_n+b_n)+\frac13(c_n+d_n) \\
&=\frac12 P_n + \frac13 Q_n
\end{aligned}
$$

ここで $Q_n=1-2P_n$ を代入すると

$$
\begin{aligned}
P_{n+1}
&=\frac12 P_n + \frac13(1-2P_n) \\
&=\frac12 P_n + \frac13 - \frac{2}{3}P_n \\
&=\left(\frac12 - \frac{2}{3}\right)P_n + \frac13 \\
&=-\frac{1}{6}P_n + \frac13
\end{aligned}
$$

よって

$$
P_{n+1}=-\frac{1}{6}P_n+\frac13
$$

が得られる．初期条件は $P_0=a_0+b_0=1+0=1$ である．

---

(5) 漸化式の解法  

一次の線形漸化式
$$
P_{n+1}=-\frac16 P_n+\frac13,\quad P_0=1
$$
を解く．

定数項を含む一次漸化式は，まず定常解（一定値解）$P_n=p$ を求めるとよい．  
$P_{n+1}=P_n=p$ として

$$
p = -\frac16 p+\frac13
$$

を解くと

$$
p+\frac16 p=\frac13
\quad\Rightarrow\quad
\frac76 p=\frac13
\quad\Rightarrow\quad
p=\frac13\cdot\frac67=\frac{2}{7}
$$

したがって $P_n=\dfrac{2}{7}$ は漸化式を満たす定常解である．

一般解は，$P_n$ からこの定常解を引いた差 $Q_n'=P_n-\dfrac{2}{7}$ が，斉次漸化式  
$Q'_{n+1}=-\dfrac16 Q'_n$ を満たすことを用いて求められる．実際

$$
\begin{aligned}
Q'_{n+1}
&=P_{n+1}-\frac{2}{7} \\
&=\left(-\frac16 P_n+\frac13\right)-\frac{2}{7} \\
&=-\frac16 P_n+\left(\frac13-\frac{2}{7}\right) \\
&=-\frac16 P_n+\left(\frac{7-6}{21}\right) \\
&=-\frac16 P_n+\frac{1}{21}
\end{aligned}
$$

一方で

$$
-\frac16 Q'_n
=-\frac16\left(P_n-\frac{2}{7}\right)
=-\frac16 P_n+\frac{1}{21}
$$

であり，右辺は $Q'_{n+1}$ と一致する．従って

$$
Q'_{n+1}=-\frac16 Q'_n
$$

が成り立つ．この解は

$$
Q'_n = Q'_0\left(-\frac16\right)^n
$$

である．初期値 $Q'_0=P_0-\dfrac{2}{7}=1-\dfrac{2}{7}=\dfrac{5}{7}$ より

$$
Q'_n = \frac{5}{7}\left(-\frac16\right)^n
$$

したがって

$$
P_n = Q'_n+\frac{2}{7}
     =\frac{2}{7} + \frac{5}{7}\left(-\frac16\right)^n
$$

となる．

---

(6) 結論  

求める，$n$ 秒後に動点Xの $x$ 座標が $0$ である確率は $P_n$ であり，

$$
\boxed{\,P_n = \dfrac{2}{7}+\dfrac{5}{7}\left(-\dfrac{1}{6}\right)^n\,}
$$

と求まる．