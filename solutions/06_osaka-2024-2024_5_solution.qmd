## 解答

(1)  
$n$ と互いに素な $1,2,\dots,n$ の個数を $f(n)$ としているから，$f$ はいわゆるオイラーの $\varphi$ 関数である。  
ここでは，$p,q,r$ を相異なる素数，$a,b,c$ を自然数として
$$
n=p^a q^b r^c
$$
とおく。

まず，$1\le k\le n$ を素因数分解したときに $p,q,r$ の少なくとも1つを割り切るかどうかで分類する。  
$k$ が $n$ と互いに素でないとは，$k$ が $p,q,r$ のいずれかで割り切れることである。

よって，「$1,2,\dots,n$ のうち $n$ と互いに素でないもの」の個数を数え，$n$ から引けば $f(n)$ が求まる。

$1$ から $n$ までの整数のうち

- $p$ で割り切れるものの個数は  
  $$
  \frac{n}{p}=\frac{p^a q^b r^c}{p}=p^{a-1}q^b r^c
  $$
- $q$ で割り切れるものの個数は  
  $$
  \frac{n}{q}=p^a q^{b-1} r^c
  $$
- $r$ で割り切れるものの個数は  
  $$
  \frac{n}{r}=p^a q^b r^{c-1}
  $$

となる。

しかし，これらを単純に足すと，例えば $p$ と $q$ の両方で割り切れる数（すなわち $pq$ で割り切れる数）などが重複して数えられてしまう。そこで包除原理を用いる。

- $p$ と $q$ の両方で割り切れるもの（$pq$ の倍数）の個数は  
  $$
  \frac{n}{pq}=p^{a-1}q^{b-1}r^c
  $$
- $q$ と $r$ の両方で割り切れるもの（$qr$ の倍数）の個数は  
  $$
  \frac{n}{qr}=p^a q^{b-1}r^{c-1}
  $$
- $r$ と $p$ の両方で割り切れるもの（$rp$ の倍数）の個数は  
  $$
  \frac{n}{rp}=p^{a-1}q^b r^{c-1}
  $$

さらに

- $p,q,r$ の3つすべてで割り切れるもの（$pqr$ の倍数）の個数は  
  $$
  \frac{n}{pqr}=p^{a-1}q^{b-1}r^{c-1}
  $$

である。

包除原理より，「$p,q,r$ の少なくとも1つで割り切れる数」の個数は

$$
\frac{n}{p}+\frac{n}{q}+\frac{n}{r}
-\left(\frac{n}{pq}+\frac{n}{qr}+\frac{n}{rp}\right)
+\frac{n}{pqr}
$$

で与えられる。したがって

$$
\begin{aligned}
f(n)
&=n-\left(\text{$p,q,r$ の少なくとも1つで割り切れる数の個数}\right)\\
&=n-\left(\frac{n}{p}+\frac{n}{q}+\frac{n}{r}
-\frac{n}{pq}-\frac{n}{qr}-\frac{n}{rp}
+\frac{n}{pqr}\right).
\end{aligned}
$$

ここで $n=p^a q^b r^c$ を代入して計算する：

$$
\begin{aligned}
f(p^a q^b r^c)
&=p^a q^b r^c
-\left(
p^{a-1}q^b r^c+p^a q^{b-1}r^c+p^a q^b r^{c-1}\right.\\
&\quad\left.
-\,p^{a-1}q^{b-1}r^c-p^a q^{b-1}r^{c-1}-p^{a-1}q^b r^{c-1}
+\,p^{a-1}q^{b-1}r^{c-1}
\right).
\end{aligned}
$$

この右辺を整理するため，$p^{a-1}q^{b-1}r^{c-1}$ をくくり出すと，

$$
\begin{aligned}
f(p^a q^b r^c)
&=p^{a-1}q^{b-1}r^{c-1}
\Bigl(
pqr-(qr+pr+pq)
+(r+p+q)-1
\Bigr)\\
&=p^{a-1}q^{b-1}r^{c-1}
\bigl(pqr-pq-pr-qr+p+q+r-1\bigr).
\end{aligned}
$$

ところで

$$
(p-1)(q-1)(r-1)
=pqr-pq-pr-qr+p+q+r-1
$$

であるから，

$$
f(p^a q^b r^c)
= p^{a-1}q^{b-1}r^{c-1}(p-1)(q-1)(r-1)
$$

が成り立つ。

(1) は示された。

---

(2)  
求めるのは，$5\le n\le 100$ で $f(n)$ が $n$ の約数となるような $n$ である。

まず，$n$ の素因数分解を
$$
n=\prod_{i=1}^k p_i^{e_i}
$$
（$p_i$ は相異なる素数）と書くとき，(1) の結果を一般化した既知の公式
$$
f(n)
= n\prod_{i=1}^k\left(1-\frac{1}{p_i}\right)
$$
が成り立つことを用いる（3つの場合に対して示した方法と同様に，包含排除を一般の個数 $k$ に拡張すれば得られる）。

この式より
$$
\frac{n}{f(n)}
=\prod_{i=1}^k\frac{1}{1-\frac{1}{p_i}}
=\prod_{i=1}^k\frac{p_i}{p_i-1}
$$
となる。したがって「$f(n)$ が $n$ の約数」であることと

$$
\frac{n}{f(n)}\in\mathbb{N}
\quad\Longleftrightarrow\quad
\prod_{i=1}^k\frac{p_i}{p_i-1}\in\mathbb{N}
$$

が同値である。

ここで，$\dfrac{p}{p-1}$ は既約分数であり，分母は $p-1$ である。  
素数 $p$ が異なれば $p-1$ も互いに異なるので，分母の素因数も基本的にはバラバラになる。したがって，多くの素数を含めると分母にたくさんの素因数が現れ，積が整数になりにくい。

実際に小さい素数でチェックしていく。

まず素数1つだけの場合
$$
\frac{p}{p-1}
$$
が整数となる $p$ を調べると，$p-1$ が $p$ を割り切る必要がある。  
これは $p-1\mid p$，すなわち $p-1\mid 1$ となるから $p-1=1$，$p=2$ に限る。  
よって

- $n$ の素因数が $2$ のみ（すなわち $n=2^a$）のときは  
  $$
  \frac{n}{f(n)}=\frac{2}{1}=2
  $$
  であり，常に整数となる。

次に素数2つの場合

1. $\{2,3\}$ のとき  
   $$
   \frac{n}{f(n)}=\frac{2}{1}\cdot\frac{3}{2}=3
   $$
   となり整数である。よって $n$ の素因数が $2,3$ のみ（$n=2^a3^b$）なら条件を満たす。

2. $\{2,5\}$ のとき  
   $$
   \frac{n}{f(n)}=\frac{2}{1}\cdot\frac{5}{4}=\frac{5}{2}
   $$
   で整数でない。

3. $\{3,5\}$ のとき  
   $$
   \frac{n}{f(n)}=\frac{3}{2}\cdot\frac{5}{4}=\frac{15}{8}
   $$
   で整数でない。

それ以外の組 $\{p,q\}$ でも
$$
\frac{p}{p-1}\cdot\frac{q}{q-1}
$$
の分母は $2,4$ 以上となり，分子と約分しても 1 にはならないので整数にはなり得ない。  
（例えばどちらも奇素数なら分母は偶数，分子は奇数となり，約分不能で分母に2が残る。）

さらに素数を3つ以上含めると
$$
\frac{n}{f(n)}=
\frac{p_1}{p_1-1}\cdot\frac{p_2}{p_2-1}\cdots\frac{p_k}{p_k-1}
$$
の分母は $2$ 以上の互いに違う数の積の形となり，明らかに約分しきれず 1 にはならず，整数とならない。

したがって，$f(n)$ が $n$ の約数となる $n$ は
- $n$ の素因数が $2$ のみ，すなわち $n=2^a$
- $n$ の素因数が $2,3$ のみ，すなわち $n=2^a3^b$

に限られる。

あとは $5\le n\le 100$ の範囲で，これらをすべて列挙する。

まず $2$ のべき乗：
$$
2^3=8,\ 2^4=16,\ 2^5=32,\ 2^6=64
$$
（$2^2=4$ は小さすぎ，$2^7=128$ は 100 より大きい。）

次に $2^a3^b$ で $5\le n\le 100$ となるものを順に挙げる。

- $b=1$（$3$ を1つ含む）  
  $$
  3\cdot 2^a\ (a\ge0)
  $$
  で $5$ 以上 $100$ 以下のもの：
  $$
  6,\ 12,\ 24,\ 48,\ 96
  $$
  （$3$ は小さすぎ，$192$ は大きすぎる。）

- $b=2$（$9$ を含む）  
  $$
  9\cdot 2^a
  $$
  で $5$ 以上 $100$ 以下のもの：
  $$
  9,\ 18,\ 36,\ 72
  $$

- $b=3$（$27$ を含む）  
  $$
  27\cdot 2^a
  $$
  で $100$ 以下のもの：
  $$
  27,\ 54
  $$
  （$108$ は 100 より大きい。）

- $b=4$（$81$ を含む）  
  $$
  81\cdot 2^a
  $$
  で $100$ 以下のもの：
  $$
  81
  $$
  （$162$ は 100 より大きい。）

$b\ge5$ では $3^b\ge 243>100$ なので除外される。

以上から，$5\le n\le 100$ で $f(n)$ が $n$ の約数となる $n$ は

- $2$ のべき：  
  $$
  8,\ 16,\ 32,\ 64
  $$
- $2^a3^b$ 型（重複を除いて列挙）：
  $$
  6,\ 9,\ 12,\ 18,\ 24,\ 27,\ 36,\ 48,\ 54,\ 72,\ 81,\ 96
  $$

を合わせて

$$
6,\ 8,\ 9,\ 12,\ 16,\ 18,\ 24,\ 27,\ 32,\ 36,\ 48,\ 54,\ 64,\ 72,\ 81,\ 96
$$

の16個である。

よって，求める $n$ は  
$$
6,\ 8,\ 9,\ 12,\ 16,\ 18,\ 24,\ 27,\ 32,\ 36,\ 48,\ 54,\ 64,\ 72,\ 81,\ 96
$$
である。