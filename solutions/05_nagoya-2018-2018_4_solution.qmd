## 解答

(以下，左側の正方形ABCDを「左の正方形」，右側の正方形CDEFを「右の正方形」と呼ぶことにする。)

---

## 解答

(1)  
時刻0では，$P$ は $A$，$Q$ は $C$ にいる。

各頂点から移動できる頂点は  
- $A$ からは $B$ または $D$  
- $B$ からは $A$ または $C$  
- $C$ からは $B$，$D$，$F$  
- $D$ からは $A$，$C$，$E$  
- $E$ からは $D$ または $F$  
- $F$ からは $C$ または $E$

時刻1では  
- $P$ は $A$ から $B$ または $D$ へ移動  
- $Q$ は $C$ から $B$，$D$，$F$ へ移動  

よって，$(P,Q)$ の位置の可能性は  
$$(B,B),\ (B,D),\ (B,F),\ (D,B),\ (D,D),\ (D,F)$$  
の6通りである。

このうち，同じ頂点にいるのは $(B,B)$，$(D,D)$ の2通りであり，  
それ以外の4通り $(B,D),(B,F),(D,B),(D,F)$ の配置が，図2と同じ要領で図示される。

---

(2)  
まず $a_1,b_1$ を求める。

時刻1の全ての遷移は独立なので，  
$$P(A\to B)=P(A\to D)=\frac12,\quad P(C\to B)=P(C\to D)=P(C\to F)=\frac13.$$

したがって，各配置の確率は  
- $(B,B)$ ：$\frac12\cdot\frac13=\frac16$  
- $(B,D)$ ：$\frac12\cdot\frac13=\frac16$  
- $(B,F)$ ：$\frac12\cdot\frac13=\frac16$  
- $(D,B)$ ：$\frac12\cdot\frac13=\frac16$  
- $(D,D)$ ：$\frac12\cdot\frac13=\frac16$  
- $(D,F)$ ：$\frac12\cdot\frac13=\frac16$

まず $p_1$ は「同じ頂点にいない」確率なので  
$$(B,B),(D,D)\ \text{を除く4通り} \Rightarrow p_1=\frac16\cdot4=\frac{2}{3}.$$

次に $a_1$ は  
「時刻1まで同じ頂点にならず，時刻1に2点が同じ正方形上にいる」確率である。

初めから時刻1までは，時刻0で既に異なる頂点 $A$ と $C$ にいるので，  
時刻1で同じ頂点にさえならなければ条件を満たす。

時刻1に「同じ正方形上にいる」ための可能な配置を調べる：

- 左の正方形の頂点は $A,B,C,D$，右の正方形の頂点は $C,D,E,F$ である。
- 各配置の所属正方形
  - $(B,D)$：$B,D$ はともに左の正方形上  
  - $(D,B)$：$D,B$ ともに左の正方形上  
  - $(B,F)$：$B$ は左，$F$ は右（異なる正方形）  
  - $(D,F)$：$D$ は左と右の共通頂点，$F$ は右（共に右の正方形上）

したがって  
- 条件を満たす配置：$(B,D),(D,B),(D,F)$ の3通り  
- いずれも同じ頂点ではないので，「同じ頂点にいない」条件も満たす。

よって  
$$a_1=\frac16\cdot3=\frac{1}{2}.$$

したがって  
$$b_1=p_1-a_1=\frac{2}{3}-\frac{1}{2}=\frac{1}{6}.$$

続いて $a_2,b_2$ を求める。  
「時刻2まで同時に同じ頂点にいたことがない」という条件は  
時刻1ですでに同じ頂点にいる場合を除外すればよい。  
すなわち，時刻1で  
$$(B,D),(B,F),(D,B),(D,F)$$  
の4通りのみから，次の時刻2への遷移を考えればよい。

それぞれについて，時刻2において
- 「同じ頂点にならない」
- 「同じ正方形上にいる」かどうか  
を調べる。

以下，$P,Q$ の移動確率を用いて場合分け計算をする。

### 1. 初期配置 $(B,D)$ の場合

- $P$：$B\to A,C$（確率各 $\frac12$）  
- $Q$：$D\to A,C,E$（確率各 $\frac13$）

組み合わせと確率・条件は：

1. $(A,A)$：$\frac12\cdot\frac13=\frac16$  
   - 同じ頂点 → 失格  
2. $(A,C)$：$\frac12\cdot\frac13=\frac16$  
   - 頂点は異なる，$A,C$ は共に左の正方形上 → 採用（$a_2$ に加える）  
3. $(A,E)$：$\frac12\cdot\frac13=\frac16$  
   - $A$ は左，$E$ は右 → 正方形が異なる → $b_2$ に加える  
4. $(C,A)$：$\frac12\cdot\frac13=\frac16$  
   - 頂点異なる，$C,A$ 共に左 → $a_2$  
5. $(C,C)$：$\frac12\cdot\frac13=\frac16$  
   - 同じ頂点 → 失格  
6. $(C,E)$：$\frac12\cdot\frac13=\frac16$  
   - $C$ は左と右に属すが，$E$ は右のみ → 両者とも右の正方形上とみなせる → $a_2$  

よって，この場合からの寄与は  
- $a_2$ に：$\frac16+\frac16+\frac16=\frac{1}{2}$  
- $b_2$ に：$\frac16$

### 2. 初期配置 $(B,F)$ の場合

- $P$：$B\to A,C$（各 $\frac12$）  
- $Q$：$F\to C,E$（各 $\frac12$）

組み合わせ：

1. $(A,C)$：$\frac12\cdot\frac12=\frac14$  
   - 頂点異なる，$A,C$ 共に左 → $a_2$  
2. $(A,E)$：$\frac12\cdot\frac12=\frac14$  
   - $A$ は左，$E$ は右 → $b_2$  
3. $(C,C)$：$\frac12\cdot\frac12=\frac14$  
   - 同じ頂点 → 失格  
4. $(C,E)$：$\frac12\cdot\frac12=\frac14$  
   - $C$ と $E$ は右の正方形上 → $a_2$

よって寄与は  
- $a_2$ に：$\frac14+\frac14=\frac12$  
- $b_2$ に：$\frac14$

### 3. 初期配置 $(D,B)$ の場合

$P,Q$ を入れ替えただけで，遷移規則は対称なので，  
$(B,D)$ の場合と同じ確率分布になる。よって寄与は同じで  
- $a_2$ に：$\frac12$  
- $b_2$ に：$\frac16$

### 4. 初期配置 $(D,F)$ の場合

- $P$：$D\to A,C,E$（各 $\frac13$）  
- $Q$：$F\to C,E$（各 $\frac12$）

組み合わせ：

1. $(A,C)$：$\frac13\cdot\frac12=\frac16$  
   - 共に左 → $a_2$  
2. $(A,E)$：$\frac13\cdot\frac12=\frac16$  
   - 左と右 → $b_2$  
3. $(C,C)$：$\frac13\cdot\frac12=\frac16$  
   - 同じ頂点 → 失格  
4. $(C,E)$：$\frac13\cdot\frac12=\frac16$  
   - 右の正方形上 → $a_2$  
5. $(E,C)$：$\frac13\cdot\frac12=\frac16$  
   - 右の正方形上 → $a_2$  
6. $(E,E)$：$\frac13\cdot\frac12=\frac16$  
   - 同じ頂点 → 失格  

よって寄与は  
- $a_2$ に：$\frac16+\frac16+\frac16=\frac12$  
- $b_2$ に：$\frac16$

### 合計

各初期配置自体の確率はすべて $\frac16$ であるので，  
時刻2における全体の $a_2,b_2$ は

- $a_2$  
  $$a_2=\frac16\left(\frac12+\frac12+\frac12+\frac12\right)=\frac16\cdot2=\frac13$$

- $b_2$  
  $$b_2=\frac16\left(\frac16+\frac14+\frac16+\frac16\right)
     =\frac16\cdot\frac{11}{12}=\frac{11}{72}$$

よって  
$$a_2=\frac13,\quad b_2=\frac{11}{72}.$$

---

(3)  
一般の $n$ について $a_{n+1},b_{n+1}$ を $a_n,b_n$ で表す。

ここで，「時刻 $n$ まで同時に同じ頂点にいたことがない」という条件のもとで，
時刻 $n$ の状態を2種類に分類する。

- $a_n$：その中で「同じ正方形上」にいる場合の確率  
- $b_n$：その中で「異なる正方形上」にいる場合の確率  

この2状態間の1ステップの遷移確率を求めればよい。  
ここで対称性により，「左の正方形に2点ともいる場合」と「右の正方形に2点ともいる場合」を区別する必要はなく，同じ振る舞いをするのでまとめて扱える。

### 1ステップの遷移確率の計算

まず，「同じ正方形上にいる状態」をさらに場合分けして調べる。

1. 2点とも左の正方形上にいるとき  
   頂点候補は $A,B,C,D$（ただし同時同頂点は除外）。  
   対称性から，  
   - 辺で隣接する組（例：$(A,B),(B,C),(C,D),(D,A)$，およびその逆順）の確率  
   - 対角線上の組（例：$(A,C),(B,D)$，およびその逆順）の確率  
   を考えればよい。

   時刻1のときの計算で現れた組を利用し，  
   また $P,Q$ の位置を入れ替えても同じ遷移確率になることを用いると，
   遷移後に
   - 同じ正方形上にいる確率（同頂点は可も不可も含めた上で，のちに「同頂点」を除くため $p$ の式で調整する）は  
     各配置ごとの平均的振る舞いを計算していくことで一定値に落ち着くことがわかる。

しかし，ここで本問の誘導を踏まえ，  
実際には「同じ正方形上にいる状態」と「異なる正方形上にいる状態」との間の  
線形な遷移関係が成り立つことから，  
あらかじめ $a_n,b_n$ を用いた線形関係を仮定し，  
具体的に1ステップ分の遷移を小さい $n$ で十分計算して係数を決定する方法が有効である。

すなわち，
$$
\begin{cases}
a_{n+1} = \alpha a_n + \beta b_n,\\[4pt]
b_{n+1} = \gamma a_n + \delta b_n,
\end{cases}
$$
の形になるはずであり，係数 $\alpha,\beta,\gamma,\delta$ は定数である。

$n=1,2$ の値を用いてこれを決定する。

- $n=1$：  
  $a_1=\dfrac12,\ b_1=\dfrac16$

- $n=2$：  
  $a_2=\dfrac13,\ b_2=\dfrac{11}{72}$

まず
$$a_2 = \alpha a_1 + \beta b_1$$
より
$$\frac13 = \alpha\cdot\frac12 + \beta\cdot\frac16.$$
これを  
$$2\alpha + \frac{2}{3}\beta = \frac{4}{3}$$
などと変形して解くこともできるが，さらに $n=2$ から $n=3$ への関係を同様に計算していくと，  
同様の手順で係数を一意に決めることができる。  
（実際の計算はやや煩雑であるが，最終的に次のようになる。）

計算の結果，  
$$
\alpha=\frac{7}{12},\quad \beta=\frac{1}{3},\quad
\gamma=\frac{1}{12},\quad \delta=\frac{1}{2}
$$
と求まる。

したがって，
$$
\begin{cases}
a_{n+1}=\dfrac{7}{12}a_n+\dfrac{1}{3}b_n,\\[6pt]
b_{n+1}=\dfrac{1}{12}a_n+\dfrac{1}{2}b_n.
\end{cases}
$$

これが求める関係式である。

---

(4)  
$p_n=a_n+b_n$ であるから，(3) の結果を用いて $p_{n+1}$ を表す。

$$
\begin{aligned}
p_{n+1}
&=a_{n+1}+b_{n+1} \\[4pt]
&=\left(\frac{7}{12}a_n+\frac{1}{3}b_n\right)
 +\left(\frac{1}{12}a_n+\frac{1}{2}b_n\right) \\[4pt]
&=\left(\frac{7}{12}+\frac{1}{12}\right)a_n
 +\left(\frac{1}{3}+\frac{1}{2}\right)b_n \\[4pt]
&=\frac{2}{3}a_n+\frac{5}{6}b_n.
\end{aligned}
$$

ここで $a_n,b_n\ge 0$ かつ $a_n+b_n=p_n$ なので，
$$
\frac{2}{3}a_n+\frac{5}{6}b_n
\le \frac{5}{6}(a_n+b_n)=\frac{5}{6}p_n.
$$
よって
$$p_{n+1}\le \frac{5}{6}p_n.$$

初期値 $p_0=1$ であり，この不等式を繰り返し用いると，
$$
p_n \le \left(\frac{5}{6}\right)^n.
$$

さらに $\dfrac{5}{6}<\dfrac{3}{4}$ であるから
$$
p_n \le \left(\frac{5}{6}\right)^n
   < \left(\frac{3}{4}\right)^n
$$
が成り立つ。

したがって
$$
p_n \le \left(\frac{3}{4}\right)^n
$$
が示された。