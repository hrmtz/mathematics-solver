## 解答

与えられた条件は  
$a_1 = 3$，$S_n = a_1 + a_2 + \cdots + a_n$ として  
$$
a_n = \frac{S_n}{n} + (n-1)\cdot 2^n \quad (n \geqq 2)
$$
である．

(1) まず，$S_n$ を含まない形の漸化式を立てる．  
$n \geqq 2$ のとき，$S_n = S_{n-1} + a_n$ であるから，
$$
a_n = \frac{S_n}{n} + (n-1)2^n
= \frac{S_{n-1} + a_n}{n} + (n-1)2^n
$$
となる．これを $a_n$ について整理する：

$$
a_n = \frac{S_{n-1} + a_n}{n} + (n-1)2^n
$$

両辺に $n$ を掛けて
$$
n a_n = S_{n-1} + a_n + n(n-1)2^n
$$
よって
$$
(n-1)a_n = S_{n-1} + n(n-1)2^n
$$
$(n-1)>0$ なので割って
$$
a_n = \frac{S_{n-1}}{n-1} + n2^n \quad (n \geqq 2)
$$
となる．

同様に $n$ を $n-1$ に置き換えると（$n \geqq 3$）
$$
a_{n-1} = \frac{S_{n-1}}{n-1} + (n-2)2^{\,n-1}
$$
であるから，この 2 式の右辺第1項は等しく，
$$
a_n - a_{n-1} = n2^n - (n-2)2^{\,n-1} \quad (n \geqq 3)
$$
となる．右辺を整理すると
$$
n2^n - (n-2)2^{\,n-1}
= 2^{\,n-1}\bigl(2n - (n-2)\bigr)
= 2^{\,n-1}(n+2)
$$
したがって
$$
a_n - a_{n-1} = (n+2)2^{\,n-1} \quad (n \geqq 3)
$$
という漸化式を得る．

(2) 初項を確認しておく．$n=2$ をもとの条件に代入すると，
$$
a_2 = \frac{S_2}{2} + (2-1)2^2
= \frac{a_1 + a_2}{2} + 4
= \frac{3 + a_2}{2} + 4
$$
これを解くと
$$
a_2 = \frac{3 + a_2}{2} + 4
\quad\Longrightarrow\quad
2a_2 = 3 + a_2 + 8
\quad\Longrightarrow\quad
a_2 = 11
$$
である．

よって $a_2 = 11$，$a_n - a_{n-1} = (n+2)2^{\,n-1}$ $(n\geqq3)$ から，
$a_n$ は
$$
a_n = a_2 + \sum_{k=3}^n (a_k - a_{k-1})
= a_2 + \sum_{k=3}^n (k+2)2^{\,k-1}
$$
と表せる．したがって
$$
a_n = 11 + \sum_{k=3}^n (k+2)2^{\,k-1}
$$
である．

(3) 和 $\displaystyle \sum_{k=3}^n (k+2)2^{\,k-1}$ を求める．  
まず
$$
(k+2)2^{\,k-1}
= \frac12 (k+2)2^k
$$
なので
$$
\sum_{k=3}^n (k+2)2^{\,k-1}
= \frac12 \sum_{k=3}^n (k+2)2^k
= \frac12 \sum_{k=3}^n k2^k + \frac12 \sum_{k=3}^n 2\cdot 2^k
= \frac12 \sum_{k=3}^n k2^k + \sum_{k=3}^n 2^k
$$

ここで，$T_n = \sum_{k=1}^n k2^k$ とおくと，等比数列の性質を用いて
$$
T_n = \sum_{k=1}^n k2^k
\quad\Longrightarrow\quad
2T_n = \sum_{k=1}^n k2^{k+1} = \sum_{k=2}^{n+1} (k-1)2^k
$$
よって
$$
2T_n - T_n = \sum_{k=2}^{n} (k-1)2^k + n2^{\,n+1}
= \sum_{k=1}^n k2^k = T_n
$$
だが，$\sum_{k=2}^n (k-1)2^k = \sum_{k=1}^n k2^k - \sum_{k=1}^n 2^k = T_n - (2^{n+1}-2)$ を用いると，
$$
T_n = \bigl(T_n - (2^{n+1}-2)\bigr) + n2^{\,n+1}
$$
となり，これより
$$
T_n = (n-1)2^{\,n+1} + 2
$$
を得る．

したがって
$$
\sum_{k=3}^n k2^k = T_n - (1\cdot2^1 + 2\cdot2^2)
= \bigl((n-1)2^{\,n+1} + 2\bigr) - (2 + 8)
= (n-1)2^{\,n+1} - 8
$$
また，
$$
\sum_{k=3}^n 2^k = (2^{n+1}-2) - (2^1 + 2^2)
= 2^{n+1} - 2 - 2 - 4
= 2^{n+1} - 8
$$

これらをまとめると
$$
\sum_{k=3}^n (k+2)2^{\,k-1}
= \frac12\bigl((n-1)2^{\,n+1} - 8\bigr) + (2^{n+1} - 8)
$$
$$
= (n-1)2^{\,n} - 4 + 2^{n+1} - 8
= (n-1)2^{\,n} + 2^{n+1} - 12
$$
右辺をさらに整理すると
$$
(n-1)2^{\,n} + 2^{n+1}
= (n-1)2^{\,n} + 2\cdot 2^{\,n}
= (n+1)2^{\,n}
$$
なので
$$
\sum_{k=3}^n (k+2)2^{\,k-1}
= (n+1)2^{\,n} - 12
$$

よって
$$
a_n = 11 + \bigl((n+1)2^{\,n} - 12\bigr)
= (n+1)2^{\,n} - 1
$$

(4) 最後に，この式がもとの条件を満たすことを確認する．

まず $n=1$ のとき
$$
a_1 = (1+1)2^1 - 1 = 4 - 1 = 3
$$
で，条件 $a_1 = 3$ を満たす．

また
$$
a_k = (k+1)2^{\,k} - 1
$$
より
$$
S_n = \sum_{k=1}^n a_k
= \sum_{k=1}^n \bigl((k+1)2^{\,k} - 1\bigr)
= \sum_{k=1}^n (k+1)2^{\,k} - n
$$
先ほどと同様に
$$
\sum_{k=1}^n (k+1)2^{\,k}
= \sum_{k=1}^n k2^{\,k} + \sum_{k=1}^n 2^{\,k}
= \bigl((n-1)2^{\,n+1} + 2\bigr) + (2^{n+1}-2)
= n2^{\,n+1}
$$
よって
$$
S_n = n2^{\,n+1} - n = n(2^{\,n+1} - 1)
$$
したがって
$$
\frac{S_n}{n} + (n-1)2^n
= (2^{\,n+1} - 1) + (n-1)2^{\,n}
= 2^{\,n}\bigl(2 + n - 1\bigr) - 1
= (n+1)2^{\,n} - 1
= a_n
$$
となり，条件を満たす．

ゆえに，求める一般項は
$$
\boxed{a_n = (n+1)2^{\,n} - 1}
$$
である．