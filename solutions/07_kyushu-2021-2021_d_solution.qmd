## 解答

(初期条件)  
時刻 0 で $P$ は頂点 $B$ にいるから
$$
a_0=0,\quad b_0=1,\quad c_0=0,\quad d_0=0
$$
である。

また，遷移確率の条件から，$n\ge0$ について次の関係が成り立つ。

- 「時刻 $n$ に $A$ にいる」場合の次の位置より
  $$
  \begin{aligned}
  a_{n+1} &= \frac12 a_n + \frac13 b_n + \frac13 c_n + \frac13 d_n,\\
  b_{n+1} &= \frac16 a_n + \frac13 b_n + 0\cdot c_n + \frac13 d_n,\\
  c_{n+1} &= \frac16 a_n + \frac13 b_n + \frac13 c_n + 0\cdot d_n,\\
  d_{n+1} &= \frac16 a_n + 0\cdot b_n + \frac13 c_n + \frac13 d_n.
  \end{aligned}
  $$

ここで $a_n+b_n+c_n+d_n=1$（全確率の和は 1）を用いて式を整理する。

---

### (1) $a_n$ の求値

まず
$$
b_n+c_n+d_n = 1-a_n
$$
であるから，$a_{n+1}$ について
$$
\begin{aligned}
a_{n+1}
&= \frac12 a_n + \frac13(b_n+c_n+d_n)\\
&= \frac12 a_n + \frac13(1-a_n)\\
&= \frac12 a_n + \frac13 - \frac13 a_n\\
&= \left(\frac12 - \frac13\right)a_n + \frac13\\
&= \frac16 a_n + \frac13.
\end{aligned}
$$

したがって，$a_n$ は
$$
a_{n+1} = \frac16 a_n + \frac13,\quad a_0=0
$$
を満たす一次の線形漸化式である。

定常解（$n$ によらず一定の解）$a$ を求めると
$$
a = \frac16 a + \frac13
$$
より
$$
a - \frac16 a = \frac13
\;\Longrightarrow\;
\frac56 a = \frac13
\;\Longrightarrow\;
a = \frac{1/3}{5/6} = \frac{2}{5}.
$$

よって $a_n$ から定常解を引いた差を $x_n=a_n-\frac25$ とおくと
$$
x_{n+1}
= a_{n+1}-\frac25
= \left(\frac16 a_n + \frac13\right) - \frac25
= \frac16 a_n - \frac1{15}
= \frac16\left(a_n-\frac25\right)
= \frac16 x_n
$$
となる。初期条件は
$$
x_0 = a_0 - \frac25 = 0 - \frac25 = -\frac25
$$
であるから
$$
x_n = x_0\left(\frac16\right)^n = -\frac25\left(\frac16\right)^n.
$$

したがって
$$
a_n = x_n + \frac25 = \frac25 - \frac25\left(\frac16\right)^n
= \frac25\left(1 - \left(\frac16\right)^n\right).
$$

よって

$$
\boxed{\,a_n = \displaystyle \frac25\left(1 - \left(\frac16\right)^n\right)\,}
$$

である。

---

### (2) $n$ が 3 の倍数のときの $b_n-c_n$ と $c_n-d_n$

次に，$b_n - c_n$ および $c_n - d_n$ の満たす漸化式を求める。

まず
$$
\begin{aligned}
b_{n+1}-c_{n+1}
&= \left(\frac16 a_n + \frac13 b_n + \frac13 d_n\right)
   - \left(\frac16 a_n + \frac13 b_n + \frac13 c_n\right)\\
&= \frac13(d_n - c_n),
\end{aligned}
$$
また
$$
\begin{aligned}
c_{n+1}-d_{n+1}
&= \left(\frac16 a_n + \frac13 b_n + \frac13 c_n\right)
   - \left(\frac16 a_n + \frac13 c_n + \frac13 d_n\right)\\
&= \frac13(b_n - d_n).
\end{aligned}
$$

さらに $b_n + c_n + d_n = 1-a_n$ より
$$
b_n - d_n
= (b_n - c_n) + (c_n - d_n)
$$
であるから
$$
c_{n+1}-d_{n+1} = \frac13\{(b_n-c_n)+(c_n-d_n)\}.
$$

ここで
$$
x_n = b_n - c_n,\quad y_n = c_n - d_n
$$
とおくと
$$
\begin{cases}
x_{n+1} = \dfrac13(-y_n),\\[2mm]
y_{n+1} = \dfrac13(x_n + y_n).
\end{cases}
$$

行列を用いて
$$
\begin{pmatrix}
x_{n+1}\\[1mm]
y_{n+1}
\end{pmatrix}
=
\frac13
\begin{pmatrix}
0 & -1\\
1 & 1
\end{pmatrix}
\begin{pmatrix}
x_n\\[1mm]
y_n
\end{pmatrix}
$$
と書ける。

まず初期値を求める。$n=0$ では
$$
b_0=1,\ c_0=d_0=0
$$
なので
$$
x_0 = b_0 - c_0 = 1,\quad y_0 = c_0 - d_0 = 0.
$$

1ステップずつ計算すると
$$
\begin{aligned}
x_1 &= \frac13(0\cdot x_0 - 1\cdot y_0) = 0,\\
y_1 &= \frac13(1\cdot x_0 + 1\cdot y_0) = \frac13,
\end{aligned}
$$
次に
$$
\begin{aligned}
x_2 &= \frac13(0\cdot x_1 - 1\cdot y_1) = -\frac19,\\
y_2 &= \frac13(1\cdot x_1 + 1\cdot y_1) = \frac19,
\end{aligned}
$$
さらに
$$
\begin{aligned}
x_3 &= \frac13(0\cdot x_2 - 1\cdot y_2) = -\frac1{27},\\
y_3 &= \frac13(1\cdot x_2 + 1\cdot y_2) = 0.
\end{aligned}
$$

よって $n=3$ のとき
$$
x_3 = b_3 - c_3 = -\frac1{27},\quad y_3 = c_3 - d_3 = 0
$$
である。

さらにもう1ステップ進めると
$$
\begin{aligned}
x_4 &= \frac13(0\cdot x_3 - 1\cdot y_3) = 0,\\
y_4 &= \frac13(1\cdot x_3 + 1\cdot y_3) = -\frac1{81},
\end{aligned}
$$
続いて
$$
\begin{aligned}
x_5 &= \frac13(0\cdot x_4 - 1\cdot y_4) = \frac1{243},\\
y_5 &= \frac13(1\cdot x_4 + 1\cdot y_4) = -\frac1{243},
\end{aligned}
$$
さらに
$$
\begin{aligned}
x_6 &= \frac13(0\cdot x_5 - 1\cdot y_5) = \frac1{729},\\
y_6 &= \frac13(1\cdot x_5 + 1\cdot y_5) = 0.
\end{aligned}
$$

ここから
$$
(x_0,y_0)=(1,0),\quad (x_3,y_3)=\left(-\frac1{27},0\right),\quad (x_6,y_6)=\left(\frac1{729},0\right)
$$
と，3ステップごとに
$$
x_{n+3} = -\frac1{27}x_n,\quad y_{n+3}=0
$$
であることがわかる（実際には上の計算で確認した通り $y_{3k}=0$ が成り立っている）。

特に $n$ が 3 の倍数，すなわち $n=3k$ のとき $y_n=0$ であり，
$x_{3(k+1)}=-\dfrac1{27}x_{3k}$ であるから
$$
x_{3k} = \left(-\frac1{27}\right)^k x_0 = \left(-\frac1{27}\right)^k.
$$

よって，$n$ が 3 の倍数 $n=3k$ のとき
$$
b_n - c_n = x_{3k} = \left(-\frac1{27}\right)^k,
\quad
c_n - d_n = y_{3k} = 0.
$$

すなわち
$$
\boxed{\,n=3k\ のとき\quad
b_n - c_n = \left(-\frac1{27}\right)^k,\quad c_n - d_n = 0\,}
$$
である。

---

### (3) $n$ が 3 の倍数のときの $b_n,\,c_n,\,d_n$

$n=3k$ とおく。すでに (1) より
$$
a_{3k} = \frac25\left(1 - \left(\frac16\right)^{3k}\right) = \frac25\left(1 - \frac1{6^{3k}}\right)
$$
である。

(2) より
$$
b_{3k} - c_{3k} = \left(-\frac1{27}\right)^k,\quad c_{3k} - d_{3k} = 0
$$
なので，$c_{3k}=d_{3k}$ がわかる。また
$$
b_{3k}+c_{3k}+d_{3k} = 1 - a_{3k}
= 1 - \frac25\left(1 - \frac1{6^{3k}}\right)
= \frac35 + \frac2{5\cdot 6^{3k}}
$$
であるから，
$$
b_{3k} + 2c_{3k} = \frac35 + \frac2{5\cdot 6^{3k}}.
$$

これと $b_{3k} - c_{3k} = \left(-\dfrac1{27}\right)^k$ を連立すると，
まず $b_{3k}$ は
$$
\begin{aligned}
b_{3k}
&= (b_{3k} + 2c_{3k}) - 2c_{3k}\\
&= \left(\frac35 + \frac2{5\cdot 6^{3k}}\right) - 2c_{3k},
\end{aligned}
$$
また一方で
$$
b_{3k} = (b_{3k} - c_{3k}) + c_{3k}
= \left(-\frac1{27}\right)^k + c_{3k}.
$$
両式を等しくおいて
$$
\left(-\frac1{27}\right)^k + c_{3k}
= \frac35 + \frac2{5\cdot 6^{3k}} - 2c_{3k}
$$
より
$$
3c_{3k}
= \frac35 + \frac2{5\cdot 6^{3k}} - \left(-\frac1{27}\right)^k,
$$
したがって
$$
c_{3k}
= \frac15 + \frac{2}{15\cdot 6^{3k}} - \frac13\left(-\frac1{27}\right)^k.
$$

ここで $6^{3k}=(6^3)^k=216^k$ であることを用いると
$$
c_{3k}
= \frac15 + \frac{2}{15\cdot 216^k} - \frac1{3}\left(-\frac1{27}\right)^k.
$$

$b_{3k}$ は
$$
b_{3k} = c_{3k} + \left(-\frac1{27}\right)^k
= \frac15 + \frac{2}{15\cdot 216^k} + \frac23\left(-\frac1{27}\right)^k,
$$
また $d_{3k}=c_{3k}$ なので
$$
d_{3k}
= \frac15 + \frac{2}{15\cdot 216^k} - \frac1{3}\left(-\frac1{27}\right)^k.
$$

よって，$n=3k$ のとき
$$
\boxed{%
\begin{aligned}
a_n &= \frac25\left(1 - \left(\frac16\right)^n\right),\\[1mm]
b_n &= \frac15 + \frac{2}{15\cdot 216^{n/3}} + \frac23\left(-\frac1{27}\right)^{n/3},\\[1mm]
c_n &= \frac15 + \frac{2}{15\cdot 216^{n/3}} - \frac13\left(-\frac1{27}\right)^{n/3},\\[1mm]
d_n &= \frac15 + \frac{2}{15\cdot 216^{n/3}} - \frac13\left(-\frac1{27}\right)^{n/3}
\end{aligned}
}$$
となる（ここでは特に $n$ が 3 の倍数である）。