## 解答

(1)  
コインを $n$ 回投げたとき，裏の出る回数を $r$ とする。  
表が出る回数は $n-r$ 回であるから，石の移動距離の合計は

- 表による移動：$2(n-r)$
- 裏による移動：$3r$

したがって，$n$ 回投げた後の石の位置 $a_n$ は  
原点から $2(n-r) + 3r$ だけ正の向きに進んだ位置なので
$$
a_n = 2(n-r) + 3r = 2n + r
$$
となる。

---

(2) $n=4$ の場合を考える。

### (i) 得点が0でない確率

得点が0でないのは，条件より $a_4 = 2\cdot4 + 2 = 10$ のときに限る。  
(1) の結果 $a_4=2\cdot4 + r = 8 + r$ だから
$$
8 + r = 10 \quad\Longrightarrow\quad r = 2
$$
すなわち，「裏が2回出る」ときに限り，得点が0でない。

裏が2回出る確率は，二項分布より
$$
\binom{4}{2}\left(\frac12\right)^4 = 6 \cdot \frac1{16} = \frac{3}{8}
$$
である。  
よって，得点が0でない確率は
$$
\frac{3}{8}
$$
である。

### (ii) 得点が25である確率

上と同様に，得点が正のときは $r=2$ の場合に限る。  
そこで，裏2回・表2回の各試行ごとに，得点
$$
S = a_1 + a_2 + a_3 + a_4
$$
を調べ，$S=25$ となる場合の数を数える。

$r=2$ のとき，表(2)2回・裏(3)2回を順に並べた4回の投げ方は全部で $\binom{4}{2}=6$ 通りであり，それぞれの $a_k$ と $S$ を求める。

石の位置は，最初原点(0)から始め，コインの結果に応じて $+2$ または $+3$ ずつ増えていくので，順に和を取ればよい。

- 表を H，裏を T と書く。

1. H H T T のとき  
　移動：$+2,+2,+3,+3$  
　位置：$a_1=2,\ a_2=4,\ a_3=7,\ a_4=10$  
　和：$S = 2+4+7+10 = 23$

2. H T H T のとき  
　移動：$+2,+3,+2,+3$  
　位置：$a_1=2,\ a_2=5,\ a_3=7,\ a_4=10$  
　和：$S = 2+5+7+10 = 24$

3. H T T H のとき  
　移動：$+2,+3,+3,+2$  
　位置：$a_1=2,\ a_2=5,\ a_3=8,\ a_4=10$  
　和：$S = 2+5+8+10 = 25$

4. T H H T のとき  
　移動：$+3,+2,+2,+3$  
　位置：$a_1=3,\ a_2=5,\ a_3=7,\ a_4=10$  
　和：$S = 3+5+7+10 = 25$

5. T H T H のとき  
　移動：$+3,+2,+3,+2$  
　位置：$a_1=3,\ a_2=5,\ a_3=8,\ a_4=10$  
　和：$S = 3+5+8+10 = 26$

6. T T H H のとき  
　移動：$+3,+3,+2,+2$  
　位置：$a_1=3,\ a_2=6,\ a_3=8,\ a_4=10$  
　和：$S = 3+6+8+10 = 27$

よって，$S=25$ となるのは場合 3 と 4 の 2 通りである。

すべてのコインの出方は $2^4=16$ 通り等確率であるから，  
得点が25である確率は
$$
\frac{2}{16} = \frac{1}{8}
$$
である。

---

(3) $n=9$ の場合を考える。

(1) より
$$
a_9 = 2\cdot9 + r = 18 + r
$$
である。

### (i) 得点が100である確率

得点が0でないのは $a_9 = 2\cdot9 + 2 = 20$ のとき，すなわち $r=2$ のときに限る。  
このときの得点を $S = a_1 + a_2 + \cdots + a_9$ とする。

ここで，各回の移動量を $X_k$ とすると

- 表のとき $X_k=2$，
- 裏のとき $X_k=3$，

であり，初期位置を $a_0=0$ とおけば  
$$
a_k = X_1 + X_2 + \cdots + X_k
$$
であるから
$$
S = \sum_{k=1}^9 a_k
   = \sum_{k=1}^9 \sum_{i=1}^k X_i
$$
となる。

二重和の順序を入れ替えると
$$
\sum_{k=1}^9 \sum_{i=1}^k X_i
= \sum_{i=1}^9 \sum_{k=i}^9 X_i
= \sum_{i=1}^9 (9-i+1) X_i
= \sum_{i=1}^9 (10-i) X_i
$$
すなわち
$$
S = \sum_{i=1}^9 (10-i) X_i
$$
である。  
ここで係数 $10-i$ は
$$
9,8,7,6,5,4,3,2,1
$$
となる。したがって
$$
S = 9X_1 + 8X_2 + 7X_3 + 6X_4 + 5X_5 + 4X_6 + 3X_7 + 2X_8 + X_9
$$
と表せる。

$r=2$ であるから，9 回中 2 回だけ $X_i=3$，残り 7 回は $X_i=2$ である。  
$S$ をこの 2 回の位置により表すため，まず全て $X_i=2$ のときの和を求める。

全て $X_i=2$ とすると
$$
S_0 = 2(9 + 8 + \cdots + 1)
    = 2 \cdot \frac{9\cdot10}{2}
    = 90
$$
である。

ある位置 $i$ で $X_i$ を $2$ から $3$ に変えると，$S$ は $(10-i)$ だけ増加する。  
実際，
$$
(10-i)X_i \quad\text{が}\quad (10-i)\cdot2 \ \to\ (10-i)\cdot3
$$
となるので，差は
$$
(10-i)\cdot3 - (10-i)\cdot2 = 10-i
$$
である。

よって，2 回分の裏の位置を $i,j$（$1 \le i < j \le 9$）とすると
$$
S = S_0 + (10-i) + (10-j) = 90 + (20 - (i+j))
$$
である。したがって $S=100$ となる条件は
$$
90 + (20 - (i+j)) = 100
\quad\Longrightarrow\quad
110 - (i+j) = 100
\quad\Longrightarrow\quad
i + j = 10
$$
である。

$i<j$，$1\le i < j \le 9$ で $i+j=10$ を満たす組を全て挙げると
$$
(1,9),\ (2,8),\ (3,7),\ (4,6)
$$
の4通りである。

ゆえに，「$r=2$ かつ $S=100$」となるコインの出方は 4 通りである。  
全ての出方は $2^9=512$ 通り等確率なので，  
得点が100である確率は
$$
\frac{4}{512} = \frac{1}{128}
$$
である。

### (ii) 得点が奇数である確率

得点が0でないのは $a_9=20$ のとき，すなわち $r=2$ のときに限る。  
このとき $a_n=2n+r$ より，一般に $a_k$ は初期値0から偶数(2)または奇数(3)を足し続けた和であるから，$a_k$ の偶奇は「それまでに出た裏の回数」の偶奇と一致する。

すなわち，「$k$ 回目までに出た裏の回数を $r_k$ とすると $a_k$ は $r_k$ と同じ偶奇」をもつ。  
したがって
$$
a_k \equiv r_k \pmod{2}
$$
であり，  
$$
S = \sum_{k=1}^9 a_k
\equiv \sum_{k=1}^9 r_k \pmod{2}
$$
である。ゆえに，$S$ の偶奇は $\sum r_k$ の偶奇と一致する。

ここで，9 回のうち裏が出る 2 回の位置を $i<j$ とおくと，

- $k < i$ のとき $r_k=0$，
- $i \le k < j$ のとき $r_k=1$，
- $j \le k \le 9$ のとき $r_k=2$

であるから
$$
\sum_{k=1}^9 r_k
= 0 \cdot (i-1) + 1 \cdot (j-i) + 2 \cdot (9-j+1)
= (j-i) + 2(10-j)
$$
となる。偶奇だけ見れば
$$
\sum_{k=1}^9 r_k \equiv j - i \pmod{2}
$$
である。よって
$$
S \equiv j - i \pmod{2}
$$
が成り立つ。

したがって，得点 $S$ が奇数となる必要十分条件は
$$
j - i \equiv 1 \pmod{2}
$$
すなわち，裏が出る 2 回の位置 $i,j$ の差が奇数，換言すれば $i,j$ の偶奇が異なることである。

裏が 2 回出るときの組 $(i,j)$ は $\binom{9}{2}=36$ 通りである。  
このうち，$i$ が奇数，$j$ が偶数の組と，$i$ が偶数，$j$ が奇数の組を数える。

- 奇数位置は $\{1,3,5,7,9\}$ の 5 個
- 偶数位置は $\{2,4,6,8\}$ の 4 個

であるから，$i<j$ かどうかにかかわらず，異なる偶奇の組 $(i,j)$ の総数は
$$
5 \times 4 = 20
$$
個である。これらは全て $i\ne j$ であり，必ず一方が小さく一方が大きいので，  
「$i<j$ で偶奇が異なる」組の数も 20 通りである。

したがって，「$r=2$ かつ $S$ が奇数」となるコインの出方は 20 通りである。

全ての出方は $2^9=512$ 通りであるから，得点が奇数である確率は
$$
\frac{20}{512} = \frac{5}{128}
$$
である。