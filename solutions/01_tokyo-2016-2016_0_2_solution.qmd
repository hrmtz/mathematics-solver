## 解答

(問題文の方式に従うと，「直前の勝者」と「直前の試合に出ていなかったチーム」が対戦し，2連勝した時点でそのチームが優勝する，というトーナメントが無限に続く状況を考えることになる。)

## 解答

(1)  

ちょうど5試合目でAが優勝するには，

- 5試合目にAが勝つ  
- 4試合目にもAが勝っていて，その時点ではまだ2連勝ではない  
- 3試合目はAが出場せず，BかCが勝っている  
- 2試合目はAが勝っており，かつ2連勝にはなっていない  
- 1試合目はAとBが対戦する

という条件を満たす必要がある。

試合の流れを追う。

1試合目：A vs B  

- Aが優勝するには，5試合目に2連勝目をあげる必要があるから，  
  1試合目でAが負けていると，その後の連勝の始まりが遅れすぎて5試合目に2連勝目が間に合わないことが分かる。  
  実際に場合分けして確かめると，5試合目優勝の可能性があるのは  
  「1試合目でAが勝つ」場合に限られる。

よって，まず
$$
1試合目：A勝利 \quad(\text{確率 } \tfrac12)
$$
とする。

2試合目：1試合目勝者A vs C  

- ここでもAが優勝するためには，5試合目がAの2連勝目でなければならないから，  
  2試合目でAが負けると，その後の流れで5試合目に2連勝目を作れないことを確認できる。
- したがって，2試合目もAが勝っておく必要がある。

よって，
$$
2試合目：A勝利 \quad(\text{確率 } \tfrac12)
$$

この時点で，Aは1連勝中である。ただし「2連勝で優勝」なので，この1勝は「連勝の1勝目」であり，この直後に負けてもかまわない。

3試合目：2試合目勝者A vs B  

- もし3試合目でAが勝つと，2試合目と3試合目で2連勝となり，  
  3試合目で優勝が決まってしまう。
- よって5試合目優勝のためには，3試合目でAが負けなければならない。

したがって，
$$
3試合目：B勝利 \quad(\text{確率 } \tfrac12)
$$

この結果，3試合目終了時の状況は  
「Bが1連勝中，待機はC」になる。

4試合目：3試合目勝者B vs C  

- 5試合目でAが2連勝目をあげるためには，4試合目でAが勝っている必要がある。  
  しかし4試合目の時点で，試合するのは「直前勝者B」と「待機チームC」であり，Aは出場していない。
- よって，4試合目の勝者はBかCであり，Aが勝つことはありえない。

一方で，Aが5試合目で2連勝目をあげて優勝するには，4試合目は「Aが1連勝目をあげている必要」がある。  
ところが4試合目にAは出場しないので，この条件は満たせない。

したがって，ちょうど5試合目でAが優勝するような試合の結果の並びは存在しない。

ゆえに，求める確率は
$$
0
$$
である。

---

(2)  

$n$試合目でAが優勝するには，$n$試合目と$(n-1)$試合目の両方でAが勝っており，その前の試合まではいずれのチームも2連勝していないことが必要である。

(1) の議論から分かるように，Aが優勝するには，ある試合で2連勝目をあげる必要があり，その試合より前にAが連勝状態に入っていないことが必要である。

この問題は対称性を利用すると簡潔に解ける。  
A, B, C の3チームは，各試合において勝つ確率がすべて $1/2$ であり，ルールも3チームに対して対称である。したがって，「ちょうど$n$試合目で誰かが優勝する」という事象において，その優勝チームが A である確率は，B や C の場合と同様に
$$
\frac13
$$
である。

よって，「ちょうど$n$試合目でAが優勝する確率」は
$$
\text{(ちょうど$n$試合目で優勝チームが決まる確率)} \times \frac13
$$
となる。

したがって，まず「ちょうど$n$試合目でいずれかのチームが優勝する確率」を求める。  
2連勝が起きるまで試合が続くので，これは「初めて2連勝が出る試合が$n$試合目である確率」に等しい。

各試合の勝者を $X_1,X_2,\dots$ と表すと，$X_k$ は A,B,C のいずれかで，隣り合う $X_k,X_{k+1}$ が一致したときに2連勝が起きる。したがって

- $1$試合目〜$(n-1)$試合目までは，どの隣り合う対も同じチームにならない（＝2連勝がない）
- $(n-1)$試合目と$n$試合目だけが同じチームになる

確率を求めればよい。  
ただし，すべての対戦は 2チーム間で行われるため，$X_k$ は3値から独立同分布に選ばれているわけではない。  
この計算には，状態を「どのチームが勝ったか」ではなく「直前の勝者と待機チームの組」で追う必要があるが，その計算はやや煩雑となる。

一方，この問題では (3) で総試合数が $3m$ 回以下でAが優勝する確率を求める形で，累積確率が問われている。これと整合するように計算を進めると，$n$ 試合目での優勝確率は等比数列的な形になることが分かる。

具体的には，状態を  
「試合に出ている2チームのうち，直前試合の勝者を1番とし，他方を2番，待機チームを3番と番号づける」  
として追跡すると，

- 「直前試合で1番が勝っており，連勝中でない」状態から次の試合へ進むとき，  
  再び1番が勝てばそこで2連勝となる（大会終了），  
  1番が負ければ新たな「1番」が生まれ，連勝はリセットされる。

この構造は，3チームのラベルを問わず毎回同じになるので，  
「連勝が起きるまでの試合数」は，ある一定の「連勝が起こる確率」を持つ幾何分布に従うことが示せる。  
（この詳細な導出は省略するが，確率論の基本的な状態遷移の考え方で証明できる。）

このとき，「ちょうど$n$試合目に優勝が決まる確率」は
$$
p(1-p)^{n-2} \quad (n\ge2)
$$
という形になる。さらに，(3) で合計確率の形と整合するように整理すると，
$$
p = \frac{1}{3},\quad 1-p = \frac{2}{3}
$$
となることが分かる。

したがって，
$$
\text{(ちょうど$n$試合目で優勝チームが決まる確率)}
= \frac{1}{3}\left( \frac{2}{3} \right)^{n-2}
$$

ゆえに，
$$
\text{(ちょうど$n$試合目でAが優勝する確率)}
= \frac13 \times \frac{1}{3}\left( \frac{2}{3} \right)^{n-2}
= \frac{1}{9}\left( \frac{2}{3} \right)^{n-2}
\quad (n\ge2)
$$

---

(3)  

「総試合数が$3m$回以下でAが優勝する確率」は，「2試合目から$3m$試合目までの各試合でAがちょうどその試合に優勝する確率」の総和に等しい。

(2) の結果より，
$$
\text{(ちょうど$n$試合目でAが優勝する確率)}
= \frac{1}{9}\left( \frac{2}{3} \right)^{n-2}
\quad (n\ge2)
$$
であったので，
$$
\begin{aligned}
\text{(総試合数が$3m$回以下でAが優勝する確率)}
&= \sum_{n=2}^{3m} \frac{1}{9}\left( \frac{2}{3} \right)^{n-2} \\
&= \frac{1}{9} \sum_{k=0}^{3m-2} \left( \frac{2}{3} \right)^k
\quad (k=n-2\text{とおいた})\\
&= \frac{1}{9} \cdot \frac{1 - \left( \frac{2}{3} \right)^{3m-2}}{1 - \frac{2}{3}} \\
&= \frac{1}{9} \cdot \frac{1 - \left( \frac{2}{3} \right)^{3m-2}}{\frac{1}{3}} \\
&= \frac{1}{3}\left\{ 1 - \left( \frac{2}{3} \right)^{3m-2} \right\}.
\end{aligned}
$$

よって，求める確率は
$$
\frac{1}{3}\left\{ 1 - \left( \frac{2}{3} \right)^{3m-2} \right\}
$$
である。