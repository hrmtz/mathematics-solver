## 解答

番号札は $1,2,\dots,n$ の $n$ 枚であり，1回ごとの試行は独立に一様分布する。

和を
$$
S_k = X_1 + X_2 + \cdots + X_k
$$
とおく。ただし $X_i$ は $i$ 回目に取り出した札の数とする。

---

(1)  

$p(1)$：  
1回目でいきなり和が $n$ 以上になるには，$X_1 \geq n$ が必要である。  
札は $1,\dots,n$ なので，$X_1 = n$ のときのみであり，  
$$
p(1) = P(X_1 = n) = \frac{1}{n}
$$
となる。

$p(n)$：  
「ちょうど $n$ 回目の試行で初めて和が $n$ 以上となる」とは，  
$$
S_{n-1} \leq n-1,\quad S_n \geq n
$$
が同時に起こることである。  
しかし $S_{n-1}$ は，$n-1$ 個の整数（各 $1$ 以上）からなる和であるから
$$
S_{n-1} \geq 1+1+\cdots+1 = n-1
$$
が常に成り立つ。よって $S_{n-1} \leq n-1$ かつ $S_{n-1} \geq n$ は両立せず，
とくに  
$$
S_{n-1} \leq n-1,\; S_n \geq n
$$
を同時に満たすことはありえない。したがって
$$
p(n) = 0
$$
である。

---

(2)  

「ちょうど2回目で初めて和が $n$ 以上」とは
$$
S_1 < n,\quad S_2 \geq n
$$
である。  
$S_1 = X_1$，$S_2 = X_1 + X_2$ なので条件は
$$
X_1 \leq n-1,\quad X_1 + X_2 \geq n
$$
となる。

$X_1 = k$ とするとき，$k$ のとり得る値は $1,2,\dots,n-1$ である。  
このとき $X_2$ は $1,\dots,n$ の一様分布であり，条件 $X_1 + X_2 \geq n$ は
$$
X_2 \geq n-k
$$
となる。$X_2$ がとり得る値は $1$ から $n$ までなので，
$$
X_2 = n-k,\ n-k+1,\dots,n
$$
の $k$ 通りが条件を満たす。よって
$$
P(X_1 = k,\ X_1 + X_2 \geq n)
= \frac{1}{n} \cdot \frac{k}{n}
= \frac{k}{n^2}
$$
である。

したがって
$$
p(2)
= \sum_{k=1}^{n-1} \frac{k}{n^2}
= \frac{1}{n^2} \cdot \frac{(n-1)n}{2}
= \frac{n-1}{2n}
$$
となる。

---

(3)  

$n \geq 3$ とする。「ちょうど3回目で初めて和が $n$ 以上」とは
$$
S_2 < n,\quad S_3 \geq n
$$
である。すなわち
$$
X_1 + X_2 \leq n-1,\quad X_1 + X_2 + X_3 \geq n.
$$

ここで $Y = X_1 + X_2$ とおくと，上の条件は
$$
Y \leq n-1,\quad Y + X_3 \geq n
$$
となる。$Y$ の値によって場合分けする。

まず，$Y$ のとり得る範囲を調べる。$X_1,X_2$ はともに $1$ 以上 $n$ 以下なので
$$
2 \leq Y \leq 2n
$$
であり，さらに条件 $Y \leq n-1$ から
$$
2 \leq Y \leq n-1
$$
となる。

次に，$Y = y$ と固定すると，$X_3$ は $1,\dots,n$ の一様分布で，
条件 $Y + X_3 \geq n$ は
$$
X_3 \geq n - y
$$
である。$1 \leq X_3 \leq n$ より，$X_3$ が条件を満たす個数は
$$
n - (n-y) + 1 = y
$$
通りだから
$$
P(Y+X_3 \geq n \mid Y=y) = \frac{y}{n}
$$
である。

一方，$X_1,X_2$ は独立で一様なので
$$
P(Y=y) = \frac{\text{（$x_1+x_2=y$ となる組の数）}}{n^2}
$$
となる。

$1 \leq x_1,x_2 \leq n$ で $x_1+x_2=y$ となる組 $(x_1,x_2)$ の個数を数える。  
$2 \leq y \leq n+1$ のときは，$(1,y-1),(2,y-2),\dots,(y-1,1)$ の $y-1$ 通りである。  
$n+1 < y \leq 2n$ のときは $x_1,x_2 \geq 1$ と $x_1,x_2 \leq n$ を満たす必要があり，
個数は $2n+1-y$ 通りとなる。  
今回必要なのは $2 \leq y \leq n-1$ の範囲であり，ここでは $y \leq n+1$ なので
$$
\#\{(x_1,x_2)\mid x_1+x_2=y\} = y-1
$$
である。したがって
$$
P(Y=y) = \frac{y-1}{n^2}
\quad(2 \leq y \leq n-1)
$$
となる。

以上より
$$
\begin{aligned}
p(3)
&= \sum_{y=2}^{n-1} P(Y=y)\,P(Y+X_3 \geq n \mid Y=y) \\
&= \sum_{y=2}^{n-1} \frac{y-1}{n^2} \cdot \frac{y}{n} \\
&= \frac{1}{n^3} \sum_{y=2}^{n-1} y(y-1).
\end{aligned}
$$

ここで
$$
\sum_{y=2}^{n-1} y(y-1)
= \sum_{y=1}^{n-1} (y^2 - y)
= \sum_{y=1}^{n-1} y^2 - \sum_{y=1}^{n-1} y
$$
と変形し，和の公式
$$
\sum_{y=1}^{m} y = \frac{m(m+1)}{2},\quad
\sum_{y=1}^{m} y^2 = \frac{m(m+1)(2m+1)}{6}
$$
を用いると
$$
\sum_{y=1}^{n-1} y^2 = \frac{(n-1)n(2n-1)}{6},\quad
\sum_{y=1}^{n-1} y = \frac{(n-1)n}{2}
$$
だから
$$
\begin{aligned}
\sum_{y=2}^{n-1} y(y-1)
&= \frac{(n-1)n(2n-1)}{6} - \frac{(n-1)n}{2} \\
&= \frac{(n-1)n}{6}\bigl((2n-1) - 3\bigr) \\
&= \frac{(n-1)n}{6}\cdot 2(n-2) \\
&= \frac{(n-1)n(n-2)}{3}
\end{aligned}
$$
となる。これを $p(3)$ の式に代入して
$$
p(3)
= \frac{1}{n^3} \cdot \frac{(n-1)n(n-2)}{3}
= \frac{(n-1)(n-2)}{3n}
$$
である。

以上をまとめると
$$
p(1) = \frac{1}{n},\quad
p(2) = \frac{n-1}{2n},\quad
p(3) = \frac{(n-1)(n-2)}{3n}\quad(n \geq 3),\quad
p(n) = 0
$$
となる。