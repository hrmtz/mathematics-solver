## 解答

(1)  
B の得点が $m$ になる確率を求める。

B の得点の決まり方は次の 2 通りである。

- 1 回目に $3,4,\dots,n$ のいずれかを引いたとき：その数が得点になる。  
- 1 回目に $1$ または $2$ を引いたとき：その札を箱に戻し，2 回目に引いた札の番号がそのまま得点になる。

箱 Y には常に $1$ から $n$ までが 1 枚ずつ入っているので，  
各回において $1,2,\dots,n$ はそれぞれ確率 $\dfrac 1n$ で出る。

$m$ を $n$ 以下の自然数として場合分けする。

- $m=1$ のとき：  
  B の得点が $1$ となるには，1 回目に $1$ か $2$ を引き（確率 $\dfrac{2}{n}$），  
  2 回目に $1$ を引く（確率 $\dfrac{1}{n}$）必要がある。  
  よって  
  $$P(\text{B の得点}=1)=\frac{2}{n}\cdot\frac{1}{n}=\frac{2}{n^2}.$$

- $m=2$ のとき：  
  同様に，1 回目に $1$ か $2$ を引き（確率 $\dfrac{2}{n}$），  
  2 回目に $2$ を引く（確率 $\dfrac{1}{n}$）ので  
  $$P(\text{B の得点}=2)=\frac{2}{n}\cdot\frac{1}{n}=\frac{2}{n^2}.$$

- $m=3,4,\dots,n$ のとき：  
  2 通りの経路がある。
  1. 1 回目にちょうど $m$ を引く（確率 $\dfrac{1}{n}$）。このときそのまま得点が $m$。
  2. 1 回目に $1$ または $2$ を引き（確率 $\dfrac{2}{n}$），2 回目に $m$ を引く（確率 $\dfrac{1}{n}$）。

  したがって
  $$P(\text{B の得点}=m)
    =\frac{1}{n}+\frac{2}{n}\cdot\frac{1}{n}
    =\frac{n+2}{n^2}.$$

以上より，求める確率は

- $m=1,2$ のとき：$\displaystyle \frac{2}{n^2}$  
- $m=3,4,\dots,n$ のとき：$\displaystyle \frac{n+2}{n^2}$

である。

---

(2)  
A の得点を $a$，B の得点を $b$ とおく。  
A は箱 X から 1 回だけ引くので，各 $a=1,2,\dots,n$ について  
$$P(a=k)=\frac{1}{n}\quad(k=1,2,\dots,n).$$

(1) より，B の得点の確率分布は

- $P(b=1)=P(b=2)=\dfrac{2}{n^2}$,
- $P(b=m)=\dfrac{n+2}{n^2}\quad(m=3,4,\dots,n)$

である。

求める確率 $p_n=P(b>a)$ は，全事象を A の得点 $a$ によって分割して求めると

$$
p_n = \sum_{k=1}^{n} P(a=k) P(b>k)
    = \sum_{k=1}^{n} \frac{1}{n} P(b>k)
    = \frac{1}{n}\sum_{k=1}^{n} P(b>k)
$$

となる。したがって $P(b>k)$ を $k$ ごとに求める。

まず $k=1,2$ の場合を考える。

- $k=1$：$b>1$ とは $b=2,3,\dots,n$ を意味するから
  $$P(b>1)=1-P(b=1)=1-\frac{2}{n^2}.$$

- $k=2$：$b>2$ とは $b=3,4,\dots,n$ を意味するから
  $$P(b>2)=1-P(b=1)-P(b=2)
          =1-\frac{2}{n^2}-\frac{2}{n^2}
          =1-\frac{4}{n^2}.$$

つぎに $k\ge 3$ のとき，$b>k$ とは $b=k+1,k+2,\dots,n$ を意味し，  
それらの各値は確率 $\dfrac{n+2}{n^2}$ で起こるので

$$
P(b>k)
= (n-k)\cdot\frac{n+2}{n^2}
\quad(k=3,4,\dots,n-1).
$$

なお $k=n$ のときは $b>n$ は不可能なので $P(b>n)=0$ である。

以上を用いて

$$
\sum_{k=1}^{n} P(b>k)
= P(b>1)+P(b>2)+\sum_{k=3}^{n-1}P(b>k)+P(b>n)
$$
と分けて計算する。

まず

$$
P(b>1)+P(b>2)
= \left(1-\frac{2}{n^2}\right)+\left(1-\frac{4}{n^2}\right)
= 2-\frac{6}{n^2}.
$$

次に

$$
\sum_{k=3}^{n-1} P(b>k)
= \sum_{k=3}^{n-1} (n-k)\cdot\frac{n+2}{n^2}
= \frac{n+2}{n^2}\sum_{k=3}^{n-1}(n-k).
$$

ここで和 $\displaystyle \sum_{k=3}^{n-1}(n-k)$ を計算する。  
$k=3,4,\dots,n-1$ に対し $n-k$ は $n-3,n-4,\dots,1$ と並ぶので

$$
\sum_{k=3}^{n-1}(n-k) = 1+2+\cdots+(n-3) = \frac{(n-3)(n-2)}{2}.
$$

したがって

$$
\sum_{k=3}^{n-1} P(b>k)
= \frac{n+2}{n^2}\cdot\frac{(n-3)(n-2)}{2}.
$$

よって

$$
\sum_{k=1}^{n} P(b>k)
= 2-\frac{6}{n^2} + \frac{n+2}{n^2}\cdot\frac{(n-3)(n-2)}{2}.
$$

これを一つの分数にまとめる。まず

$$
\frac{n+2}{n^2}\cdot\frac{(n-3)(n-2)}{2}
= \frac{(n+2)(n-3)(n-2)}{2n^2}.
$$

分子を展開すると

$$
(n+2)(n-3) = n^2 - n - 6
$$

なので

$$
(n+2)(n-3)(n-2)
= (n^2 - n - 6)(n-2)
= n^3 - 3n^2 -4n + 12.
$$

したがって

$$
\sum_{k=1}^{n} P(b>k)
= 2-\frac{6}{n^2} + \frac{n^3 - 3n^2 -4n + 12}{2n^2}.
$$

右辺を通分して整理する。  
$2 = \dfrac{4n^2}{2n^2}$，$\displaystyle -\frac{6}{n^2} = -\frac{12}{2n^2}$ なので

$$
\sum_{k=1}^{n} P(b>k)
= \frac{4n^2}{2n^2} - \frac{12}{2n^2} + \frac{n^3 - 3n^2 -4n + 12}{2n^2}
= \frac{n^3 + n^2 - 4n}{2n^2}.
$$

よって

$$
p_n = \frac{1}{n}\sum_{k=1}^{n} P(b>k)
    = \frac{1}{n}\cdot\frac{n^3 + n^2 - 4n}{2n^2}
    = \frac{n^3 + n^2 - 4n}{2n^3}.
$$

分子を因数分解すると

$$
n^3 + n^2 - 4n = n(n^2 + n - 4)
$$

なので

$$
p_n = \frac{n(n^2 + n - 4)}{2n^3}
    = \frac{n^2 + n - 4}{2n^2}.
$$

したがって，A の得点より B の得点が大きくなる確率は

$$
p_n = \frac{n^2 + n - 4}{2n^2}
$$

である。