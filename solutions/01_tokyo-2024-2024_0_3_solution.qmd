## 解答

(1)  
$M$は$AP$の中点なので，  
$$
A(0,1),\ P(p,0)\ \text{より}\ 
M\left(\frac{0+p}{2},\ \frac{1+0}{2}\right)
= \left(\frac{p}{2},\ \frac{1}{2}\right)
$$
である。

角の等しさ $\angle OAP=\angle PMQ$ は，2つの角が鋭角であることに注意すると，それぞれの接線の傾きの角度が等しいことを意味する。  
すなわち，  
$$
\tan\angle OAP = \tan\angle PMQ
$$
が成り立つ。

まず直線 $AO$ と $AP$ の傾きを求める。

- $AO$：$A(0,1)$，$O(0,0)$ より，$x$座標が同じなので，$AO$は鉛直線であり，傾きは定義されない。一方，$\angle OAP$ は，頂点 $A$ における，$\overrightarrow{AO}$ から $\overrightarrow{AP}$ への「間の角度」である。

ベクトルで表すと
$$
\overrightarrow{AO} = (0-0,\ 0-1) = (0,-1),\quad
\overrightarrow{AP} = (p-0,\ 0-1) = (p,-1)
$$
であるから，2つのベクトルのなす角 $\theta$ に対して  
$$
\cos\theta
= \frac{\overrightarrow{AO}\cdot\overrightarrow{AP}}
        {|\overrightarrow{AO}||\overrightarrow{AP}|}
= \frac{(0,-1)\cdot(p,-1)}{\sqrt{0^2+(-1)^2}\sqrt{p^2+(-1)^2}}
= \frac{1}{\sqrt{p^2+1}}
$$
よって
$$
\sin^2\theta = 1-\cos^2\theta
= 1 - \frac{1}{p^2+1}
= \frac{p^2}{p^2+1}
$$
となるから
$$
\tan^2\theta = \frac{\sin^2\theta}{\cos^2\theta}
= \frac{\dfrac{p^2}{p^2+1}}{\dfrac{1}{p^2+1}}
= p^2
$$
ここで $\theta=\angle OAP$ は鋭角であり $0<\theta<\dfrac{\pi}{2}$ なので $\tan\theta>0$，したがって  
$$
\tan\angle OAP = p
$$
となる。

次に $\angle PMQ$ について考える。  
$M\left(\dfrac{p}{2},\dfrac{1}{2}\right)$，$P(p,0)$，$Q(q,0)$ より，

直線 $MP$ の傾き $a$ は
$$
a
= \frac{0-\frac{1}{2}}{p-\frac{p}{2}}
= \frac{-\frac12}{\frac{p}{2}}
= -\frac{1}{p}
$$
直線 $MQ$ の傾き $b$ は
$$
b
= \frac{0-\frac{1}{2}}{q-\frac{p}{2}}
= \frac{-\frac12}{q-\frac{p}{2}}
= -\frac{1}{2q-p}
$$
である。

2直線のなす角 $\phi=\angle PMQ$ の接線の値は，2直線の傾きを $a,b$ とするときの公式
$$
\tan\phi = \left|\frac{b-a}{1+ab}\right|
$$
により
$$
\tan\angle PMQ
= \left|\frac{-\dfrac{1}{2q-p} - \left(-\dfrac{1}{p}\right)}
              {1 + \left(-\dfrac{1}{p}\right)\left(-\dfrac{1}{2q-p}\right)}\right|
= \left|\frac{-\dfrac{1}{2q-p} + \dfrac{1}{p}}
              {1 + \dfrac{1}{p(2q-p)}}\right|
$$
と表せる。

分子・分母をそれぞれ整理する。

分子：
$$
-\frac{1}{2q-p} + \frac{1}{p}
= \frac{-p + (2q-p)}{p(2q-p)}
= \frac{2(q-p)}{p(2q-p)}
$$

分母：
$$
1 + \frac{1}{p(2q-p)}
= \frac{p(2q-p)+1}{p(2q-p)}
$$

したがって
$$
\tan\angle PMQ
= \left|\frac{\dfrac{2(q-p)}{p(2q-p)}}
              {\dfrac{p(2q-p)+1}{p(2q-p)}}\right|
= \left|\frac{2(q-p)}{p(2q-p)+1}\right|
$$

条件より $\angle PMQ$ も鋭角であり，$q>p$ より $q-p>0$ であるから，絶対値をはずして
$$
\tan\angle PMQ
= \frac{2(q-p)}{p(2q-p)+1}
$$
となる。

以上より
$$
\tan\angle OAP=\tan\angle PMQ
$$
すなわち
$$
p = \frac{2(q-p)}{p(2q-p)+1}
$$
が成り立つ。

これを $q$ について解く。両辺に分母をかけて
$$
p\bigl(p(2q-p)+1\bigr) = 2(q-p)
$$
左辺を展開して
$$
p\bigl(2pq-p^2+1\bigr) = 2q-2p
$$
$$
2p^2q - p^3 + p = 2q -2p
$$
$q$ を含む項を左辺に，その他を右辺に移して
$$
2p^2q - 2q = -2p -p + p^3
$$
$$
2q(p^2-1) = p^3 -3p
$$
ここで $0<p<1$ より $p^2-1<0$ なので $p^2\neq 1$，両辺を $2(p^2-1)$ で割ると
$$
q = \frac{p^3 -3p}{2(p^2-1)}
= \frac{p(p^2-3)}{2(p^2-1)}
$$
となる。

よって  
$$
\boxed{\,q = \dfrac{p(p^2-3)}{2(p^2-1)}\,}
$$

---

(2)  
(1) の結果を用い，$q=\dfrac13$ を代入すると
$$
\frac13 = \frac{p(p^2-3)}{2(p^2-1)}
$$
両辺を $6(p^2-1)$ 倍して
$$
2(p^2-1) = 3p(p^2-3)
$$
展開して整理すると
$$
2p^2 -2 = 3p^3 -9p
$$
$$
3p^3 -2p^2 -9p +2 =0
$$

この3次方程式を因数分解する。  
試しに $p=1$ を代入すると
$$
3-2-9+2 = -6 \neq 0
$$
$p=2$ を代入すると
$$
3\cdot 8 - 2\cdot 4 -9\cdot 2 +2 = 24-8-18+2=0
$$
よって $p=2$ は1つの解であるから，因数分解して
$$
3p^3 -2p^2 -9p +2
= (p-2)(3p^2+4p-1)
$$
と表せる。

さらに2次式を解くと
$$
3p^2+4p-1=0
$$
より
$$
p = \frac{-4\pm\sqrt{16-4\cdot 3\cdot(-1)}}{2\cdot 3}
= \frac{-4\pm\sqrt{28}}{6}
= \frac{-4\pm 2\sqrt{7}}{6}
= \frac{-2\pm\sqrt{7}}{3}
$$
したがって
$$
p = 2,\quad p = \frac{-2+\sqrt7}{3},\quad p = \frac{-2-\sqrt7}{3}
$$
が得られる。

条件より $0<p<1$ なので，  
$$
2>1\ \text{で不適},\quad
\frac{-2-\sqrt7}{3}<0\ \text{で不適}
$$
より
$$
0<p<1\ \text{を満たすのは}\ 
p=\frac{-2+\sqrt7}{3}
$$
のみである。

よって
$$
\boxed{\,p=\dfrac{-2+\sqrt7}{3}\,}
$$

---

(3)  
$\triangle OAP$ の面積 $S$ と $\triangle PMQ$ の面積 $T$ を求める。

点の座標は  
$$
O(0,0),\ A(0,1),\ P(p,0),\ M\left(\frac{p}{2},\frac12\right),\ Q(q,0)
$$
である。

まず $S$ について。  
$O(0,0)$，$A(0,1)$，$P(p,0)$ は，$OP$ を底辺としてとると，高さは $A$ の $y$ 座標である 1 なので
$$
S = \frac12 \cdot OP \cdot 1 = \frac12 \cdot |p| = \frac{p}{2}
$$
（$0<p<1$ より $|p|=p$）である。

次に $T$ について。  
$\triangle PMQ$ の頂点はすべて $x$ 軸か $y=\dfrac12$ 上にある。底辺を $PQ$ とし，高さを $M$ の $y$ 座標 $\dfrac12$ ととると，
$$
T = \frac12\cdot PQ\cdot \frac12 = \frac14\cdot |q-p| = \frac{q-p}{4}
$$
（$q>p$ より $|q-p|=q-p$）となる。

したがって
$$
S>T
\iff \frac{p}{2}>\frac{q-p}{4}
\iff 2p>q-p
\iff 3p>q
$$

ここで (1) より
$$
q = \frac{p(p^2-3)}{2(p^2-1)}
$$
を用いると
$$
3p> \frac{p(p^2-3)}{2(p^2-1)}
$$
両辺に $2(p^2-1)$ をかける。$0<p<1$ より $p^2-1<0$ なので $2(p^2-1)<0$，このとき不等号の向きを反転させる必要があることに注意する。

よって
$$
3p> \frac{p(p^2-3)}{2(p^2-1)}
\iff 3p\cdot 2(p^2-1) < p(p^2-3)
$$
左辺を展開すると
$$
6p(p^2-1) < p(p^2-3)
$$
$p>0$ より両辺を $p$ で割って
$$
6(p^2-1) < p^2-3
$$
$$
6p^2 -6 < p^2 -3
$$
$$
5p^2 -3 < 0
$$
となる。

従って
$$
5p^2 < 3
\iff p^2 < \frac{3}{5}
\iff -\sqrt{\frac35} < p < \sqrt{\frac35}
$$
だが $0<p<1$ の条件を併せると
$$
0<p<\sqrt{\frac35}
$$
となる。

よって，$S>T$ となる $p$ の範囲は
$$
\boxed{\,0<p<\sqrt{\dfrac{3}{5}}\,}
$$
である。