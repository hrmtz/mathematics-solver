## 解答

(玉の総数は常に5個で，箱の中身の構成のみが変化することに注意する。)

## 解答

(1)  
2回の試行の結果，手元に白玉が2個あるには，  
「1回目に白玉を取り出して得点（=表），2回目にも白玉を取り出して得点」  
となればよい。  

1回目に白玉を取り出す確率は  
$$
\frac{3}{5}
$$
であり，その硬貨が表となる確率は  
$$
\frac{1}{2}
$$
だから，1回目に白玉1個を手元に得る確率は  
$$
\frac{3}{5}\cdot\frac{1}{2}=\frac{3}{10}
$$
である。  

1回目に白玉が1個手元に残ったとき，箱の中身は白2個・赤2個となるから，  
2回目に白玉を取り出す確率は  
$$
\frac{2}{4}=\frac{1}{2}
$$
であり，その硬貨が表となる確率は  
$$
\frac{1}{2}
$$
なので，2回目にも白玉を1個得る確率は  
$$
\frac{1}{2}\cdot\frac{1}{2}=\frac{1}{4}
$$
である。  

したがって，求める確率は  
$$
\frac{3}{10}\cdot\frac{1}{4}=\frac{3}{40}
$$
である。

---

(2)  
3回の試行後に，手元が「白1個・赤1個，計2個」となる確率を求める。

手元に玉が増えるのは，「取り出した玉が表になったとき」のみである。  
3回の試行後に手元に2個であるから，「表が出た回数」は2回で，「裏が出た回数」は1回である。また，白1個・赤1個なので，「表が出た2回のうち1回は白，もう1回は赤」である。  

3回のうち2回で表，1回で裏であり，かつ白1個・赤1個を得る。これを順に追うと計算が煩雑になるので，状態遷移を整理して考える。

### 状態の表現
手元にある白玉の個数を $w$，赤玉の個数を $r$ とし，状態を $(w,r)$ で表す。  
初期状態は $(0,0)$ であり，最終的に $(1,1)$ に到達し，かつ試行回数が3回である場合の確率を求める。

3回で $(1,1)$ となるには，「ちょうど2回得点し，1回は白，1回は赤」であればよいので，  
列挙した方が短い。3回の中で「白を得る回」「赤を得る回」「裏の回」の順序を並べると

- WRU（白→赤→裏）
- WUR（白→裏→赤）
- R WU（赤→白→裏）
- R U W（赤→裏→白）
- U W R（裏→白→赤）
- U R W（裏→赤→白）

の6通りがある。ここで W：白を得る，R：赤を得る，U：裏（得点なし）を表す。

それぞれの順序ごとに条件付き確率を計算し，最後に足し合わせる。

#### 1) WRU（白→赤→裏）

1回目：白を得る  
- 白を引く確率 $\;3/5$，表が出る確率 $\;1/2$  
$$
P(\text{W}_1)=\frac{3}{5}\cdot\frac{1}{2}=\frac{3}{10}
$$
手元 $(1,0)$，箱：白2，赤2。

2回目：赤を得る  
箱は白2，赤2 より，赤を引く確率 $2/4=1/2$，表が出る確率 $1/2$  
$$
P(\text{R}_2\mid \text{W}_1)=\frac{1}{2}\cdot\frac{1}{2}=\frac{1}{4}
$$
手元 $(1,1)$，箱：白2，赤1。

3回目：裏  
箱は白2，赤1 で，玉の色は何でもよいが，硬貨が裏であればよい。  
玉を引く確率は1（必ず何か引く），裏の確率は $1/2$ なので，
$$
P(\text{U}_3\mid \text{W}_1,\text{R}_2)=\frac{1}{2}
$$

したがって
$$
P(\text{WRU})=\frac{3}{10}\cdot\frac{1}{4}\cdot\frac{1}{2}=\frac{3}{80}
$$

#### 2) WUR（白→裏→赤）

1回目：白を得る確率は上と同じで $3/10$。  
手元 $(1,0)$，箱：白2，赤2。

2回目：裏  
箱は白2，赤2，玉の色は何でもよく，裏の確率 $1/2$。
$$
P(\text{U}_2\mid \text{W}_1)=\frac{1}{2}
$$
（引いた玉は箱に戻すので，箱の中身は再び白2，赤2 のまま。）

3回目：赤を得る  
箱は白2，赤2 なので，赤を引く確率 $2/4=1/2$，表の確率 $1/2$。
$$
P(\text{R}_3\mid \text{W}_1,\text{U}_2)=\frac{1}{2}\cdot\frac{1}{2}=\frac{1}{4}
$$

したがって
$$
P(\text{WUR})=\frac{3}{10}\cdot\frac{1}{2}\cdot\frac{1}{4}=\frac{3}{80}
$$

#### 3) RWU（赤→白→裏）

1回目：赤を得る  
赤を引く確率 $2/5$，表 $1/2$ より
$$
P(\text{R}_1)=\frac{2}{5}\cdot\frac{1}{2}=\frac{1}{5}
$$
手元 $(0,1)$，箱：白3，赤1。

2回目：白を得る  
箱は白3，赤1 なので，白を引く確率 $3/4$，表の確率 $1/2$。
$$
P(\text{W}_2\mid \text{R}_1)=\frac{3}{4}\cdot\frac{1}{2}=\frac{3}{8}
$$
手元 $(1,1)$，箱：白2，赤1。

3回目：裏  
箱は白2，赤1，裏の確率 $1/2$。
$$
P(\text{U}_3\mid \text{R}_1,\text{W}_2)=\frac{1}{2}
$$

よって
$$
P(\text{RWU})=\frac{1}{5}\cdot\frac{3}{8}\cdot\frac{1}{2}=\frac{3}{80}
$$

#### 4) RUW（赤→裏→白）

1回目：赤を得る確率は $1/5$（上と同じ）。  
手元 $(0,1)$，箱：白3，赤1。

2回目：裏  
箱は白3，赤1。玉の色は問わないので裏の確率 $1/2$。
$$
P(\text{U}_2\mid \text{R}_1)=\frac{1}{2}
$$
（箱は再び白3，赤1。）

3回目：白を得る  
箱は白3，赤1なので，白を引く確率 $3/4$，表 $1/2$。
$$
P(\text{W}_3\mid \text{R}_1,\text{U}_2)=\frac{3}{4}\cdot\frac{1}{2}=\frac{3}{8}
$$

したがって
$$
P(\text{RUW})=\frac{1}{5}\cdot\frac{1}{2}\cdot\frac{3}{8}=\frac{3}{80}
$$

#### 5) UWR（裏→白→赤）

1回目：裏  
箱は白3，赤2，玉の色は問わないので裏の確率 $1/2$。
$$
P(\text{U}_1)=\frac{1}{2}
$$
箱はそのまま白3，赤2。

2回目：白を得る  
白を引く確率 $3/5$，表 $1/2$。
$$
P(\text{W}_2\mid \text{U}_1)=\frac{3}{5}\cdot\frac{1}{2}=\frac{3}{10}
$$
手元 $(1,0)$，箱：白2，赤2。

3回目：赤を得る  
箱は白2，赤2 なので，赤 $1/2$，表 $1/2$。
$$
P(\text{R}_3\mid \text{U}_1,\text{W}_2)=\frac{1}{2}\cdot\frac{1}{2}=\frac{1}{4}
$$

よって
$$
P(\text{UWR})=\frac{1}{2}\cdot\frac{3}{10}\cdot\frac{1}{4}=\frac{3}{80}
$$

#### 6) URW（裏→赤→白）

1回目：裏の確率は $1/2$（上と同じ）。  
箱：白3，赤2。

2回目：赤を得る  
赤 $2/5$，表 $1/2$。
$$
P(\text{R}_2\mid \text{U}_1)=\frac{2}{5}\cdot\frac{1}{2}=\frac{1}{5}
$$
手元 $(0,1)$，箱：白3，赤1。

3回目：白を得る  
箱は白3，赤1 なので，白 $3/4$，表 $1/2$。
$$
P(\text{W}_3\mid \text{U}_1,\text{R}_2)=\frac{3}{4}\cdot\frac{1}{2}=\frac{3}{8}
$$

したがって
$$
P(\text{URW})=\frac{1}{2}\cdot\frac{1}{5}\cdot\frac{3}{8}=\frac{3}{80}
$$

### 合計

いずれの場合も確率は $\dfrac{3}{80}$ で，6通りあるから，求める確率は
$$
6\cdot\frac{3}{80}=\frac{18}{80}=\frac{9}{40}
$$
である。

---

(3)  
「ちょうど $n$ 回目で試行が停止する」とは，$n-1$ 回目までに箱の中の白3個・赤2個がすべて手元に移り（表で出尽くし），$n$ 回目に箱の中に玉が1個もないので，必然的に試行が行われない，という意味である。  
したがって，停止する条件は  
「白が3回表，赤が2回表となる」ということであり，これは「表が出た回数がちょうど5回で，そのうち白3回・赤2回」であることに等しい。  

箱からの取り出しは無作為であり，表が出て箱から除かれていくため，5回の得点（表）で最終的に白3個・赤2個が全て出る確率は1（必ずそうなる）。  
よって問題は，「$n$ 回の試行のうち表がちょうど5回出る確率」を求める問題に帰着する。

1回の試行で表が出る確率は常に $1/2$，裏も $1/2$ である。  
$n$ 回のうち表が5回，裏が $n-5$ 回である確率は，二項分布より
$$
p_n={}_n\mathrm{C}_5\left(\frac{1}{2}\right)^5\left(\frac{1}{2}\right)^{n-5}
={}_n\mathrm{C}_5\left(\frac{1}{2}\right)^n
$$
となる。ただし，$n\geq5$ である。

---

(4)  
(3)より
$$
p_n={}_n\mathrm{C}_5\left(\frac{1}{2}\right)^n
$$
であり，$n\geq5$ の整数についてこれが最大となる $n$ を求める。

$\left(\dfrac{1}{2}\right)^n$ は $n$ が大きくなるほど単調に減少する。一方，${}_n\mathrm{C}_5$ は $n$ とともに増加するが，その増加はやがて $\left(\dfrac{1}{2}\right)^n$ の減少に打ち消されて，$p_n$ はどこかで最大となる。

隣り合う項の比を調べる。  
$n\geq5$ として
$$
\frac{p_{n+1}}{p_n}
=\frac{{}_{n+1}\mathrm{C}_5}{2^{n+1}}\cdot\frac{2^n}{{}_n\mathrm{C}_5}
=\frac{{}_{n+1}\mathrm{C}_5}{{}_n\mathrm{C}_5}\cdot\frac{1}{2}
$$
である。  
組合せの公式
$$
{}_{n+1}\mathrm{C}_5=\frac{n+1}{n+1-5}\,{}_n\mathrm{C}_5
=\frac{n+1}{n-4}\,{}_n\mathrm{C}_5
$$
を用いると
$$
\frac{p_{n+1}}{p_n}
=\frac{n+1}{n-4}\cdot\frac{1}{2}
=\frac{n+1}{2(n-4)}
$$
となる。

これが1より大きいときは $p_{n+1}>p_n$，1より小さいときは $p_{n+1}<p_n$ であるから，
$$
\frac{n+1}{2(n-4)}\gtrless1
\quad\Longleftrightarrow\quad
n+1\gtrless2n-8
\quad\Longleftrightarrow\quad
9\gtrless n
$$
となる。  
したがって

- $n<9$ のときは $\dfrac{p_{n+1}}{p_n}>1$，すなわち $p_n$ は増加
- $n>9$ のときは $\dfrac{p_{n+1}}{p_n}<1$，すなわち $p_n$ は減少

となる。よって $n=9$ のとき $p_n$ は最大である。

以上より，$p_n$ が最大となる $n$ は
$$
n=9
$$
である。