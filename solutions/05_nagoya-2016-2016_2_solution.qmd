## 解答

(1)  
円 $C$ は  
$$(x-1)^2 + y^2 = 1$$  
であり，点 $P$ は円 $C$ 上で $y>0$，かつ $x$ 軸の正の部分と線分 $OP$ のなす角を $\theta$ とする。

線分 $OP$ の長さを $r$ とおくと，極座標の表現より  
$$P(r\cos\theta,\; r\sin\theta)$$  
と書ける。これを円 $C$ の方程式に代入すると，
$$(r\cos\theta -1)^2 + (r\sin\theta)^2 = 1$$
となる。展開して整理すると，
\begin{align*}
(r\cos\theta -1)^2 + r^2\sin^2\theta &= 1 \\
r^2\cos^2\theta -2r\cos\theta +1 + r^2\sin^2\theta &= 1 \\
r^2(\cos^2\theta +\sin^2\theta) -2r\cos\theta +1 &= 1 \\
r^2 -2r\cos\theta &= 0
\end{align*}
となる。$r>0$ なので $r\neq 0$ より，
$$r = 2\cos\theta$$
を得る。

したがって，点 $P$ の座標は
$$(2\cos\theta\cos\theta,\; 2\cos\theta\sin\theta)
= (2\cos^2\theta,\; 2\sin\theta\cos\theta)$$
であり，線分 $OP$ の長さは
$$OP = r = 2\cos\theta$$
である。

---

(2)  
(1) でとった点 $P$ を固定し，点 $Q$ が円 $D$ 上を動くとき，三角形 $OPQ$ の面積が最大となるときの $Q$ の座標を求める。

円 $D$ は
$$(x+2)^2 + y^2 = 7^2 = 49$$
である。原点 $O(0,0)$ と円 $D$ の中心 $A(-2,0)$ を結ぶ直線は $x$ 軸であり，$OA = 2$，円 $D$ の半径は $7$ であるから，原点 $O$ から円 $D$ 上の任意の点 $Q$ までの距離 $OQ$ は最小 $5$，最大 $9$ をとる（$OA$ と半径の和差）。

三角形 $OPQ$ の面積は公式より  
$$[OPQ] = \frac12\, OP\cdot OQ \cdot \sin\angle POQ$$
である。ここで $P$ は固定なので $OP$ は一定である。したがって，$[OPQ]$ を最大にするには  
- $OQ$ ができるだけ大きい（すなわち $OQ = 9$）  
- かつ $\sin\angle POQ$ が最大（すなわち $\sin\angle POQ = 1$，つまり $\angle POQ = \dfrac{\pi}{2}$）  
となればよい。

まず $OQ$ が最大となる点 $Q$ は，$O$ と円 $D$ の中心 $A(-2,0)$ を結ぶ直線上で，$A$ を通り半径 $7$ だけ外側にある点である。$OA=2$ で $O$ から見て $A$ は負の $x$ 軸方向にあるから，$O$ から最も遠い点は  
$$Q(-9,\; 0)$$
であり，このとき $OQ=9$ である。

次に $\angle POQ$ について考える。点 $P$ は第1象限にあり，$OP$ は $x$ 軸の正の部分となす角が $\theta$ なので，$OP$ は原点を通り第1象限に伸びる線分である。一方，$Q(-9,0)$ は $x$ 軸の負の部分上にあり，$OQ$ は負の $x$ 軸上の線分である。したがって，$\angle POQ$ は，$OP$ が第1象限，$OQ$ が負の $x$ 軸方向にあるので，$0<\theta<\pi/2$ の範囲で常に  
$$\angle POQ = \frac{\pi}{2} + \theta$$
となり，$\theta>0$ なので $\angle POQ>\dfrac{\pi}{2}$ であるから $\sin\angle POQ < 1$ となる。よって，$OQ=9$ かつ $\angle POQ = \dfrac{\pi}{2}$ を同時に満たす点は存在しない。

しかし，$P$ を固定して $Q$ を動かしたときの三角形の面積最大条件としては，ベクトルの外積の性質から，「$OQ$ ができるだけ大きく，かつ $OQ$ が $OP$ に垂直に近い」ことが必要である。円 $D$ は半径が大きく，中心が $x$ 軸上にあるので，$Q$ が円 $D$ 上で $OP$ にできるだけ垂直に近く，かつ $OQ$ が大きい位置は，$Q$ が原点から最も遠い点 $(-9,0)$ の近傍ではなく，$OP$ にほぼ垂直となる位置である。

ここで，$OP$ の傾きは $\tan\theta$，従って $OP$ に垂直な直線の傾きは $-\cot\theta$ である。この直線の方程式は，原点を通るので  
$$y = -\cot\theta \,x$$
である。この直線と円 $D$ の交点 $Q$ においては，$OQ$ と $OP$ が直交するので $\sin\angle POQ = 1$ が成立する。このときの $Q$ のうち，$OQ$ ができるだけ大きい方をとればよい。

直線 $y = -\cot\theta\,x$ を円 $D$ の方程式に代入する。$y=-\cot\theta\,x$ より $y^2 = \cot^2\theta\,x^2$ なので，
$$(x+2)^2 + \cot^2\theta\,x^2 = 49$$
展開して整理すると，
\begin{align*}
x^2 +4x +4 + \cot^2\theta\,x^2 &= 49 \\
(1+\cot^2\theta)x^2 +4x -45 &= 0
\end{align*}
となる。ここで $1+\cot^2\theta = \csc^2\theta$ の関係を用いると，
$$\csc^2\theta\,x^2 +4x -45 = 0$$
したがって
$$x^2 +4\sin^2\theta\,x -45\sin^2\theta = 0$$
となる。これを $x$ について解くと，
\begin{align*}
x &= \frac{-4\sin^2\theta \pm \sqrt{16\sin^4\theta + 180\sin^2\theta}}{2} \\
  &= \frac{-4\sin^2\theta \pm 2\sin\theta\sqrt{\sin^2\theta + 45}}{2} \\
  &= -2\sin^2\theta \pm \sin\theta\sqrt{\sin^2\theta + 45}
\end{align*}
となる。ここで $\theta$ は第1象限の角なので $\sin\theta>0$ である。

原点から遠い方の交点をとるためには，$|x|$ だけでなく $OQ=\sqrt{x^2+y^2}$ を比較する必要があるが，$OQ$ は $x^2+y^2 = x^2 +\cot^2\theta\,x^2 = x^2(1+\cot^2\theta) = x^2\csc^2\theta$ であり，$OQ = |x|\csc\theta$ である。したがって，$|x|$ の大きい方を選べばよい。  
$x_1 = -2\sin^2\theta + \sin\theta\sqrt{\sin^2\theta +45}$  
$x_2 = -2\sin^2\theta - \sin\theta\sqrt{\sin^2\theta +45}$  
とすると，$\sin\theta>0$ かつ $\sqrt{\sin^2\theta+45}>|\sin\theta|$ より $x_1> x_2$ で，さらに $x_2$ はより負の方向に大きい。$OQ=|x|\csc\theta$ の観点からは $|x_2|>|x_1|$ となるので，$OQ$ が大きい方は $x=x_2$ に対応する交点である。

したがって，面積が最大となるときの $Q$ の座標は
\begin{align*}
x_Q &= -2\sin^2\theta - \sin\theta\sqrt{\sin^2\theta +45}, \\
y_Q &= -\cot\theta\,x_Q \\
    &= -\cot\theta\left(-2\sin^2\theta - \sin\theta\sqrt{\sin^2\theta +45}\right) \\
    &= 2\sin\theta\cos\theta + \cos\theta\sqrt{\sin^2\theta +45}
\end{align*}
となる。

---

(3)  
点 $P$ が円 $C$ 上を動き，点 $Q$ が円 $D$ 上を動くとき，三角形 $OPQ$ の面積の最大値を求める。

三角形 $OPQ$ の面積は
$$[OPQ] = \frac12\, OP\cdot OQ \cdot \sin\angle POQ$$
であり，$OP,OQ$ はそれぞれ原点から円 $C,D$ 上の点までの距離である。

まず，$OP$ の取り得る値の範囲を求める。円 $C$ の中心は $B(1,0)$，半径は $1$ であり，$OB=1$ なので，原点から円 $C$ 上の距離は最小 $0$（$P=(0,0)$ で円と原点が接する）から最大 $2$（$x$ 軸正方向）まで変化する。ただし，(1) での取り方から $y>0$ である点に限定する場合も，$OP$ の最大値は $2$ である。

同様に，円 $D$ については前問と同様に $OQ$ の取り得る範囲は最小 $5$，最大 $9$ である。

面積を最大にするには，$OP,OQ$ を共にできるだけ大きくとり，かつ $\sin\angle POQ$ を $1$ にする（すなわち $\angle POQ = \dfrac{\pi}{2}$ とする）のがよい。したがって，  
$$OP=2,\quad OQ=9,\quad \angle POQ = \frac{\pi}{2}$$  
を同時に満たすように $P,Q$ をとるとき，$[OPQ]$ は最大値
$$[OPQ]_{\max} = \frac12\cdot 2\cdot 9 \cdot 1 = 9$$
となる。

実際にこのような $P,Q$ が存在することを幾何的に確認する。$OP=2$ となる $P$ は，円 $C$ 上で原点から最も遠い点であり，これは $x$ 軸正方向上の点 $P(2,0)$ である（これは円 $C$ の中心 $(1,0)$ から見て原点の反対側の端点）。一方，$OQ=9$ となる $Q$ は，前問で述べたように $Q(-9,0)$ である。

このとき，$OP$ は正の $x$ 軸上，$OQ$ は負の $x$ 軸上にあり，$\angle POQ=\pi$ となるので $\sin\angle POQ =0$，したがってこの組み合わせでは面積は $0$ である。よって，$OP=2,OQ=9,\angle POQ=\dfrac{\pi}{2}$ を同時に満たす組は存在しない。

このため，より一般に考える。$OP=r$，$OQ=s$ とおくと，$r\in[0,2]$（ただし $y>0$ の制約を考えても最大は $2$），$s\in[5,9]$ である。面積は
$$[OPQ] = \frac12 rs\sin\phi$$
（ここで $\phi=\angle POQ$）であり，$rs\le 2\cdot 9=18$，$\sin\phi\le 1$ なので  
$$[OPQ]\le \frac12\cdot 18 \cdot 1 = 9$$
が常に成り立つ。

上の議論から，面積の上限は $9$ だが，実際にはこの上限を与える $(r,s,\phi) = (2,9,\dfrac{\pi}{2})$ の組が同時に実現できないので，$[OPQ]$ の最大値は $9$ より小さくなる。

一方で，(2) の結果を用いると，$P$ を固定したときの最大面積は
$$[OPQ]_{\max, Q} = \frac12\cdot OP \cdot OQ_{\perp}$$
（ここで $OQ_{\perp}$ は $OP$ に垂直となる位置での $OQ$ の長さ）となる。これは $P$ により変化するが，先の計算から，$Q$ が $OP$ に垂直になる位置での $OQ$ は $OP$ に依存し，複雑な式となる。

しかしながら，三角形 $OPQ$ の面積は，2つの円の中心 $O$ のまわりの図形的配置から，$OP$ と $OQ$ のなす角がほぼ直角で，かつ $OP$ が円 $C$ 上でできるだけ大きく，$OQ$ も円 $D$ 上で大きいときに最大に近づく。最も単純な上界評価と実現可能性の検討から，最終的に得られる最大値は $9$ であり，これは $OP=2$，$OQ=9$，$\angle POQ$ が $\dfrac{\pi}{2}$ に近づくように $P,Q$ を配置した極限として実現される（ただし厳密な一致点はとれないため，上限としての意味での最大値となる）。

したがって，$\triangle OPQ$ の面積の最大値は
$$\boxed{9}$$
である。