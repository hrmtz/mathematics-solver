## 解答

(1)  

さいころの出る目は $1,2,3,4,5,6$ のいずれかであり，これらの最大公約数が $3$ になるための条件を考える。

まず，「最大公約数が $3$」であるためには

- すべての $X_i$ が $3$ の倍数であり（でないと公約数 $3$ をもたない），
- すべての $X_i$ が $3$ の倍数である整数の最大公約数が $3$ であること

が必要である。

1 回の試行で $3$ の倍数（$3$ または $6$）が出る確率は $2/6=1/3$ であるから，
$n$ 回すべてで $3$ の倍数が出る確率は

$$
\left(\frac{1}{3}\right)^n
$$

である。よって，考えられる列 $(X_1,\dots,X_n)$ は，各 $X_i$ が $3$ または $6$ のみをとる列，すなわち $2^n$ 通りであり，そのうち，最大公約数が $3$ となる列の個数を数える。

ここで，$X_i=3Y_i$ とおくと $Y_i$ はそれぞれ $1$ または $2$ である。  
このとき，$\gcd(X_1,\dots,X_n)=3$ であることと $\gcd(Y_1,\dots,Y_n)=1$ であることは同値である（公約数を $3$ で割ったものが $Y_i$ の公約数になるから）。

したがって，$Y_i$ がすべて $1$ または $2$ の列で，$\gcd(Y_1,\dots,Y_n)=1$ である列の数を求めればよい。

しかし，$Y_i$ がすべて $1$ または $2$ のとき，その最大公約数が $2$ となるのはすべてが $2$ のときだけであり，それ以外（少なくとも 1 つは $1$ を含むとき）は最大公約数は $1$ である。  
全体は $2^n$ 通りで，すべて $2$ である列は 1 通りなので，

- $\gcd(Y_1,\dots,Y_n)=2$ となる列：$1$ 通り
- $\gcd(Y_1,\dots,Y_n)=1$ となる列：$2^n - 1$ 通り

である。

よって，求める確率は

$$
\frac{2^n - 1}{\text{全事象の数 }6^n}
= \frac{2^n - 1}{6^n}
$$

となる。

---

(2)  

$X_1,\dots,X_n$ の最大公約数が $1$ となる確率を求める。  
補集合（最大公約数が $1$ でない場合）を考え，それを $1$ から引く。

「最大公約数が $1$ でない」とは，ある $2$ 以上の整数 $d$ が全ての $X_i$ の公約数であること，すなわち「すべての $X_i$ が $d$ の倍数であること」と同値である。

さいころの出る目は $1,2,3,4,5,6$ であるから，$2$ 以上の整数 $d$ で，この中に倍数をもつものは

$$
d = 2,\ 3,\ 4,\ 5,\ 6
$$

である。  
したがって，「最大公約数が $1$ でない」とは，「すべての $X_i$ が $2$ の倍数である」または「すべての $X_i$ が $3$ の倍数である」…などのいずれかが成り立つことである。  
ただし，ここでは「最大公約数が $d$」ではなく「すべての $X_i$ が $d$ の倍数」であり，条件は重なりうるので注意が必要である。

まず，$n$ 回の試行で，すべての $X_i$ が $2$ の倍数（$2,4,6$）となる確率は  
1 回あたり $2$ の倍数が出る確率が $3/6=1/2$ であるから，

$$
P(\text{すべて偶数}) = \left(\frac{1}{2}\right)^n
$$

同様に，

- $3$ の倍数（$3,6$）のみ：確率 $\left(\dfrac{1}{3}\right)^n$
- $4$ の倍数（$4$ のみ）：確率 $\left(\dfrac{1}{6}\right)^n$
- $5$ の倍数（$5$ のみ）：確率 $\left(\dfrac{1}{6}\right)^n$
- $6$ の倍数（$6$ のみ）：確率 $\left(\dfrac{1}{6}\right)^n$

である。

しかし，これらを単純に足すと，例えば「すべて $6$ の倍数」である場合が重複して数えられる。  
ここで，最大公約数が $1$ でない場合としてありうる最大公約数を直接分類する方が簡単である。

実際に，$1,2,3,4,5,6$ の列の最大公約数が $1$ でないとき，  
可能な最大公約数は

$$
2,\ 3,\ 4,\ 5,\ 6
$$

である（$>6$ はありえない）。  
これらについて「最大公約数がちょうど $d$」となる確率を求め，和をとる。

(i) $\gcd=2$ となる確率  

すべての $X_i$ が偶数（$2,4,6$）であり，しかも最大公約数が $2$ である。  
「すべて偶数」のもとで $X_i = 2Y_i$ とおくと，$Y_i$ は $1,2,3$ のいずれかで，  
$\gcd(X_1,\dots,X_n)=2$ と $\gcd(Y_1,\dots,Y_n)=1$ は同値である。

$Y_i$ が $1,2,3$ をとる全事象は $3^n$ 通りである。  
ここで「$\gcd(Y_1,\dots,Y_n)>1$」は「すべての $Y_i$ が偶数（$2$）」または「すべての $Y_i$ が $3$ の倍数（$3$）」であることで，  
それぞれ 1 通りなので，

- $\gcd(Y_1,\dots,Y_n)>1$ の場合：$2$ 通り
- $\gcd(Y_1,\dots,Y_n)=1$ の場合：$3^n - 2$ 通り

である。したがって，「すべて偶数」の場合のうち，$\gcd=2$ となる確率（条件付き確率）は

$$
\frac{3^n - 2}{3^n}
$$

である。  
「すべて偶数」である確率は $(1/2)^n$ なので，

$$
P(\gcd=2) = \left(\frac{1}{2}\right)^n \cdot \frac{3^n - 2}{3^n}
= \frac{3^n - 2}{6^n}
$$

(ii) $\gcd=3$ となる確率  

(1) で求めた結果より，これは

$$
P(\gcd=3) = \frac{2^n - 1}{6^n}
$$

である。

(iii) $\gcd=4$ となる確率  

すべての $X_i$ が $4$ の倍数である必要があるが，さいころの目で $4$ の倍数は $4$ のみなので，  
$X_1=\dots=X_n=4$ の場合のみである。したがって

$$
P(\gcd=4) = \left(\frac{1}{6}\right)^n
$$

(iv) $\gcd=5$ となる確率  

同様に，$5$ の倍数は $5$ のみなので，すべて $5$ のときのみである：

$$
P(\gcd=5) = \left(\frac{1}{6}\right)^n
$$

(v) $\gcd=6$ となる確率  

$6$ の倍数は $6$ のみなので，

$$
P(\gcd=6) = \left(\frac{1}{6}\right)^n
$$

よって，「最大公約数が $1$ でない」確率は

$$
P(\gcd \neq 1)
= P(\gcd=2) + P(\gcd=3) + P(\gcd=4) + P(\gcd=5) + P(\gcd=6)
$$

$$
= \frac{3^n - 2}{6^n} + \frac{2^n - 1}{6^n} + 3\left(\frac{1}{6}\right)^n
= \frac{3^n + 2^n - 3}{6^n} + \frac{3}{6^n}
= \frac{3^n + 2^n}{6^n}
$$

したがって，求める確率（最大公約数が $1$ となる確率）は

$$
P(\gcd=1) = 1 - P(\gcd\neq 1)
= 1 - \frac{3^n + 2^n}{6^n}
= \frac{6^n - 3^n - 2^n}{6^n}
$$

となる。

---

(3)  

$X_1,\dots,X_n$ の最小公倍数が $20$ となる確率を求める。  
$20$ の素因数分解は $20=2^2\cdot 5$ である。

最小公倍数が $20$ となるための必要十分条件は，

1. すべての $X_i$ が $20$ の約数である（でないと最小公倍数が $20$ を超える）。
2. 少なくとも 1 つの $X_i$ が $4$ の倍数（$2^2$ を含む）。
3. 少なくとも 1 つの $X_i$ が $5$ の倍数（$5^1$ を含む）。

である。  
さいころの目 $1,2,3,4,5,6$ のうち，$20$ の約数（$1,2,4,5$）のみをとる必要があるので，  
確率計算は「各試行で $1,2,4,5$ のいずれかが出る事象」に制限して行う。

1 回の試行で $1,2,4,5$ のいずれかが出る確率は $\dfrac{4}{6}=\dfrac{2}{3}$ であり，  
$n$ 回すべてでこの範囲の目が出る確率は

$$
\left(\frac{2}{3}\right)^n
$$

である。このとき，$X_i$ の取りうる値は $1,2,4,5$ で，各 $X_i$ は等確率で選ばれる。

この制限された状況で，「少なくとも 1 つが $4$ で，かつ少なくとも 1 つが $5$」となる確率を求める。  
これを $A$：「少なくとも 1 つが $4$」，$B$：「少なくとも 1 つが $5$」として

$$
P(A\cap B) = 1 - P(A^c \cup B^c)
= 1 - \{P(A^c) + P(B^c) - P(A^c \cap B^c)\}
$$

と求める。（ド・モルガンの法則と包除原理を用いた。）

ここで，制限された事象（全て $1,2,4,5$）のもとでの条件付き確率を考える。  
$1,2,4,5$ はいずれも等確率なので，

- $4$ が出ない（$A^c$）とは，各試行が $1,2,5$ のいずれかであることであり，1 回あたりの確率は $3/4$。  
  よって

  $$
  P(A^c \mid \text{制限}) = \left(\frac{3}{4}\right)^n
  $$

- $5$ が出ない（$B^c$）も同様に，1 回あたりの確率は $3/4$ で

  $$
  P(B^c \mid \text{制限}) = \left(\frac{3}{4}\right)^n
  $$

- $4$ も $5$ も出ない（$A^c\cap B^c$）とは，各試行が $1$ か $2$ のみであることであり，1 回あたりの確率は $2/4=1/2$。  
  よって

  $$
  P(A^c \cap B^c \mid \text{制限}) = \left(\frac{1}{2}\right)^n
  $$

したがって，

$$
P(A\cap B \mid \text{制限})
= 1 - \left\{\left(\frac{3}{4}\right)^n + \left(\frac{3}{4}\right)^n - \left(\frac{1}{2}\right)^n \right\}
= 1 - 2\left(\frac{3}{4}\right)^n + \left(\frac{1}{2}\right)^n
$$

よって，求める確率は

$$
P(\text{lcm}=20)
= P(\text{制限}) \cdot P(A\cap B \mid \text{制限})
$$

$$
= \left(\frac{2}{3}\right)^n \left\{1 - 2\left(\frac{3}{4}\right)^n + \left(\frac{1}{2}\right)^n \right\}
$$

これをそのまま答えとしてよい。  
一応，分母をそろえて整理すると，

$$
\left(\frac{2}{3}\right)^n - 2\left(\frac{1}{2}\right)^n + \left(\frac{1}{3}\right)^n
= \frac{2^n}{3^n} - \frac{2^{n+1}}{2^n\cdot 3^n} + \frac{3^n}{3^n\cdot 3^n}
= \frac{4^n - 2^{n+1} + 3^n}{3^n \cdot 2^n}
= \frac{4^n - 2^{n+1} + 3^n}{6^n}
$$

となるので，別解答として

$$
\frac{4^n - 2^{n+1} + 3^n}{6^n}
$$

とも表せる。

まとめると，

(1) $\displaystyle \frac{2^n - 1}{6^n}$  

(2) $\displaystyle \frac{6^n - 3^n - 2^n}{6^n}$  

(3) $\displaystyle \left(\frac{2}{3}\right)^n \left\{1 - 2\left(\frac{3}{4}\right)^n + \left(\frac{1}{2}\right)^n \right\} \quad \left(= \dfrac{4^n - 2^{n+1} + 3^n}{6^n}\right)$