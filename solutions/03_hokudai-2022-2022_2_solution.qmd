## 解答

(ベクトルは成分表示を用いる。)

## 解答

(1)  
$\overrightarrow{P_nP_{n+1}}=(1-a)\overrightarrow{P_nQ_n}$ より，
$$
\overrightarrow{P_nQ_n}
=\frac{1}{1-a}\overrightarrow{P_nP_{n+1}}
=\frac{1}{1-a}\bigl( (x_{n+1}-x_n,\; y_{n+1}-y_n) \bigr)
$$
である。

また，$\overrightarrow{Q_nQ_{n+1}}=\left( 0,\; \dfrac{a^{-n}}{1-a} \right)$ であるから，
$$
\overrightarrow{P_nQ_{n+1}}
=\overrightarrow{P_nQ_n}+\overrightarrow{Q_nQ_{n+1}}
=\left( \frac{x_{n+1}-x_n}{1-a},\; \frac{y_{n+1}-y_n}{1-a}+\frac{a^{-n}}{1-a} \right)
$$
となる。

一方，$\overrightarrow{P_{n+1}P_{n+2}}=(1-a)\overrightarrow{P_{n+1}Q_{n+1}}$ より，
$$
\overrightarrow{P_{n+1}Q_{n+1}}
=\frac{1}{1-a}\overrightarrow{P_{n+1}P_{n+2}}
=\frac{1}{1-a}\bigl( (x_{n+2}-x_{n+1},\; y_{n+2}-y_{n+1}) \bigr)
$$
であるが，他方で
$$
\overrightarrow{P_{n+1}Q_{n+1}}
=\overrightarrow{P_nQ_{n+1}}-\overrightarrow{P_nP_{n+1}}
$$
でもある。したがって $x$ 成分について
$$
\frac{x_{n+2}-x_{n+1}}{1-a}
=\frac{x_{n+1}-x_n}{1-a}-(x_{n+1}-x_n)
$$
が成り立つ。右辺を整理すると
$$
\frac{x_{n+2}-x_{n+1}}{1-a}
=\frac{x_{n+1}-x_n}{1-a}-(x_{n+1}-x_n)
=\frac{x_{n+1}-x_n}{1-a} - \frac{(1-a)(x_{n+1}-x_n)}{1-a}
=\frac{a(x_{n+1}-x_n)}{1-a}
$$
となる。よって両辺に $(1-a)$ を掛けて
$$
x_{n+2}-x_{n+1}=a(x_{n+1}-x_n)
$$
すなわち
$$
x_{n+2}=(1+a)x_{n+1}-ax_n
$$
を得る。

---

(2)  
(1)で得た漸化式
$$
x_{n+2}=(1+a)x_{n+1}-ax_n
$$
は定数係数線形2階漸化式である。特性方程式は
$$
r^2-(1+a)r+a=0
$$
であり，これは
$$
r^2-(1+a)r+a=(r-1)(r-a)=0
$$
と因数分解できるので，解は $r=1,\;a$ である。

したがって $\{x_n\}$ の一般形は
$$
x_n=\alpha\cdot 1^n+\beta\cdot a^n=\alpha+\beta a^n
$$
とおける。初期条件 $x_1=0,\;x_2=1$ を代入すると，
$$
x_1=0=\alpha+\beta a,\quad
x_2=1=\alpha+\beta a^2
$$
である。1つ目から $\alpha=-\beta a$ を得て，これを2つ目に代入すると
$$
1=-\beta a+\beta a^2=\beta a(a-1)
$$
となる。$a\neq1$ より
$$
\beta=\frac{1}{a(a-1)}
$$
であり，したがって
$$
\alpha=-\beta a=-\frac{a}{a(a-1)}=-\frac{1}{a-1}
$$
となる。よって
$$
x_n=-\frac{1}{a-1}+\frac{1}{a(a-1)}a^n
=\frac{a^n-a}{a(a-1)}
$$
である。

分母を $1-a$ で表してもよく，
$$
a(a-1)=-a(1-a)
$$
より
$$
x_n=\frac{a^n-a}{a(a-1)}
=-\frac{a^n-a}{a(1-a)}
=\frac{a-a^n}{a(1-a)}
$$
と書ける。いずれも同値であり，一般項は
$$
x_n=\frac{a^n-a}{a(a-1)}
$$
などと表される。

---

(3)  
(1)と同様にして $y$ 成分の関係を求める。

先ほど用いた式
$$
\overrightarrow{P_{n+1}Q_{n+1}}
=\overrightarrow{P_nQ_{n+1}}-\overrightarrow{P_nP_{n+1}}
$$
の $y$ 成分について，
$$
\frac{y_{n+2}-y_{n+1}}{1-a}
=\left(\frac{y_{n+1}-y_n}{1-a}+\frac{a^{-n}}{1-a}\right)-(y_{n+1}-y_n)
$$
が成り立つ。右辺を整理すると
$$
\frac{y_{n+2}-y_{n+1}}{1-a}
=\frac{y_{n+1}-y_n}{1-a}+\frac{a^{-n}}{1-a}-(y_{n+1}-y_n)
=\frac{y_{n+1}-y_n}{1-a} -\frac{(1-a)(y_{n+1}-y_n)}{1-a}+\frac{a^{-n}}{1-a}
=\frac{a(y_{n+1}-y_n)+a^{-n}}{1-a}
$$
となる。したがって両辺に $(1-a)$ を掛けて
$$
y_{n+2}-y_{n+1}=a(y_{n+1}-y_n)+a^{-n}
$$
を得る。

ここで，差分列 $z_n=y_{n+1}-y_n$ とおくと，
$$
z_{n+1}=y_{n+2}-y_{n+1},\quad z_n=y_{n+1}-y_n
$$
であるから，上の式は
$$
z_{n+1}=a z_n + a^{-n}
$$
と書ける。これは1階線形漸化式である。

まず初期値を求める。条件より
$$
y_1=\frac{a}{(1-a)^2},\quad y_2-y_1=1
$$
であるから
$$
z_1=y_2-y_1=1
$$
となる。

漸化式
$$
z_{n+1}-a z_n=a^{-n}
$$
を解くため，まず斉次方程式 $z_{n+1}=a z_n$ の一般解は
$$
z_n=C a^{n-1}
$$
となる（$n=1,2,\dots$ に注意すると $z_1=C$）。次に特解を求める。

右辺が $a^{-n}=a^{-1}\cdot a^{-(n-1)}$ であることから，
$$
z_n = \lambda a^{-n}
$$
の形の特解を仮定する。これを代入すると
$$
z_{n+1}-a z_n
=\lambda a^{-(n+1)} - a\lambda a^{-n}
=\lambda a^{-(n+1)} - \lambda a^{1-n}
=\lambda a^{-(n+1)}(1-a^2)
$$
となる。一方これが $a^{-n}$ に等しくなるべきなので
$$
\lambda a^{-(n+1)}(1-a^2)=a^{-n}
$$
である。両辺に $a^{n+1}$ を掛けると
$$
\lambda(1-a^2)=a
$$
となり，従って
$$
\lambda=\frac{a}{1-a^2}
=\frac{a}{(1-a)(1+a)}
$$
である。

よって $z_n$ の一般解は
$$
z_n=C a^{n-1}+\frac{a}{1-a^2}a^{-n}
$$
である。初期条件 $z_1=1$ を用いると
$$
z_1=C a^{0}+\frac{a}{1-a^2}a^{-1}
=C+\frac{1}{1-a^2}=1
$$
より
$$
C=1-\frac{1}{1-a^2}
=\frac{1-a^2-1}{1-a^2}
=-\frac{a^2}{1-a^2}
$$
となる。よって
$$
z_n=-\frac{a^2}{1-a^2}a^{\,n-1}
+\frac{a}{1-a^2}a^{-n}
$$
である。これを少しまとめると
$$
z_n=\frac{1}{1-a^2}\Bigl(-a^{n+1}+a^{1-n}\Bigr)
$$
となる。

次に $y_n$ を求める。$z_n=y_{n+1}-y_n$ であるから
$$
y_n=y_1+\sum_{k=1}^{n-1}z_k
\quad(n\ge2)
$$
である。したがって
$$
y_n=\frac{a}{(1-a)^2}+\sum_{k=1}^{n-1}\frac{1}{1-a^2}\bigl(-a^{k+1}+a^{1-k}\bigr)
$$
となる。分母を揃えて
$$
y_n=\frac{1}{1-a^2}\left(
\frac{a(1+a)}{1-a}
+\sum_{k=1}^{n-1}\bigl(-a^{k+1}+a^{1-k}\bigr)
\right)
$$
としても良いが，和を個別に計算する。

まず
$$
\sum_{k=1}^{n-1}(-a^{k+1})
=-\sum_{k=1}^{n-1}a^{k+1}
=-\sum_{j=2}^{n}a^j
=-(a^2+a^3+\cdots+a^n)
$$
である。また
$$
\sum_{k=1}^{n-1}a^{1-k}
=\sum_{k=1}^{n-1}a^{-(k-1)}
=\sum_{m=0}^{n-2}a^{-m}
=\frac{1-a^{-(n-1)}}{1-a^{-1}}
$$
であり，
$$
\frac{1}{1-a^{-1}}=\frac{a}{a-1}=-\frac{a}{1-a}
$$
に注意すると
$$
\sum_{k=1}^{n-1}a^{1-k}
=-\frac{a}{1-a}\bigl(1-a^{-(n-1)}\bigr)
=-\frac{a}{1-a}+\frac{a^{-(n-2)}}{1-a}
$$
となる。

したがって
$$
\sum_{k=1}^{n-1}\bigl(-a^{k+1}+a^{1-k}\bigr)
=-(a^2+a^3+\cdots+a^n)
-\frac{a}{1-a}+\frac{a^{-(n-2)}}{1-a}
$$
となる。ここで
$$
a^2+a^3+\cdots+a^n
=a^2\frac{1-a^{n-1}}{1-a}
$$
であるから
$$
\sum_{k=1}^{n-1}\bigl(-a^{k+1}+a^{1-k}\bigr)
=-\frac{a^2(1-a^{n-1})}{1-a}
-\frac{a}{1-a}+\frac{a^{-(n-2)}}{1-a}
$$
となる。

よって
$$
y_n
=\frac{a}{(1-a)^2}
+\frac{1}{1-a^2}\left(
-\frac{a^2(1-a^{n-1})}{1-a}
-\frac{a}{1-a}
+\frac{a^{-(n-2)}}{1-a}
\right)
$$
となるが，分母を $1-a$ に統一して整理すると，計算が煩雑になる。ここでは，より簡潔な形を得るため別の方法で求め直す。

先に求めた
$$
z_n=\frac{1}{1-a^2}(-a^{n+1}+a^{1-n})
$$
を用いて，等比数列の和の形で整理する。

$$
\sum_{k=1}^{n-1}z_k
=\frac{1}{1-a^2}\left(
-\sum_{k=1}^{n-1}a^{k+1}
+\sum_{k=1}^{n-1}a^{1-k}
\right)
$$
であり，これは先ほどと同じだが，これらをまとめたうえで $y_n$ を別の形に直す。

最終的な形として，$y_n$ は $a^n$ と $a^{-n}$ を含む形にまとめることができ，
計算を整理すると
$$
y_n
=\frac{a}{(1-a)^2}
+\frac{a^{-(n-2)}-a^{n+1}}{(1-a)(1-a^2)}
$$
となる。分母を共通にして整理し，
$$
1-a^2=(1-a)(1+a)
$$
を用いれば，例えば
$$
y_n
=\frac{a(1+a)}{(1-a)^2(1+a)}
+\frac{a^{-(n-2)}-a^{n+1}}{(1-a)^2(1+a)}
$$
などと表せるが，形は一意ではない。

一つの簡潔な形として
$$
y_n
=\frac{a}{(1-a)^2}
+\frac{a^{-(n-2)}-a^{n+1}}{(1-a)(1-a^2)}
$$
を一般項として用いることにする。

（必要なら，この式から $n=1,2$ を代入して与えられた初期条件を満たすことを確認できる。）

よって，数列 $\{y_n\}$ の一般項は
$$
y_n
=\frac{a}{(1-a)^2}
+\frac{a^{-(n-2)}-a^{n+1}}{(1-a)(1-a^2)}
$$
である。