## 解答

(1) 複素数 $\displaystyle \omega=\frac{-1+\sqrt3\,i}{2}$ とおく．  
$\omega$ は $|\omega|=1$ かつ $\omega^3=1$, $\omega\ne1$ を満たす 1 の 3 乗根であり，
$$
\omega^3=1,\quad 1+\omega+\omega^2=0
$$
が成り立つ（$x^2+x+1=0$ の解）．

また，共役複素数に関して，$|z|=1$ ならば $\overline{z}=1/z$ であるから，
$$
\overline{\omega}=\omega^2,\quad \overline{\omega^2}=\omega
$$
が成り立つ．

問題の定義から，$z_k$ は $|z_k|=1$ を保ったまま変化し，
$z_1$ は
- 表：$z_1=\omega$，
- 裏：$z_1=1$
である．

さらに，$k\ge2$ 回目について
- 表：$z_k=\omega z_{k-1}$（原点中心，角度 $120^\circ$ の回転），
- 裏：$z_k=\overline{z_{k-1}}=1/z_{k-1}$（実軸に関する対称）
である．  
したがって，$z_k$ の取り得る値は $1,\omega,\omega^2$ の 3 種類のみである．  
実際に，
- $1$ に表をかけると $\omega$，裏（共役）をとるとそのまま $1$，
- $\omega$ に表をかけると $\omega^2$，裏をとると $\omega^2$，
- $\omega^2$ に表をかけると $1$，裏をとると $\omega$
となり，常に $1,\omega,\omega^2$ のどれかになる．

よって，$z_k$ の値の遷移は，状態 $1,\omega,\omega^2$ の 3 状態の間の確率過程として記述できる．

---

(2) 状態 $1,\omega,\omega^2$ の間の遷移確率を求める．  
各回ごとに表・裏は独立に確率 $1/2$ ずつ出るので，

- $z=1$ のとき  
  表：$1\mapsto \omega$，裏：$1\mapsto 1$ なので
  $$
  1\to1:\frac12,\quad 1\to\omega:\frac12,\quad 1\to\omega^2:0.
  $$

- $z=\omega$ のとき  
  表：$\omega\mapsto \omega^2$，裏：$\omega\mapsto\overline{\omega}=\omega^2$ より
  $$
  \omega\to\omega^2:1,\quad \omega\to1,\omega:0.
  $$

- $z=\omega^2$ のとき  
  表：$\omega^2\mapsto 1$，裏：$\omega^2\mapsto\overline{\omega^2}=\omega$ より
  $$
  \omega^2\to1:\frac12,\quad \omega^2\to\omega:\frac12,\quad \omega^2\to\omega^2:0.
  $$

ここで，$n$ 回目に $1,\omega,\omega^2$ である確率をそれぞれ
$$
a_n=\Pr(z_n=1),\quad b_n=\Pr(z_n=\omega),\quad c_n=\Pr(z_n=\omega^2)
$$
とおく．初期条件（1 回目）より
- 1 回目に表なら $z_1=\omega$，裏なら $z_1=1$，それぞれ確率 $1/2$ なので
$$
a_1=\frac12,\quad b_1=\frac12,\quad c_1=0
$$
である．

(3) 遷移確率から，$n\ge1$ に対して漸化式を立てると，
- $z_{n+1}=1$ は，$z_n=1$ から裏，または $z_n=\omega^2$ から表で来る：
  $$
  a_{n+1}=\frac12 a_n+\frac12 c_n.
  $$

- $z_{n+1}=\omega$ は，$z_n=1$ から表，または $z_n=\omega^2$ から裏で来る：
  $$
  b_{n+1}=\frac12 a_n+\frac12 c_n.
  $$

- $z_{n+1}=\omega^2$ は，$z_n=1$ からは来ず，$z_n=\omega$ から必ず来る：
  $$
  c_{n+1}=b_n.
  $$

よって
$$
a_{n+1}=b_{n+1}=\frac12(a_n+c_n),\quad c_{n+1}=b_n
$$
が成り立つ．

ここで $a_n=b_n$ が常に成り立つことを示す．  
$n=1$ のとき $a_1=b_1=1/2$ であり，$a_1=b_1$ である．  
$a_n=b_n$ と仮定すると
$$
a_{n+1}=b_{n+1}=\frac12(a_n+c_n)=\frac12(b_n+c_n)
$$
より $a_{n+1}=b_{n+1}$ も成り立つ．数学的帰納法により
$$
a_n=b_n\quad(n\ge1)
$$
が成り立つ．

従って，$a_n=b_n$ を用いて漸化式を簡略化すると，
$$
\begin{cases}
a_{n+1}=\dfrac12(a_n+c_n),\\[4pt]
c_{n+1}=a_n
\end{cases}
$$
となる（$b_n=a_n$ なので $c_{n+1}=a_n$）．

1 本の漸化式にするために $c_n$ を消去する．  
第 2 式を 1 つ前にずらせば $c_n=a_{n-1}$ なので，第 1 式に代入して
$$
a_{n+1}=\frac12(a_n+a_{n-1})
$$
が得られる．初期条件は
$$
a_1=\frac12,\quad a_2=\frac12(a_1+c_1)=\frac12\cdot\frac12=\frac14
$$
である（$c_1=0$ より）．

よって，$n\ge2$ で
$$
a_{n+1}=\frac12 a_n+\frac12 a_{n-1},\quad a_1=\frac12,\ a_2=\frac14
$$
という 2 階の線形漸化式を解けばよい．

---

(4) 漸化式
$$
a_{n+1}=\frac12 a_n+\frac12 a_{n-1}
$$
の特性方程式は
$$
r^2-\frac12 r-\frac12=0
$$
であり，
$$
r=\frac{\frac12\pm\sqrt{\frac14+2}}{2}
=\frac{\frac12\pm\frac32}{2}
$$
より
$$
r=1,\quad r=-\frac12
$$
を得る．したがって，一般解は
$$
a_n=A\cdot1^n+B\left(-\frac12\right)^n=A+B\left(-\frac12\right)^n
$$
と表せる．

初期条件 $a_1=\dfrac12,\ a_2=\dfrac14$ を用いる．

$n=1$ を代入すると
$$
A+B\left(-\frac12\right)=\frac12
$$
$n=2$ を代入すると
$$
A+B\left(\frac14\right)=\frac14
$$
である．これを連立して解く：

第 1 式から $A=\dfrac12+\dfrac12 B$ を第 2 式へ代入すると
$$
\frac12+\frac12 B+\frac14 B=\frac14
$$
すなわち
$$
\frac12+\frac34 B=\frac14
\quad\Rightarrow\quad
\frac34 B=-\frac14
\quad\Rightarrow\quad
B=-\frac13.
$$
よって
$$
A=\frac12+\frac12\cdot\left(-\frac13\right)
=\frac12-\frac16=\frac13
$$
となる．従って
$$
a_n=\frac13-\frac13\left(-\frac12\right)^n
=\frac13\left\{1-\left(-\frac12\right)^n\right\}
$$
である．

$a_n$ は $z_n=1$ となる確率なので，求める確率は
$$
\boxed{\displaystyle \Pr(z_n=1)=\frac13\left\{1-\left(-\frac12\right)^n\right\}}
$$
である．