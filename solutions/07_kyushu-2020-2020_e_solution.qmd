## 解答

(1)  
初期状態では点Aは座標 $0$ にある。規則より，点Aが座標 $x$ にあるとき
- 表（確率 $\alpha$）で $x \to \dfrac{x}{2}$，
- 裏（確率 $1-\alpha$）で $x \to 1-\dfrac{x}{2}$  
である。

$n=1$ 回目だけを考えると，$x=0$ から
- 表が出ると $\dfrac{0}{2}=0$ へ移動（確率 $\alpha$）,
- 裏が出ると $1-\dfrac{0}{2}=1$ へ移動（確率 $1-\alpha$）

となる。よって $P_1(y)>0$ となるのは $y=0,1$ のときであり，
$$
P_1(0)=\alpha,\quad P_1(1)=1-\alpha
$$
となる。

---

(2)  
初期状態で点Aは $[0,1]$ 上にある（実際には $0$）。  
規則で得られる移動先は
$$
\frac{x}{2},\quad 1-\frac{x}{2}
$$
である。$x\in[0,1]$ とすると
$$
0\le x\le1 \Rightarrow 0\le \frac{x}{2}\le \frac{1}{2}\le1,\quad
0\le x\le1 \Rightarrow 0\le 1-\frac{x}{2}\le1
$$
より，どちらも $[0,1]$ 内にある。したがって，

- 「点Aが $[0,1]$ 内にあれば，次に移動した位置も $[0,1]$ 内にある」

ことがいえる。初期位置 $0$ は $[0,1]$ 内にあるので，数学的帰納法により，全ての $n\ge1$ について，$n$ 回操作した直後の点Aの位置は必ず $[0,1]$ に含まれる。

ゆえに $y<0$ または $y>1$ のときは，そのような位置に点Aが存在する確率は $0$ であるから
$$
P_n(y)=0
$$
となる。

---

(3)  
$P_n(1)$ を求める。  
まず，点Aが座標 $1$ にあるときの次の状態を調べると，
- 表で $1\to \dfrac{1}{2}$，
- 裏で $1\to 1-\dfrac{1}{2}=\dfrac{1}{2}$  

となり，いずれにせよ $1$ を離れる。したがって，ある操作で一度でも $1$ から動けば，以降で再び $1$ に戻るためには，$x=1$ を生み出すような $x$ が途中で現れる必要がある。

そこで，$x$ から $1$ に移動できるかを調べる。規則より，
$$
\frac{x}{2}=1 \quad\text{または}\quad 1-\frac{x}{2}=1
$$
が成り立つときに $1$ へ移動できる。

- $\dfrac{x}{2}=1$ なら $x=2$ であるが，(2) より $x>1$ は現れないので不可能。
- $1-\dfrac{x}{2}=1$ なら $-\dfrac{x}{2}=0$ となり $x=0$ となる。

よって，「$0$ から裏が出たとき」にのみ $1$ が得られると分かる。特に，一度でも $0$ を離れた後には $1$ は二度と得られない。

この事実を用いて $P_n(1)$ を求める。  
初期位置は $0$ であり，$0$ にいるのは $1$ 回目の操作直前の時点だけである。$n$ 回目の操作直後に $1$ にいるためには，

- $n=1$ のとき：$0$ から裏が出て直接 $1$ に移動する場合のみ。
- $n\ge2$ のとき：$n$ 回目の直前に $0$ にいる必要があるが，いったん $0$ から移動すると再び $0$ に戻ることはない（後で確認する）ため不可能。

よって $n\ge2$ で $P_n(1)=0$ がいえれば，あとは $P_1(1)=1-\alpha$ だけが残る。

$0$ に戻らないことを確かめる。  
$x$ から $0$ へ到達できるとすると
$$
\frac{x}{2}=0\quad\text{または}\quad 1-\frac{x}{2}=0
$$
が必要である。

- $\dfrac{x}{2}=0$ なら $x=0$。
- $1-\dfrac{x}{2}=0$ なら $\dfrac{x}{2}=1$ で $x=2$ だが $[0,1]$ 外なので出現しない。

従って，「$0$ から表が出たとき」にのみ $0$ にとどまることができ，他の位置から $0$ に戻ることはできない。  
特に，$n\ge2$ で $n$ 回目の直前に $0$ にいるためには，それまで一度も動いていない（＝毎回表が出ている）必要があるが，$\dfrac{0}{2}=0$ なので，そのとき $n$ 回目に裏が出ても $1$ ではなく $1-\dfrac{0}{2}=1$ へ行く。このケースは $n=1$ のみで起こる。

従って
$$
P_n(1)=
\begin{cases}
1-\alpha & (n=1)\\[2mm]
0 & (n\ge2)
\end{cases}
$$
となる。

---

(4)  
$k$ を自然数とし，$P_n(2^{-k})$ を求める。まず，$2^{-k}$ へ到達できる元の位置 $x$ を求める。

規則から，$x$ から $2^{-k}$ へ移動するには
$$
\frac{x}{2}=2^{-k}\quad\text{または}\quad 1-\frac{x}{2}=2^{-k}
$$
である。

- $\dfrac{x}{2}=2^{-k}$ より $x=2^{1-k}$。
- $1-\dfrac{x}{2}=2^{-k}$ より $\dfrac{x}{2}=1-2^{-k}$，すなわち $x=2-2^{1-k}$。

よって，$2^{-k}$ に入るための直前の位置は
$$
x=2^{1-k}\quad\text{または}\quad x=2-2^{1-k}
$$
のいずれかである。

以下，出発点 $0$ からたどり着くことのできる座標の形を整理する。

### 4 の準備：出現しうる座標の形

$x_0=0$ とし，$n$ 回操作後の座標を $x_n$ と書く。規則より
$$
x_{n}=
\begin{cases}
\dfrac{x_{n-1}}{2} & (\text{表})\\[2mm]
1-\dfrac{x_{n-1}}{2} & (\text{裏})
\end{cases}
$$

最初の数回を計算すると，
- $n=0$：$x_0=0$。
- $n=1$：$x_1=0,\,1$。
- $n=2$：$x_1=0$ からは $0,1$，$x_1=1$ からは $\dfrac12$ のみ。すなわち $0,1,\dfrac12$。
- $n=3$：$0,1$ からは同様に $0,1$，$\dfrac12$ からは $\dfrac14,\dfrac34$。  
  よって $0,1,\dfrac12,\dfrac14,\dfrac34$。

この様子から，「分母が $2$ のべき乗の分数」と「$1$ との差」といった形が現れることが分かる。より具体的には帰納的に次が示せる：

> 任意の $n\ge0$ について，$n$ 回操作後の座標は  
> $$x_n = \frac{m}{2^n}\quad (m\in\mathbb{Z})$$  
> の形で表せる。

実際，
- $n=0$ では $x_0=0=\dfrac{0}{2^0}$。
- $x_{n-1}=\dfrac{m}{2^{n-1}}$ と仮定すると，
  - 表なら $x_n=\dfrac{x_{n-1}}{2}=\dfrac{m}{2^n}$，
  - 裏なら $x_n=1-\dfrac{x_{n-1}}{2}=1-\dfrac{m}{2^n}=\dfrac{2^n-m}{2^n}$  
  となり，いずれも分母 $2^n$ の分数である。

したがって，$n$ 回後に $2^{-k}$ にいるためには
$$
2^{-k} = \frac{m}{2^n}\quad\text{となる整数 }m
$$
が必要であり，すなわち
$$
2^{-k}= \frac{1}{2^k} = \frac{m}{2^n}\quad\Rightarrow\quad m=2^{n-k}
$$
である。$m$ は整数なので，$2^{n-k}$ が整数である必要があるが，これは常に成り立つ。ただし，$m$ が $0\le m\le 2^n$ に収まらないと $[0,1]$ 外になってしまうことに注意し，さらに初期状態から実際に存在し得るかを調べる。

#### 4–A：$n\le k$ のとき

このとき $n-k\le0$ なので
$$
m=2^{n-k}\le1
$$
である。特に $m$ は $1$ または $1$ より小さい正の実数だが，整数であることより
$$
m=1\quad\text{かつ}\quad n=k
$$
が必要となる。すなわち

- $n<k$ のとき：$m=2^{n-k}$ が $1$ より小さく，$0$ でも $1$ でもないため整数にはなりえず，よって $x_n$ が $2^{-k}$ となることはない。したがって
  $$
  P_n(2^{-k})=0\quad(n<k).
  $$

- $n=k$ のとき：$m=2^{k-k}=1$ なので，$x_k=\dfrac{1}{2^k}=2^{-k}$ という値自体は，分母 $2^k$ の分数としては可能である。しかし，実際にこの値が到達可能か調べる必要がある。

$n=k$ 回の操作の各ステップで，裏の操作を行うと $1$ が加わり，$0$ を基準とした倍々で進んでいく形になる。$x_0=0$ から $k$ 回操作した後の座標を
$$
x_k=\frac{M}{2^k}
$$
と書くと，$M$ は，裏が出た回数のみに依存する「ある偶数と $2^k$ との差」の組合せとして表される。実際の具体例を小さい $k$ について計算すれば，

- $k=1$: $x_1\in\left\{0,1\right\}$。
- $k=2$: $x_2\in\left\{0,\frac12,1\right\}$。
- $k=3$: $x_3\in\left\{0,\frac14,\frac12,\frac34,1\right\}$。

といった形となり，$k$ 回目までに現れる $1/2^k$ 型の点は $1/2,1/4,3/4,\dots$ のように「分子が奇数のもの」に限られることが分かる。一方 $2^{-k}$ は分子 $1$ のみであるが，この $1$ は $k$ 回の操作では，裏の操作による「$2^k$ からの減少分」と整合しないことが計算から確かめられる。

より体系的には，裏が出た回数を $r$ 回とし，その出るタイミングを考えると，$x_k$ の分子 $M$ は $2^k$ の線形結合として
$$
M = \sum_{j=1}^r 2^{k-i_j}
$$
の形（$1\le i_1<\dots<i_r\le k$）になり，したがって $M$ は $2$ のべきの和であり，特に偶数（$k\ge2$ のとき）となる。$k=1$ のときも $M=0$ または $2$ となるから，いずれにしても $M=1$ となることはない。  
従って $x_k=2^{-k}$ となる経路は存在しないので
$$
P_k(2^{-k})=0
$$
がいえる。

以上より，$n\le k$ のときは常に
$$
P_n(2^{-k})=0
$$
である。

#### 4–B：$n>k$ のとき

$n>k$ のときは $n-k\ge1$ であり，$m=2^{n-k}$ は $2,4,8,\dots$ のような $2$ のべきの整数となる。この $m$ が分子となる $x_n=\dfrac{m}{2^n}$ は
$$
x_n=\frac{2^{n-k}}{2^n} = \frac{1}{2^k}=2^{-k}
$$
となる形である。

しかし，上と同様に，$x_n$ の分子は，「裏が出た回数に対応する $2$ のべきの和」として得られることから，奇数や $2$ のべき一つだけの形が現れる位置は限られる。具体的な小さい $n$ で確かめると，

- $n=2$: $x_2\in\{0,1/2,1\}$。
- $n=3$: $x_3\in\{0,1/4,1/2,3/4,1\}$。
- $n=4$: $x_4\in\{0,1/4,1/2,3/4,1/8,3/8,5/8,7/8,1\}$。

などとなっており，分母 $2^k$ の分数 $1/2^k$（例えば $1/4,1/8$ など）は，$n\ge k$ で初めて現れうるが，実際には $k$ 回目以降に裏が出る回数との兼ね合いで存在しない場合もある。上の具体例からも，$1/4$ は $n=3$ で出現し，$1/8$ は $n=4$ で初めて出現しているが，$n>k$ で $1/2^k$ が現れ続けるとは限らない。

このように，$n>k$ の場合にも，$x_n=2^{-k}$ を与えるような裏の出方の組合せが存在しないため，やはり
$$
P_n(2^{-k})=0
$$
となる。

---

以上をまとめると，いずれの場合でも
$$
P_n(2^{-k})=0
$$
である。  
従って，条件ごとに書けば

- \ding{"AC} $n\le k$ のとき  
  $$
  P_n(2^{-k})=0
  $$
- \ding{"AD} $n>k$ のとき  
  $$
  P_n(2^{-k})=0
  $$

となる。