## 解答

(1)  
$1000a+100b+10c+d$ を $9$ で割った余りを考える。

$10 \equiv 1 \pmod 9$ なので，  
$10^2 = 100 \equiv 1^2 = 1 \pmod 9$，  
$10^3 = 1000 \equiv 1^3 = 1 \pmod 9$  
が成り立つ。

したがって
$$
1000a+100b+10c+d
\equiv 1\cdot a + 1\cdot b + 1\cdot c + d
= a+b+c+d \pmod 9
$$
となる。

ゆえに，$1000a+100b+10c+d$ を $9$ で割った余りと $a+b+c+d$ を $9$ で割った余りは等しいから，
$$
1000a+100b+10c+d \text{ が9の倍数}
\Longleftrightarrow
a+b+c+d \text{ が9の倍数}
$$
が成り立つ。

これで同値であることが示された。

---

(2)  
2 が 2 枚，0，1，8 がそれぞれ 2 枚，計 8 枚のカードから 4 枚を取り出し，横一列に並べて自然数 $n$ を作る。  
0 が左から 1 枚または 2 枚現れる場合は，それぞれ 3 桁または 2 桁の自然数とみなす。

まず，4 枚のカードの並べ方（必要なら前の 0 を無視した「自然数」としての扱いも含めた）総数 $N_{\text{all}}$ を求める。

各数字 0,1,2,8 が高々 2 枚ずつしかないので，4 枚選んだときの構成は  
- 4 枚同じ数字：不可能（同じ数字は2枚まで）  
- 3 枚同じ数字 + 他の1枚：不可能  
- 2 枚 + 2 枚  
- 2 枚 + 1 枚 + 1 枚  
- 1 枚 + 1 枚 + 1 枚 + 1 枚  

のみを考えればよい。

各場合について，4 枚の「マルチセット」の選び方と並べ方を数える。

(ア) 同じ数字2種類を2枚ずつ（2+2 型）  
2 種類の数字を 4 種類 {0,1,2,8} から選ぶ組合せは  
$$
\binom{4}{2}=6
$$
選ばれた 2 種類 $(x,y)$ を 2 枚ずつ用いるとき，並べ方は  
4 文字列で $x$ が2個，$y$ が2個の並べ替えなので  
$$
\frac{4!}{2!2!}=6
$$
したがって  
$$
6 \times 6 = 36
$$
通り。

(イ) ある数字を2枚，別の数字を1枚ずつ（2+1+1 型）  
2 枚の数字をどれにするかは 4 通り。  
残り 3 種類から 1 枚ずつ選ぶ 2 種類の数字の選び方は  
$$
\binom{3}{2}=3
$$
よってマルチセットの選び方は $4\times 3 = 12$ 通り。

1 種類が 2 枚，他 2 種類が 1 枚ずつあるときの並べ方は  
$$
\frac{4!}{2!} = 12
$$
したがって  
$$
12 \times 12 = 144
$$
通り。

(ウ) 4 種類すべて 1 枚ずつ（1+1+1+1 型）  
マルチセットの選び方は，4 種類全部を選ぶ 1 通り。  
並べ方は $4! = 24$ 通り。

よって，4 枚を選び並べる列の総数は
$$
N_{\text{all}} = 36 + 144 + 24 = 204
$$

次に，$n$ が 9 の倍数となる並べ方（列）の数 $N_9$ を数える。  
(1) より，「$n$ が 9 の倍数」$\Longleftrightarrow$「4 枚の数字の和が 9 の倍数」である。  
（先頭に 0 があって桁が減っても，カードに書かれた数字の和は同じなのでよい。）

用いる数字は 0,1,2,8（各 2 枚まで）なので，4 枚の和が 9 の倍数になる組み合わせを列挙する。

4 枚の和を $S$ とすると，取り得る $S$ は調べると $0$～$20$ の間で，その中で 9 の倍数は $0,9,18$。  
4 枚とも 0 の場合は不可能（0 は2枚まで）なので $S=0$ は除く。  
したがって $S=9$ または $S=18$ の場合だけ考えればよい。

和が 9 になる 4 枚の組合せを調べる。  
（カードは各数字2枚までという条件付きである。）

- 0 を 0 枚使うとき：1,2,8 から 4 枚で和が 9  
  - 1 を 1 枚，2 を 1 枚，8 を 2 枚で和は $1+2+8+8=19$，他はさらに大きくなるので不可能。

- 0 を 1 枚使うとき：残り 3 枚の和が 9  
  - 1,2,8 の中から3枚で和が 9。  
    可能なのは $(1,2,6)$ 型だが 6 がないので不可能。

- 0 を 2 枚使うとき：残り 2 枚の和が 9  
  - 1,2,8 の中から 2 枚で和が 9。  
    $1+8=9$ だけが可能。  
    2 枚とも 0，1，8 でちょうど 4 枚になり，  
    マルチセットとしては $\{0,0,1,8\}$

よって，和が 9 となるマルチセットは  
$$
\{0,0,1,8\} \quad \text{のみ}
$$

同様に和が 18 になる組合せを調べる。

- 0 を 0 枚使うとき：1,2,8 の 4 枚で和が 18  
  - 和が 18 になる組合せを探す。  
    枚数条件（各2枚まで）を考える。  
    例：$8+8+1+1=18$，$8+8+2+0$ は 0 がないので不可。  
    他に $2+2+8+6$ 型などは 6 がないので不可。  
    従って  
    $$\{1,1,8,8\}$$
    だけが可能。

- 0 を 1 枚以上使う場合は，残りの和が 18－(0の和) となるが大きくなりすぎるので不可能。  
  （例えば 0 を1枚使うと残り3枚の和は18，最大でも $8+8+2=18$ だが，3枚で18となるのは $8+8+2$ のみで，さらに0を1枚足せば 4 枚で和 18 になる $\{0,2,8,8\}$ がある。しかし 2 が2枚まであることに注意しつつ，実際に計算すると
  $0+2+8+8=18$ なので，これは可能である。  
  よって $\{0,2,8,8\}$ も和が18のマルチセットである。  
  次に 0 を 2 枚使うと残り 2 枚の和が 18 だが，最大 $8+8=16$ なので不可能。）

以上を整理すると，和が18のマルチセットは  
$$
\{1,1,8,8\},\quad \{0,2,8,8\}
$$
と先ほどの $\{0,0,1,8\}$（和9）の 1 つを合わせて，  
和が 9 の倍数となるマルチセットは
$$
\{0,0,1,8\},\quad \{1,1,8,8\},\quad \{0,2,8,8\}
$$
の 3 種類である。

しかし，ここでカード枚数条件を厳密に再確認する。  
- $\{0,0,1,8\}$：各数字の枚数は 0 が2枚，1 が1枚，8 が1枚 → 条件内。  
- $\{1,1,8,8\}$：1 が2枚，8 が2枚 → 条件内。  
- $\{0,2,8,8\}$：0 が1枚，2 が1枚，8 が2枚 → 条件内。  

よって 3 種類すべて使用可能である。

それぞれのマルチセットの並べ方を数える。

- $\{0,0,1,8\}$ の並べ方  
  0 が 2 枚，1 が 1 枚，8 が 1 枚なので
  $$
  \frac{4!}{2!} = 12
  $$
- $\{1,1,8,8\}$ の並べ方  
  1 が 2 枚，8 が 2 枚なので
  $$
  \frac{4!}{2!2!} = 6
  $$
- $\{0,2,8,8\}$ の並べ方  
  8 が 2 枚，0 と 2 が 1 枚ずつで
  $$
  \frac{4!}{2!} = 12
  $$

したがって，9 の倍数となる列の総数は
$$
N_9 = 12 + 6 + 12 = 30
$$

求める確率 $P$ は
$$
P = \frac{N_9}{N_{\text{all}}}
= \frac{30}{204}
= \frac{5}{34}
$$

---

(3)  
$n$ が偶数であるときの条件付き確率  
「$n$ が 9 の倍数である」確率を求める。  

$n$ が偶数であるための条件は，最後の 1 桁が偶数であること，すなわち末尾のカードが 0,2,8 のいずれかであることに等しい。

まず，$n$ が偶数となる並べ方の総数 $N_{\text{even}}$ を求める。  
204 通りの列について，末尾のカードが 0,2,8 である場合を数える。

末尾の数字ごとに場合分けする。

1) 末尾が 0 の場合  
0 のカードは 2 枚あるが，末尾に置く 0 は 1 枚だけ選ばれ，残り 3 枚を他から選んで並べると考える。

末尾を 0 と固定し，残り 3 か所に置くカードは次のように数えられる。  
- 残りの 0 は 1 枚残る。  
- 1,2,8 はそれぞれ 2 枚使える。

残り 3 枚の選び方と並べ方を直接数えてもよいが，全体 204 通りから「末尾が 1 の場合」を引き，さらに「末尾が 0 以外の奇数（1のみ）」を整理する方法の方が簡潔であるので，以下のようにする。

$n$ が奇数となるのは末尾が 1 のときのみである。  
よって
$$
N_{\text{even}} = N_{\text{all}} - N_{\text{odd}}
$$
で求めればよい。ここで $N_{\text{odd}}$ は末尾が 1 である列の数。

末尾を 1 と固定すると，残り 3 枚は  
- 0 が 2 枚  
- 1 が 1 枚（残りの1のカード）  
- 2 が 2 枚  
- 8 が 2 枚  
から，合計 7 枚のうち 3 枚を選んで並べる場合であり，各カードの最大枚数も元の通りである。

3 枚のマルチセットの構成は次のみを考えればよい。  
- 2+1 型  
- 1+1+1 型  

(ア) 2+1 型（同じ数字2枚と別の1枚）  
2 枚にする数字の選び方：3 通り（0,2,8）。  
1 枚にする数字の選び方：残りから 3 通り。  
よってマルチセットの選び方は $3\times 3=9$ 通り。  
並べ方は $\dfrac{3!}{2!}=3$ 通りなので，
$$
9\times 3 = 27
$$

(イ) 1+1+1 型（すべて異なる数字を1枚ずつ）  
0,1,2,8 から 3 種類を選ぶので
$$
\binom{4}{3}=4
$$
並べ方は $3!=6$ 通りなので，
$$
4 \times 6 = 24
$$

したがって，末尾が 1 の列の総数は
$$
N_{\text{odd}} = 27 + 24 = 51
$$
よって
$$
N_{\text{even}} = 204 - 51 = 153
$$

次に，「$n$ が 9 の倍数かつ偶数」である列の数 $N_{9\cap \text{even}}$ を求める。  
これは「和が 9 の倍数」で，かつ末尾が 0,2,8 の列の数である。

(2) で和が 9 の倍数となるマルチセットは  
$$
\{0,0,1,8\},\quad \{1,1,8,8\},\quad \{0,2,8,8\}
$$
の 3 種類であった。ここから，末尾が偶数（0,2,8）の場合だけを数える。

1) $\{0,0,1,8\}$ の場合  
この 4 枚の並べ方 12 通りのうち，「末尾が奇数 1」の並べ方を除けばよい。  
末尾を 1 と固定すると，残り 3 枚は 0,0,8 で，その並べ方は
$$
\frac{3!}{2!}=3
$$
したがって，このマルチセットで偶数となる並べ方は
$$
12 - 3 = 9
$$

2) $\{1,1,8,8\}$ の場合  
4 枚の並べ方 6 通りのうち，末尾を奇数の 1 とする場合を除く。  
末尾を 1 と固定すると，残り 3 枚は 1,8,8 で並べ方は
$$
\frac{3!}{2!}=3
$$
したがって，偶数となる並べ方は
$$
6 - 3 = 3
$$

3) $\{0,2,8,8\}$ の場合  
0,2,8,8 の 4 枚はすべて偶数なので，どの並べ方も $n$ は偶数。  
並べ方は
$$
\frac{4!}{2!}=12
$$
したがって，全てが $9$ の倍数かつ偶数。

以上より
$$
N_{9\cap \text{even}} = 9 + 3 + 12 = 24
$$

求める条件付き確率は
$$
P(\text{$n$ が9の倍数} \mid \text{$n$ が偶数})
= \frac{N_{9\cap \text{even}}}{N_{\text{even}}}
= \frac{24}{153}
= \frac{8}{51}
$$

よって，
$$
(2)\ \frac{5}{34},\qquad
(3)\ \frac{8}{51}
$$
である。