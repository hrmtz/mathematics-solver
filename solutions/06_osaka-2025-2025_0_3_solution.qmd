## 解答

放物線 $C : y = x^2 - 1$ 上の点 $P$ を $P(a,\;a^2-1)$ （ただし $a \ne 0$）とおく．  
問題文の $S,T$ を $a$ を用いて表し，$S-T$ を $a$ の関数として最大値を求める．

---

(1) 接線 $l$ の式

$y = x^2-1$ の導関数は $y' = 2x$ なので，点 $P(a,a^2-1)$ における接線の傾きは $2a$ である．  
よって接線 $l$ の方程式は，点傾きの式から  
$$
y - (a^2-1) = 2a(x-a)
$$
すなわち
$$
y = 2ax - a^2 - 1
$$
である．

---

(2) 図形と積分区間の整理

$C$ と $y$ 軸の交点は $x=0$ を代入して
$$
y = 0^2 -1 = -1
$$
より $A(0,-1)$ である．

また，直線 $OP$ は $O(0,0)$ と $P(a,a^2-1)$ を通るので，$a\ne 0$ より  
傾きは
$$
\frac{a^2-1 - 0}{a-0} = a - \frac{1}{a}
$$
であり，直線 $OP$ の式は
$$
y = \left(a-\frac{1}{a}\right)x
$$
となる．

放物線 $C$ と直線 $OP$ の交点は $O$ と $P$ の 2 点である．実際，
$$
x^2-1 = \left(a-\frac{1}{a}\right)x
$$
とおくと
$$
x^2 - \left(a-\frac{1}{a}\right)x -1=0
$$
となるが，$x=0$ を代入すると $-1\ne 0$ で解にならないので，  
$x=0$ はこの式の解ではなく，これは $O$ を通るかどうかの条件ではなく，  
そもそも「$C$ と $OP$ の交点」は点 $P$ だけであり，他方 $O$ は $C$ 上でないことに注意する．  
（ここは「線分 $OP$ と $y$ 軸，放物線で囲まれる部分」という図形の把握にのみ用いる．）

以下，$a>0$ の場合と $a<0$ の場合で，$y$ 軸との位置関係が変わるため，  
面積の表し方が異なることに注意する．

---

(3) $S$ の求め方

$S$ は「放物線 $C$ と線分 $OP$ および $y$ 軸で囲まれた図形」の面積である．

- $a>0$ のとき：  
  $y$ 軸と直線 $OP$ は $x=0$ で交わり，その点は原点 $O(0,0)$ である．  
  図形は $x=0$ と $x=a$ の間に存在し，上側が直線 $OP$，下側が放物線 $C$ で囲まれる領域である．  
  よって
  $$
  S = \int_{0}^{a} \Bigl[\left(a-\frac{1}{a}\right)x - (x^2-1)\Bigr]\,dx
  = \int_{0}^{a} \left(-x^2 +\left(a-\frac{1}{a}\right)x +1\right)\,dx.
  $$

- $a<0$ のとき：  
  点 $P$ は第2象限にあり，線分 $OP$ と $y$ 軸はやはり原点で交わるが，$a<0$ なので区間は $[a,0]$ になる．  
  この場合も同様に，$x=a$ から $x=0$ の間で，上側が直線 $OP$，下側が放物線 $C$ の図形なので
  $$
  S = \int_{a}^{0} \Bigl[\left(a-\frac{1}{a}\right)x - (x^2-1)\Bigr]\,dx
  = \int_{a}^{0} \left(-x^2 +\left(a-\frac{1}{a}\right)x +1\right)\,dx.
  $$

そこで，$a$ の符号に応じて積分区間が変わるが，被積分関数は同じなので，  
一般に
$$
S = \int_{\min(0,a)}^{\max(0,a)} \left(-x^2 +\left(a-\frac{1}{a}\right)x +1\right)\,dx
$$
と書ける．

積分計算を行う．まず原始関数を求める：
$$
\int \left(-x^2 +\left(a-\frac{1}{a}\right)x +1\right)\,dx
= -\frac{x^3}{3} + \left(a-\frac{1}{a}\right)\frac{x^2}{2} + x.
$$

- $a>0$ のとき：
  $$
  S = \left[-\frac{x^3}{3} + \left(a-\frac{1}{a}\right)\frac{x^2}{2} + x\right]_{0}^{a}
  = -\frac{a^3}{3} + \left(a-\frac{1}{a}\right)\frac{a^2}{2} + a.
  $$
  ここで
  $$
  \left(a-\frac{1}{a}\right)\frac{a^2}{2}
  = \frac{a^3}{2} - \frac{a}{2}
  $$
  なので
  $$
  S = -\frac{a^3}{3} + \frac{a^3}{2} - \frac{a}{2} + a
     = \left(-\frac{1}{3}+\frac{1}{2}\right)a^3 + \left(-\frac{1}{2}+1\right)a
     = \frac{1}{6}a^3 + \frac{1}{2}a.
  $$

- $a<0$ のときも同様に
  $$
  S = \left[-\frac{x^3}{3} + \left(a-\frac{1}{a}\right)\frac{x^2}{2} + x\right]_{a}^{0}
  $$
  となり，計算すると同じ式
  $$
  S = \frac{1}{6}a^3 + \frac{1}{2}a
  $$
  が得られる．（実際，積分区間が逆向きになる分，$a$ の符号が変わるが，被積分関数に含まれる $a$ と打ち消し合い，同じ形になることが確認できる．）

したがって，$a$ の符号によらず
$$
S = \frac{1}{6}a^3 + \frac{1}{2}a
$$
である．

---

(4) $T$ の求め方

$T$ は「放物線 $C$ と接線 $l$ および $y$ 軸で囲まれた図形」の面積である．  
$C$ と接線 $l$ は点 $P(a,a^2-1)$ で接しており，$y$ 軸との交点を調べる．

- 放物線 $C$ は先に見たように $A(0,-1)$ を通る．
- 接線 $l : y = 2ax - a^2 -1$ の $y$ 軸との交点は $x=0$ を代入して  
  $$
  y = -a^2 -1
  $$
  となるから，点 $B(0,-a^2-1)$ である．

点 $A$ と $B$ の $y$ 座標を比較すると，
$$
-1 - (-a^2-1) = a^2 \ge 0
$$
なので
$$
-a^2-1 \le -1
$$
すなわち $B$ は $A$ よりも下側にある．また，$a\ne 0$ なので $A$ と $B$ は異なる点である．

したがって，$T$ は $x=0$ の下で，$x=0$ の左側または右側に広がる図形ではなく，  
$x$ 軸方向には $P$ を通る接線と放物線との間で閉じた，縦長の「レンズ形」領域である．  
この領域は $x$ 方向には放物線と直線が交わる $x$ 座標を境として，  
放物線が上側，接線が下側となる部分で構成されている．

ところが，接線 $l$ は $C$ とただ 1 点 $P$ で接するので，$x=a$ 以外には交点を持たない．  
したがって，$C$ と $l$ と $y$ 軸で囲まれた有限の面積を持つ領域を得るには，  
「$x=0$ から $x=a$ まで」の区間で，$C$ と $l$ の上下関係を調べればよい．

$y$ 軸上（$x=0$）では $C$ の点 $A(0,-1)$，$l$ の点 $B(0,-a^2-1)$ があり，  
$a^2>0$ より
$$
-1 > -a^2-1
$$
なので，$x=0$ では放物線 $C$ の方が上にある．  
また，接点 $P$ では $C$ と $l$ の高さが等しい．

よって $x=0$ から $x=a$ の間では，$C$ が上側，$l$ が下側となり，  
（$a>0$ のときは $[0,a]$，$a<0$ のときは $[a,0]$）  
この区間での 2 曲線の差の積分が面積 $T$ である．

したがって，$a>0$ のとき
$$
T = \int_{0}^{a} \Bigl[(x^2-1) - (2ax - a^2 -1)\Bigr]\,dx
= \int_{0}^{a} \left(x^2 -1 -2ax + a^2 +1\right)dx
= \int_{0}^{a} \left(x^2 -2ax + a^2\right)dx,
$$
$a<0$ のとき
$$
T = \int_{a}^{0} \left(x^2 -2ax + a^2\right)dx.
$$

なお，被積分関数
$$
x^2 -2ax + a^2 = (x-a)^2
$$
であるから，どちらの場合も
$$
T = \int_{\min(0,a)}^{\max(0,a)} (x-a)^2\,dx
$$
と書ける．

原始関数は
$$
\int (x-a)^2 dx = \frac{(x-a)^3}{3}
$$
であるから，

- $a>0$ のとき：
  $$
  T = \left[\frac{(x-a)^3}{3}\right]_{0}^{a}
    = \frac{(a-a)^3}{3} - \frac{(0-a)^3}{3}
    = 0 - \frac{(-a)^3}{3}
    = \frac{a^3}{3}.
  $$

- $a<0$ のとき：
  $$
  T = \left[\frac{(x-a)^3}{3}\right]_{a}^{0}
    = \frac{(-a)^3}{3} - \frac{(a-a)^3}{3}
    = \frac{(-a)^3}{3} - 0
    = -\frac{a^3}{3}.
  $$
  しかしこの場合，$a<0$ なので $-a^3 = |a|^3$ であり，結局
  $$
  T = \frac{a^3}{3}
  $$
  という同じ式に帰着する．

したがって $a$ の符号によらず
$$
T = \frac{a^3}{3}
$$
である．

---

(5) $S-T$ の最大値

以上より，
$$
S = \frac{1}{6}a^3 + \frac{1}{2}a,\quad
T = \frac{a^3}{3}
$$
だから
$$
S - T = \left(\frac{1}{6}a^3 + \frac{1}{2}a\right) - \frac{a^3}{3}
= \left(\frac{1}{6} - \frac{1}{3}\right)a^3 + \frac{1}{2}a
= -\frac{1}{6}a^3 + \frac{1}{2}a.
$$

よって
$$
f(a) = S-T = -\frac{1}{6}a^3 + \frac{1}{2}a
$$
とおくと，$a\ne 0$ の実数について $f(a)$ の最大値を求めればよい．  
（ただし，$a=0$ のとき $P$ は $y$ 軸上となり問題の仮定に反するが，極値の判定のためにいったん $a=0$ も含めて調べても差し支えない．）

$f(a)$ を微分すると
$$
f'(a) = -\frac{1}{2}a^2 + \frac{1}{2} = \frac{1}{2}(1-a^2)
$$
である．

$f'(a)=0$ より
$$
1-a^2 = 0 \quad\Longrightarrow\quad a^2=1 \quad\Longrightarrow\quad a=\pm 1.
$$

次に増減を調べる．  
$f'(a)$ の符号は

- $|a|<1$ のとき $1-a^2>0$ なので $f'(a)>0$，$f$ は増加．
- $|a|>1$ のとき $1-a^2<0$ なので $f'(a)<0$，$f$ は減少．

従って，$a=-1$ および $a=1$ はともに極大点であり，  
$a\to\pm\infty$ では $-\frac{1}{6}a^3$ が支配的になり $f(a)\to -\infty$ なので，  
$f(a)$ は全実数上で最大値を $a=\pm 1$ でとる．

そのときの値は
$$
f(1) = -\frac{1}{6}\cdot 1^3 + \frac{1}{2}\cdot 1
= -\frac{1}{6} + \frac{1}{2}
= \frac{1}{3},
$$
$$
f(-1) = -\frac{1}{6}(-1)^3 + \frac{1}{2}(-1)
= \frac{1}{6} - \frac{1}{2}
= -\frac{1}{3}
$$
である．

よって最大値は $f(1)=\dfrac{1}{3}$ であり，これは $a=1$ のときに実現される．  
この $a=1$ のとき，$P(1,0)$ は $y$ 軸上ではないので問題の条件も満たしている．

したがって，
$$
S-T \text{ の最大値は } \frac{1}{3}
$$
である．