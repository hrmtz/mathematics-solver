## 解答

(1)  
点$P(x,y)$とおくと
$$
AP^2=(x-1)^2+y^2,\quad BP^2=(x-3)^2+(y-1)^2,\quad CP^2=(x-2)^2+(y-2)^2
$$
より
$$
\begin{aligned}
AP^2+BP^2+CP^2
&=(x-1)^2+y^2+(x-3)^2+(y-1)^2+(x-2)^2+(y-2)^2\\
&=(x^2-2x+1)+(x^2-6x+9)+(x^2-4x+4)\\
&\quad +(y^2)+(y^2-2y+1)+(y^2-4y+4)\\
&=3x^2-12x+14+3y^2-6y+5\\
&=3(x^2-4x)+3(y^2-2y)+19\\
&=3\bigl\{(x-2)^2-4\bigr\}+3\bigl\{(y-1)^2-1\bigr\}+19\\
&=3(x-2)^2+3(y-1)^2+8.
\end{aligned}
$$

よって
$$
AP^2+BP^2+CP^2 = 3(x-2)^2+3(y-1)^2+8
$$
であり，$3(x-2)^2+3(y-1)^2\ge 0$より，すべての点$P$について
$$
AP^2+BP^2+CP^2\ge 8
$$
が成り立つ。等号は$(x-2)^2=(y-1)^2=0$すなわち$P(2,1)$のときに成り立つ。

したがって，$D$が少なくとも1点を含むためには
$$
a\ge \min (AP^2+BP^2+CP^2)=8
$$
であればよい。

よって，求める$a$の範囲は
$$
a\ge 8
$$
である。

---

(2)  
(1)で求めた式
$$
AP^2+BP^2+CP^2 = 3(x-2)^2+3(y-1)^2+8
$$
を用いる。

$D$が$T$を含むとは，三角形$ABC$の内部および辺上のすべての点$P$について  
$$
AP^2+BP^2+CP^2\le a
$$
が成り立つこと，すなわち  
$$
\max_{P\in T}(AP^2+BP^2+CP^2)\le a
$$
となることである。

よって，まず$P\in T$における$AP^2+BP^2+CP^2$の最大値を求める。  
すなわち，
$$
f(x,y)=3(x-2)^2+3(y-1)^2+8
$$
の$T$上での最大値を求めればよい。

$f(x,y)$は中心$(2,1)$の円状の二次関数であり，$T$は有界な凸集合なので，最大値は$T$の境界上，すなわち三角形$ABC$の3辺上のいずれかにおいてとられる。よって各辺上で$f$の最大値を調べる。

まず頂点$A,B,C$での値を求める。
$$
\begin{aligned}
&f(A)=f(1,0)=3(1-2)^2+3(0-1)^2+8=3+3+8=14,\\
&f(B)=f(3,1)=3(3-2)^2+3(1-1)^2+8=3+0+8=11,\\
&f(C)=f(2,2)=3(2-2)^2+3(2-1)^2+8=0+3+8=11.
\end{aligned}
$$

次に各辺を通る直線を求め，その上で$f$の最大値を調べる。

辺$AB$：$A(1,0),B(3,1)$を通る直線の傾きは  
$$
\frac{1-0}{3-1}=\frac12
$$
なので，方程式は
$$
y=\frac12(x-1)
$$
である。これを$f$に代入する。
$$
\begin{aligned}
f(x,y)
&=3(x-2)^2+3(y-1)^2+8\\
&=3(x-2)^2+3\left(\frac12(x-1)-1\right)^2+8\\
&=3(x-2)^2+3\left(\frac12(x-3)\right)^2+8\\
&=3(x-2)^2+\frac34(x-3)^2+8.
\end{aligned}
$$
これは$x$についての2次関数であり，係数は正なので最小値をとる点があり，$x\to \pm\infty$で発散する。したがって，線分$AB$上では端点$A,B$のどちらかで最大になる。すでに
$$
f(A)=14,\quad f(B)=11
$$
であるから，辺$AB$上の最大値は$14$である。

同様に，辺$BC$：$B(3,1),C(2,2)$を通る直線は傾き$-1$で
$$
y=-x+4
$$
となる。これを代入すると
$$
\begin{aligned}
f(x,y)
&=3(x-2)^2+3(y-1)^2+8\\
&=3(x-2)^2+3(-x+4-1)^2+8\\
&=3(x-2)^2+3(-x+3)^2+8.
\end{aligned}
$$
これも$x$について係数正の2次関数なので，線分$BC$上の最大値は端点$B,C$のいずれかでとられる。すでに
$$
f(B)=11,\quad f(C)=11
$$
であるから，辺$BC$上の最大値は$11$である。

辺$CA$：$C(2,2),A(1,0)$を通る直線の傾きは
$$
\frac{0-2}{1-2}=2
$$
なので
$$
y=2(x-1)
$$
である。これを代入して
$$
\begin{aligned}
f(x,y)
&=3(x-2)^2+3(y-1)^2+8\\
&=3(x-2)^2+3\{2(x-1)-1\}^2+8\\
&=3(x-2)^2+3(2x-3)^2+8.
\end{aligned}
$$
これも係数正の2次関数であり，線分$CA$上での最大は端点$C,A$のいずれかでとられる。
$$
f(C)=11,\quad f(A)=14
$$
より，辺$CA$上の最大値は$14$である。

以上から，三角形$ABC$の3辺上で$f$の最大値は$14$であり，内部ではそれより大きい値をとることはない（$f$は境界を離れると中心$(2,1)$に向かって減少する形であるため）。したがって
$$
\max_{P\in T}(AP^2+BP^2+CP^2)=14
$$
である。

$D$が$T$を含むには
$$
a\ge 14
$$
が必要十分である。

よって，求める$a$の範囲は
$$
a\ge 14
$$
である。

---

(3)  
(1)より，$D$が少なくとも1点を含むには$a\ge 8$である。  
この条件のもとで，さらに$D\subset T$となる$a$の範囲を求める。

$D\subset T$とは，$AP^2+BP^2+CP^2\le a$を満たす点$P$はすべて$T$の中（および辺上）にあることを意味する。逆に言えば，$T$の外にある点$P$はすべて
$$
AP^2+BP^2+CP^2>a
$$
を満たさねばならない。

$T$の外の点で$AP^2+BP^2+CP^2$が最小になる点を考えると，それは$T$の境界（3辺）上のうち，$T$の外側に最も近い点，すなわち3辺上での最小値と一致する。  
(2)と同様に$f(x,y)=3(x-2)^2+3(y-1)^2+8$について，各辺上の最小値を調べる。

すでに，辺$AB$上では$f$は端点$A,B$のどちらかで最大をとる2次関数であり，したがって最小値は$A,B$間のどこか内部でとるか，端点でとる。直接計算するより，幾何的に考えると，$f(x,y)$は中心$(2,1)$からの距離の2乗に比例する形なので，直線$AB$上で最小になる点は，$(2,1)$から直線$AB$に下ろした垂線の足である。これを具体的に計算する。

直線$AB$の方程式は$y=\dfrac12(x-1)$であったから，法線ベクトルは$(1,-2)$とみなせる。点$(2,1)$と直線$AB$の距離$d$は
$$
d=\frac{|1\cdot 2 +(-2)\cdot 1 -1|}{\sqrt{1^2+(-2)^2}}
 =\frac{|2-2-1|}{\sqrt{5}}=\frac{1}{\sqrt{5}}
$$
である。よって，直線$AB$上での$(2,1)$からの距離の2乗の最小値は$d^2=1/5$であり，したがって
$$
\min_{P\in AB} f(P)
=3\cdot \frac15+8
=\frac{3}{5}+8
=\frac{43}{5}
$$
である。なお，この最小値をとる点（垂線の足）は$A$と$B$の間に存在するので，線分$AB$上での最小値でもある。

同様に，直線$BC$の方程式は$y=-x+4$であり，法線ベクトルは$(1,1)$とみなせる。$(2,1)$から直線$BC$までの距離$d'$は
$$
d'=\frac{|1\cdot 2+1\cdot 1 -4|}{\sqrt{1^2+1^2}}
 =\frac{|3-4|}{\sqrt{2}}=\frac{1}{\sqrt{2}}
$$
なので，距離の2乗は$d'^2=1/2$，したがって
$$
\min_{P\in BC} f(P)
=3\cdot \frac12+8
=\frac{3}{2}+8
=\frac{19}{2}
$$
である。垂線の足は$B$と$C$の間にあるので，線分$BC$上での最小値である。

直線$CA$の方程式は$y=2(x-1)$であり，法線ベクトルは$(2,-1)$とみなせる。$(2,1)$から直線$CA$までの距離$d''$は
$$
d''=\frac{|2\cdot 2+(-1)\cdot 1-2|}{\sqrt{2^2+(-1)^2}}
 =\frac{|4-1-2|}{\sqrt{5}}=\frac{1}{\sqrt{5}}
$$
より，$d''^2=1/5$，したがって
$$
\min_{P\in CA} f(P)
=3\cdot \frac15+8
=\frac{43}{5}
$$
となる。垂線の足は$C$と$A$の間にあるので，線分$CA$上での最小値である。

よって，$T$の境界上（3辺上）での$f$の最小値は
$$
\min\left(\frac{43}{5},\frac{19}{2},\frac{43}{5}\right)
=\frac{43}{5}
$$
である。内部に入ると$(2,1)$に近づくため$f$はさらに小さくなるが，$T$の「外側」から見ると，$T$に属さない点での$f$の最小値は，この境界の最小値以上となる。

したがって，「$T$に属さない点$P$では必ず$AP^2+BP^2+CP^2>a$」となるために必要十分な条件は
$$
a<\frac{43}{5}
$$
である。これと(1)の$a\ge 8$を合わせると
$$
8\le a<\frac{43}{5}
$$
が求める範囲となる。

よって，(1)のもとで$D$が$T$に含まれるような$a$の範囲は
$$
8\le a<\frac{43}{5}
$$
である。