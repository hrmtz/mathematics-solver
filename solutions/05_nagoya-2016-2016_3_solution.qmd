## 解答

袋Bに入っている赤玉の個数を状態とみなす。  
状態を  
- 状態0：Bに赤玉0個（白2個）  
- 状態1：Bに赤玉1個（赤1個・白1個）  
- 状態2：Bに赤玉2個（赤2個）  

とおく。初期状態は「Aに赤2個，Bに白2個」なので，はじめは状態0である。

1回の操作は  
(ⅰ) Bから1個取ってAに入れる  
(ⅱ) 次にAから1個取ってBに入れる  
である。

### (1) $P_1(k)$ の計算

最初は状態0なので，1回操作後に状態0,1,2 のいずれかにいる確率を求めればよい。

#### 状態0から1回操作したとき

初期状態0では  
- A：赤2  
- B：白2  

(ⅰ) Bから1個取るとき，Bには白2個なので，必ず白を取る。よって，  
- A：赤2, 白1  
- B：白1  

(ⅱ) Aから1個取るとき，Aには赤2個と白1個があるので，  
- 赤を取る確率は $\dfrac{2}{3}$  
- 白を取る確率は $\dfrac{1}{3}$  

赤を取った場合：  
Aから赤1個がBへ  
- A：赤1, 白1  
- B：赤1, 白1  

なので，Bの赤は1個，すなわち状態1となる。この確率は $\dfrac{2}{3}$ である。

白を取った場合：  
Aから白1個がBへ  
- A：赤2  
- B：白2  

なので，再び状態0に戻る。この確率は $\dfrac{1}{3}$ である。

したがって，1回操作後に  
- 状態0にいる確率 $P_1(0) = \dfrac{1}{3}$  
- 状態1にいる確率 $P_1(1) = \dfrac{2}{3}$  
- 状態2にいる確率 $P_1(2) = 0$  

である。

よって，

(1)  
$$
P_1(0) = \dfrac{1}{3},\quad
P_1(1) = \dfrac{2}{3},\quad
P_1(2) = 0
$$

となる。

---

### (2) 一般の $P_n(k)$ の計算

まず，状態間の遷移確率を求める。

#### 状態0から次の操作後の状態

これは(1)で計算したものと同じである。状態0のとき  
- A：赤2  
- B：白2  

(ⅰ) Bからは必ず白を取る。  
(ⅱ) Aからは赤を取る確率が $\dfrac{2}{3}$，白を取る確率が $\dfrac{1}{3}$ であった。

よって  
- 状態0 → 状態0：確率 $\dfrac{1}{3}$  
- 状態0 → 状態1：確率 $\dfrac{2}{3}$  
- 状態0 → 状態2：確率 $0$

#### 状態2から次の操作後の状態

状態2では  
- A：白2  
- B：赤2  

(ⅰ) Bから取るとき，Bには赤2個なので，必ず赤を取る。すると  
- A：白2, 赤1  
- B：赤1  

(ⅱ) Aから取るとき，Aには白2個と赤1個があるので，  
- 白を取る確率は $\dfrac{2}{3}$  
- 赤を取る確率は $\dfrac{1}{3}$  

白を取った場合：  
Aから白1個がBへ  
- A：白1, 赤1  
- B：白1, 赤1  

となり，状態1となる。この確率は $\dfrac{2}{3}$ である。

赤を取った場合：  
Aから赤1個がBへ  
- A：白2  
- B：赤2  

となり，状態2のままである。この確率は $\dfrac{1}{3}$ である。

よって  
- 状態2 → 状態1：確率 $\dfrac{2}{3}$  
- 状態2 → 状態2：確率 $\dfrac{1}{3}$  
- 状態2 → 状態0：確率 $0$

#### 状態1から次の操作後の状態

状態1では  
- A：赤1, 白1  
- B：赤1, 白1  

(ⅰ) まずBから取る。  
- Bから赤を取る確率は $\dfrac{1}{2}$  
- Bから白を取る確率は $\dfrac{1}{2}$  

場合分けして考える。

(ⅰ)で赤を取ったとき（確率 $\dfrac{1}{2}$）：  
- A：赤1, 白1, 赤1（＝赤2, 白1）  
- B：白1  

となる。（Bの赤は0個）

(ⅱ) 次にAから取る。Aには赤2個と白1個があるので，  
- 赤を取る確率は $\dfrac{2}{3}$  
- 白を取る確率は $\dfrac{1}{3}$  

赤を取る（確率 $\dfrac{2}{3}$）とき：  
- A：赤1, 白1  
- B：白1, 赤1  

よって最終的に状態1になる。  
ここまでの確率は  
$$
\dfrac{1}{2}\times\dfrac{2}{3} = \dfrac{1}{3}
$$

白を取る（確率 $\dfrac{1}{3}$）とき：  
- A：赤2  
- B：白2  

よって最終的に状態0になる。  
ここまでの確率は  
$$
\dfrac{1}{2}\times\dfrac{1}{3} = \dfrac{1}{6}
$$

次に，(ⅰ)で白を取ったとき（確率 $\dfrac{1}{2}$）：  
- A：赤1, 白1, 白1（＝赤1, 白2）  
- B：赤1  

となる。（Bの赤は1個）

(ⅱ) 次にAから取る。Aには赤1個と白2個があるので，  
- 赤を取る確率は $\dfrac{1}{3}$  
- 白を取る確率は $\dfrac{2}{3}$  

赤を取る（確率 $\dfrac{1}{3}$）とき：  
- A：白2  
- B：赤2  

よって状態2になる。  
ここまでの確率は  
$$
\dfrac{1}{2}\times\dfrac{1}{3} = \dfrac{1}{6}
$$

白を取る（確率 $\dfrac{2}{3}$）とき：  
- A：赤1, 白1  
- B：赤1, 白1  

よって状態1に戻る。  
ここまでの確率は  
$$
\dfrac{1}{2}\times\dfrac{2}{3} = \dfrac{1}{3}
$$

以上より，状態1から次の1回操作後の状態は  
- 状態1 → 状態0：確率 $\dfrac{1}{6}$  
- 状態1 → 状態1：確率 $\dfrac{1}{3} + \dfrac{1}{3} = \dfrac{2}{3}$  
- 状態1 → 状態2：確率 $\dfrac{1}{6}$  

となる。

#### 遷移確率行列

状態0,1,2 の順に並べると，  
1回操作ごとの遷移確率行列 $M$ は

$$
M =
\begin{pmatrix}
\dfrac{1}{3} & \dfrac{2}{3} & 0 \\
\dfrac{1}{6} & \dfrac{2}{3} & \dfrac{1}{6} \\
0 & \dfrac{2}{3} & \dfrac{1}{3}
\end{pmatrix}
$$

である。ここで，行は「現在の状態」，列は「次の状態」を表すものとする。

#### 確率列ベクトルの漸化式

$n$回操作後の確率を  
$$
\boldsymbol{P}_n = \bigl(P_n(0),\, P_n(1),\, P_n(2)\bigr)
$$
とベクトルで表すと，  
1回操作ごとに
$$
\boldsymbol{P}_{n+1} = \boldsymbol{P}_n M
$$
が成り立つ。初期状態は状態0のみなので
$$
\boldsymbol{P}_0 = (1,\,0,\,0)
$$
である。

よって $P_n(0), P_n(1), P_n(2)$ は次の漸化式を満たす：

$$
\begin{cases}
P_{n+1}(0) = \dfrac{1}{3}P_n(0) + \dfrac{1}{6}P_n(1) \\
P_{n+1}(1) = \dfrac{2}{3}P_n(0) + \dfrac{2}{3}P_n(1) + \dfrac{2}{3}P_n(2) \\
P_{n+1}(2) = \dfrac{1}{6}P_n(1) + \dfrac{1}{3}P_n(2)
\end{cases}
$$

なお，常に $P_n(0)+P_n(1)+P_n(2)=1$ であるから，  
第2式は他の2式と和が1である条件から従う。したがって  
$$
P_n(0) \text{ と } P_n(2)
$$
だけを求めればよい。

#### 漸化式の対称性

状態0と状態2は，赤玉と白玉を入れ替える操作によって対応しているので，過程全体が対称であることから
$$
P_n(0) = P_n(2)
$$
が全ての $n$ で成り立つことが予想される。実際に漸化式から確認する。

今 $P_n(0) = P_n(2)$ と仮定すると，
$$
P_{n+1}(0) = \dfrac{1}{3}P_n(0) + \dfrac{1}{6}P_n(1),
\quad
P_{n+1}(2) = \dfrac{1}{6}P_n(1) + \dfrac{1}{3}P_n(2)
$$
であり，右辺で $P_n(0)$ と $P_n(2)$ を入れ替えても式の形は変わらないため，
$$
P_{n+1}(0) = P_{n+1}(2)
$$
となる。初期状態では $P_0(0)=1,\,P_0(2)=0$ で等しくないが，1回後には

$$
\boldsymbol{P}_1 = \boldsymbol{P}_0 M = (1,0,0)M
= \left(\dfrac{1}{3},\,\dfrac{2}{3},\,0\right)
$$

で $P_1(0)\neq P_1(2)$ である。しかし，その後の漸化式から

$$
P_{n+1}(0)-P_{n+1}(2)
= \dfrac{1}{3}\bigl(P_n(0)-P_n(2)\bigr)
$$

が成り立つので，この差は等比数列となる。  
初期差は  
$$
P_1(0)-P_1(2)=\dfrac{1}{3}-0=\dfrac{1}{3}
$$
なので，
$$
P_n(0)-P_n(2) = \dfrac{1}{3}\left(\dfrac{1}{3}\right)^{\,n-1}
= \left(\dfrac{1}{3}\right)^n
\quad (n\ge1)
$$
が得られる。

一方，和については
$$
P_n(0)+P_n(1)+P_n(2)=1
$$
と $P_n(0)=P_n(2)$ から
$$
P_n(1) = 1 - 2P_n(0)
$$
がわかる。また
$$
P_n(0)+P_n(2) = 1 - P_n(1)
$$
である。

このうち $P_n(1)$ だけに関する漸化式を求めるため，  
上の遷移式から $P_{n+1}(1)$ を表す：

$$
\begin{aligned}
P_{n+1}(1)
&= \dfrac{2}{3}\bigl(P_n(0)+P_n(1)+P_n(2)\bigr)
= \dfrac{2}{3}
\end{aligned}
$$

したがって $P_n(1)$ は $n$ に依らず常に一定であることがわかる。  
そこで $P_n(1)=p$ とおき，確率の和から

$$
P_n(0)+P_n(2) = 1-p
$$

また，差から

$$
P_n(0)-P_n(2)=\left(\dfrac{1}{3}\right)^n
$$

であるから，連立して
$$
P_n(0) = \dfrac{(1-p) + (1/3)^n}{2},\quad
P_n(2) = \dfrac{(1-p) - (1/3)^n}{2}
$$
となる。

$n=1$ のときの値 $P_1(0)=\dfrac{1}{3}$ を代入すると，
$$
\dfrac{1}{3}
= \dfrac{(1-p) + (1/3)}{2}
$$
より，
$$
\frac{2}{3} = 1 - p + \frac{1}{3}
\quad\Rightarrow\quad
1 - p = \frac{1}{3}
\quad\Rightarrow\quad
p = \frac{2}{3}
$$
となる。したがって
$$
P_n(1) = \dfrac{2}{3}
$$
が全ての $n\ge1$ について成り立ち，  
さらに
$$
P_n(0)+P_n(2) = 1 - P_n(1) = 1 - \dfrac{2}{3} = \dfrac{1}{3}
$$
となる。これと差の式
$$
P_n(0)-P_n(2)=\left(\dfrac{1}{3}\right)^n
$$
から $P_n(0),P_n(2)$ を求めると，

$$
P_n(0)
= \dfrac{\dfrac{1}{3} + \left(\dfrac{1}{3}\right)^n}{2},
\quad
P_n(2)
= \dfrac{\dfrac{1}{3} - \left(\dfrac{1}{3}\right)^n}{2}
$$

となる。

以上より，

(2) $n\ge1$ のとき
$$
P_n(0) = \dfrac{1}{2}\left(\dfrac{1}{3} + \left(\dfrac{1}{3}\right)^n\right),\quad
P_n(1) = \dfrac{2}{3},\quad
P_n(2) = \dfrac{1}{2}\left(\dfrac{1}{3} - \left(\dfrac{1}{3}\right)^n\right)
$$

である。